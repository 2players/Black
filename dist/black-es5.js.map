{"version":3,"sources":["MathEx.js","Helpers.js","Vector.js","Matrix.js","Rectangle.js","Circle.js","Line.js","Polygon.js","Curve.js","Debug.js","MessageDispatcher.js","Time.js","System.js","Viewport.js","Component.js","GameObject.js","Texture.js","AtlasTexture.js","Asset.js","TextureAsset.js","JSONAsset.js","AtlasTextureAsset.js","AssetManager.js","BlendMode.js","VideoNullDriver.js","CanvasDriver.js","DOMDriver.js","DisplayObject.js","TextInfo.js","Sprite.js","TextField.js","Device.js","Scatter.js","FloatScatter.js","VectorScatter.js","CurveScatter.js","Action.js","Acceleration.js","AlphaOverLife.js","ScaleOverLife.js","RotationOverLife.js","TextureOverLife.js","Initializer.js","Life.js","Mass.js","Scale.js","Velocity.js","Position.js","Rotation.js","RandomTexture.js","EmitterState.js","Particle.js","Emitter.js","Key.js","KeyInfo.js","Input.js","InputComponent.js","FPSComponent.js","MRComponent.js","Ease.js","Interpolation.js","Tween.js","Animation.js","AnimationController.js","Black.js"],"names":["Math","randomBetween","a","b","floor","random","clamp","value","min","max","lerp","t","lerpp","PI_Q","PI","PI2","DEG2RAD","RAD2DEG","Vector","x","y","vector","sqrt","scalar","sum","lengthSqr","epsilon","Number","EPSILON","abs","rotation","subtract","setRotation","add","cos","toFixed","sin","set","acos","dot","length","angle","vectorMin","vectorMax","outVector","undefined","__cache","Matrix","c","d","tx","ty","_matrix","Float32Array","m","dx","dy","a0","a1","a2","a3","a4","a5","theta","scale","sx","sy","bv","b0","b1","b2","b3","b4","b5","a11","c11","tx11","rect","outRect","Rectangle","minX","MAX_VALUE","maxX","minY","maxY","xx","yy","tmpVector","points","width","height","i","transformXY","aa","ab","ac","ad","atx","aty","det","skewX","atan2","skewY","delta","r_rotation","r_skewX","r_skewY","r_scaleX","r_scaleY","r_x","r_y","v","matrix","copyTo","w","h","right","bottom","toUnion","clone","x0","x1","y0","y1","volume","cacheRight","cacheBottom","left","top","Line","topLeft","topRight","bottomRight","bottomLeft","Circle","r","circle","contains","distance","start","end","line","equals","normalize","multyplier","multiplyScalar","start1","end1","start2","end2","denominator","numerator1","numerator2","directionX","directionY","nearest","nearestDistance","dt","pow","x2","y2","__isInBoundsXY","Polygon","vertices","lines","bounds","center","refresh","polygon","len","push","polygonVertices","thisVertices","intersectionLine","intersects","thisLines","thisLen","polygonLines","polygonLen","j","intersectsCircle","rectangle","rectangleLines","rectangleLen","containsXY","point","perimeter","path","path2","split","Curve","mPoints","mLookup","mBaked","mStep","mEachT","__initPoints","__refreshEachT","__refreshCache","res","concat","slice","lookup","getFullLength","pointsLen","getLength","step","eachT","eachLength","s","ceil","p","copyFrom","minT","maxT","bezier","mPointsLen","label","startX","startY","cpStartX","cpStartY","cpEndX","cpEndY","endX","endY","u","tt","uu","uuu","ttt","p0","p1","p2","p3","Debug","assert","message","logOnFail","console","error","throwOnFail","Error","info","warn","MessageDispatcher","mListeners","name","callback","context","filterIx","indexOf","pureName","substring","pathMask","mGlobalHandlers","hasOwnProperty","dispatchers","splice","__parseMessage","isGameObject","GameObject","mDirection","params","__invoke","__invokeGlobal","mOrigin","root","mSibblings","__sendGlobal","__sendBubbles","sender","toTop","list","current","parent","dispatcher","origin","numChildren","child","getChildAt","mName","mPathMask","inPath","__checkPath","mTarget","call","RegExp","join","test","result","Message","mSender","mComponentMask","charAt","ixAt","ixHash","substr","mCanceled","Time","mTime","mDeltaTime","mScale","System","component","Viewport","containerElement","mContainerElement","style","userSelect","touchAction","overflow","cursor","WebkitTapHighlightColor","size","getBoundingClientRect","mSize","window","addEventListener","__onResize","post","Component","mId","ID","gameObject","mAdded","removeComponent","mComponents","mChildren","mX","mY","mScaleX","mScaleY","mPivotX","mPivotY","mRotation","mBounds","mLocalTransform","mWorldTransform","mDirty","DirtyFlag","DIRTY","mParent","mTag","mIndex","gameObjectsAndOrComponents","gooc","addChild","addComponent","addChildAt","index","setChildIndex","removeFromParent","__setParent","Black","instance","onChildrenAdded","setTransformDirty","ix","dispose","removeChild","removeChildAt","hadRoot","onChildrenRemoved","onComponentAdded","onAdded","onRemoved","onComponentRemoved","typeName","onFixedUpdate","k","__fixedUpdate","onUpdate","__update","onPostUpdate","__postUpdate","video","time","parentAlpha","parentBlendMode","onRender","__render","space","includeChildren","worldTransformation","prepend","invert","onGetLocalBounds","transformRect","expand","getBounds","scaleX","scaleY","anchorX","anchorY","zero","localPoint","transformVector","globalPoint","worldTransformationInversed","ax","ay","gen","ctx","iter","apply","it","done","next","seconds","setTimeout","cb","bind","on","flag","forEach","setDirty","LOCAL","WORLD","append","localTransformation","depth","currentWidth","currentHeight","old","onTagUpdated","inv","obj","intersectsWith","inside","tag","mTagCache","type","f","node","action","find","Texture","nativeTexture","region","untrimmedRect","mTexture","mRegion","mIsSubtexture","__ID","naturalWidth","naturalHeight","mTrimmed","mUntrimmedRect","mIsLoaded","string","imgElement","Image","src","canvas","quality","toDataURL","getTextureFromCanvas","MISSING_IMAGE_CACHE","AtlasTexture","texture","jsonObject","native","mMeta","mSubTextures","__parseJson","o","NEGATIVE_HALF_PI","key","frames","data","nameMask","outTextures","out","names","re","sort","__naturalComparer","NUMBER_GROUPS","String","bb","parseFloat","toLowerCase","Asset","url","mUrl","mData","mMimeType","mResponseType","mExtension","getExtension","mRequest","XMLHttpRequest","overrideMimeType","responseType","open","onreadystatechange","readyState","status","responseText","onLoaded","send","TextureAsset","mImageElement","onload","JSONAsset","mimeType","JSON","parse","AtlasTextureAsset","imageUrl","dataUrl","dataAsset","onJsonLoaded","load","AssetManager","mDefaultPath","mTotalLoaded","mIsAllLoaded","mLoadingProgress","mQueue","mTextures","mAtlases","mJsons","item","COMPLETE","onAssetLoaded","msg","constructor","PROGRESS","getTexture","default","BlendMode","AUTO","NORMAL","ADD","MULTIPLY","SCREEN","OVERLAY","DARKEN","LIGHTEN","COLOR_DODGE","COLOR_BURN","HARD_LIGHT","SOFT_LIGHT","DIFFERENCE","EXCLUSION","HUE","SATURATE","COLOR","LUMINOSITY","VideoNullDriver","mGlobalBlendMode","mClientWidth","mClientHeight","mTransform","mGlobalAlpha","mMeasureElement","document","createElement","position","appendChild","viewport","clientWidth","clientHeight","text","textWidth","textHeight","color","parsedColor","toString","el","innerHTML","whiteSpace","fontSize","fontFamily","fontStyle","fontWeight","weight","offsetWidth","strokeThickness","offsetHeight","CanvasDriver","mCtx","__createCanvas","cvs","id","getContext","setTransform","ox","oy","drawImage","beginPath","clip","font","fillStyle","hexColorToString","align","textBaseline","fillText","lineWidth","strokeStyle","strokeColor","strokeText","closePath","clearRect","clear","save","restore","globalAlpha","blendMode","globalCompositeOperation","DOMDriver","mCache","mCounter","mPixelated","mCurrentObject","__initCSS","imgRendering","sSprite","getElementsByTagName","sSpritePixelated","sText","sViewport","className","parentNode","fromCanvasAsImage","oldTransform","__popElement","__updateElementCommon","__updateImageElement","__updateTextElement","transform","webkitTransform","opacity","backgroundImage","isSubTexture","vBackgroundPosition","backgroundPosition","textAlign","webkitTextStrokeColor","webkitTextStrokeWidth","DisplayObject","mAlpha","mVisible","TextInfo","FontStyle","FontWeight","FontAlign","LEFT","ITALIC","BOLD","SUPERBOLD","RIGHT","CENTER","Sprite","tmpBlendMode","globalBlendMode","getComponent","InputComponent","touchable","TextField","mText","mNeedInvalidate","mCacheBounds","mFieldWidth","mFieldHeight","mTextWidth","mTextHeight","mStyle","mAutoSize","__validate","drawText","strokeCorrection","driver","vSize","measureText","Device","mInstance","mPixelRatio","getDevicePixelRatio","screen","systemXDPI","logicalXDPI","devicePixelRatio","userAgent","navigator","vendor","opera","hasEvent","maxTouchPoints","Scatter","FloatScatter","ease","VectorScatter","FloatCurveScatter","mCurve","baked","interpolate","VectorCurveScatter","Action","emmiter","particle","Acceleration","vectorScatter","scatter","getValue","AlphaOverLife","floatScatter","alpha","getValueAt","energy","ScaleOverLife","RotationOverLife","TextureOverLife","textureIndex","Initializer","Life","life","Mass","mass","Scale","Velocity","vx","vy","Position","Rotation","RandomTexture","EmitterState","PENDING","EMITTING","FINISHED","Particle","reset","age","Emitter","mParticles","mRecycled","mInitializers","mActions","mSpace","mIsLocal","mMaxParticles","mEmitCount","mEmitNumRepeats","Infinity","mEmitNumRepeatsLeft","mEmitDuration","mEmitDurationLeft","mEmitInterval","mEmitIntervalLeft","mEmitDelay","mEmitDelayLeft","mNextUpdateAt","mState","__tmpLocal","__tmpWorld","uptime","firstEmit","initializer","localTransform","worldTransform","identity","plength","tw","th","updateNextTick","__create","alength","preUpdate","update","postUpdate","amount","minv","pop","initer","initialize","transformDirectionXY","Key","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","DIGIT_0","DIGIT_1","DIGIT_2","DIGIT_3","DIGIT_4","DIGIT_5","DIGIT_6","DIGIT_7","DIGIT_8","DIGIT_9","NUMPAD_0","NUMPAD_1","NUMPAD_2","NUMPAD_3","NUMPAD_4","NUMPAD_5","NUMPAD_6","NUMPAD_7","NUMPAD_8","NUMPAD_9","NUMPAD_MULTIPLY","NUMPAD_ADD","NUMPAD_SUBTRACT","NUMPAD_DECIMAL","NUMPAD_DIVIDE","LEFT_ARROW","UP_ARROW","RIGHT_ARROW","DOWN_ARROW","BACKSPACE","TAB","ENTER","SHIFT","CTRL","ALT","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","PAUSE_BREAK","CAPS_LOCK","ESCAPE","PAGE_UP","PAGE_DOWN","END","HOME","INSERT","DELETE","LEFT_WINDOW","RIGHT_WINDOW","CONTEXT_MENU","NUM_LOCK","SCROLL_LOCK","SEMI_COLON","EQUAL_SIGN","COMMA","DASH","PERIOD","FORWARD_SLASH","BACKQUOTE","BRAKET_LEFT","BACK_SLASH","BRAKET_RIGHT","SINGLE_QUOTE","KeyInfo","nativeEvent","keyCode","code","char","shiftKey","altKey","ctrlKey","Input","mPointerPosition","mDom","mEventList","mKeyEventList","__initListeners","mPointerQueue","mKeyQueue","mPressedKeys","mIsPointerDown","mNeedUpEvent","mInputListeners","PointerEvent","mPointerEventList","isTouch","isMobile","mTouchEventList","mMouseEventList","__onPointerEvent","e","POINTER_UP","__onPointerEventDoc","__onKeyEvent","over","target","parentElement","__pushEvent","preventDefault","__getTouchPos","__getPointerPos","evt","clientX","clientY","touch","changedTouches","array","__sortListeners","cs","findComponents","__addListener","pointerPos","fnName","mInputEventsLookup","currentComponent","mPointerInside","POINTER_DOWN","pIx","mKeyEventsLookup","POINTER_MOVE","POINTER_CANCEL","POINTER_IN","POINTER_OUT","FPSComponent","txtFPS","FPS","MRComponent","mWidth","mHeight","mInvScale","mAspect","setSize","updateLayout","Ease","bounceOut","bounceIn","Interpolation","fn","n","bn","fc","__factorial","v0","v1","t2","t3","Tween","values","duration","properties","mValues","mDuration","mProperties","mIsPlaying","mIsPaused","mStartTime","mPausedTime","mValuesStart","mElapsed","mInterpolation","linear","mDelay","mRepeatTimes","mInitiated","mStarted","mReverse","mRemoveOnComplete","mPlayOnAdded","mEase","smootherStep","__start","__resume","stop","remove","times","tween","play","Array","isArray","Animation","controller","fps","loop","mController","mFrames","mCurrentFrame","mNextFrameAt","mFPS","mFrameDuration","mLoop","mPaused","mStopped","mCompleted","diff","AnimationController","mAnimations","mCurrentAnim","textures","anim","sprite","pause","newTexture","containerElementId","rootClass","videoDriverClass","log","mContainerElementId","getElementById","mVideoDriverClass","mStageWidth","mStageHeight","mSimulationTimestep","mUptime","mFrameAccum","mLastFrameTimeMs","mCurrentTime","mLastFpsUpdate","mFramesThisSecond","mNumUpdateSteps","mMinFrameDelay","mSystems","mIsRunning","mIsStarted","mIsPanic","mLastFrameUpdateTime","mLastFrameRenderTime","mRAFHandle","mViewport","mVideo","mUnpausing","mPauseOnHide","mPauseOnBlur","mRootClass","mRoot","mEnableFixedTimeStep","mWasStopped","addSystem","onblur","__onVisbilityChange","event","onfocus","onpagehide","onpageshow","hidden","system","__bootViewport","__bootSystems","__bootVideo","__bootStage","self","requestAnimationFrame","timestamp","cancelAnimationFrame","__internalFixedUpdate","__internalUpdate","__internalPostUpdate","beginFrame","endFrame","oldTag","newTag","arr","timestep"],"mappings":"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","file":"black-es5.js","sourcesContent":["/**\r\n * randomBetween\r\n *\r\n * @param {number} a\r\n * @param {number} b\r\n *\r\n * @return {number}\r\n */\r\nMath.randomBetween = function (a, b) {\r\n  return Math.floor(Math.random() * (b - a + 1) + a);\r\n};\r\n\r\n\r\n/**\r\n * clamp\r\n *\r\n * @param {number} value\r\n * @param {number} min\r\n * @param {number} max\r\n *\r\n * @return {number}\r\n */\r\nMath.clamp = function (value, min, max) {\r\n  return (value < min) ? min : (value > max) ? max : value;\r\n};\r\n\r\n\r\n/**\r\n * lerp\r\n *\r\n * @param {number} a\r\n * @param {number} b\r\n * @param {number} t\r\n *\r\n * @return {number}\r\n */\r\nMath.lerp = function (a, b, t) {\r\n  return a + t * (b - a);\r\n};\r\n\r\n\r\n/**\r\n * lerpp\r\n *\r\n * @param {number} a\r\n * @param {number} b\r\n * @param {number} t\r\n *\r\n * @return {number}\r\n */\r\nMath.lerpp = function (a, b, t) {\r\n  return (1 - t) * a + t * b;\r\n};\r\n\r\n/** @const\r\n *  @type {number}\r\n */\r\nMath.PI_Q = Math.PI / 4;\r\n\r\n/** @const\r\n *  @type {number}\r\n */\r\nMath.PI2 = Math.PI * 2;\r\n\r\n/** @const\r\n *  @type {number}\r\n */\r\nMath.DEG2RAD = 0.01745329251994329576923690768489;\r\n\r\n/** @const\r\n *  @type {number}\r\n */\r\nMath.RAD2DEG = 57.295779513082320876798154814105;\r\n// \r\n//\r\n//\r\n// /**\r\n//  * fsin - Fast sin\r\n//  *\r\n//  * @param {number} x\r\n//  *\r\n//  * @return {number}\r\n//  */\r\n// Math.fsin = function(x) {\r\n//   if (x === 0)\r\n//     return 0;\r\n//\r\n//   // modulo to range of -PI..PI\r\n//   const width = 3.14159265 - -3.14159265;\r\n//   const offsetValue = x - -3.14159265;\r\n//   x = (offsetValue - (Math.floor(offsetValue / width) * width)) + -3.14159265;\r\n//\r\n//   return x < 0 ? 1.27323954 * x + 0.405284735 * x * x : 1.27323954 * x - 0.405284735 * x * x;\r\n// }\r\n//\r\n//\r\n// /**\r\n//  * fcos - Fast cos\r\n//  *\r\n//  * @param {number} x\r\n//  *\r\n//  * @return {number}\r\n//  */\r\n// Math.fcos = function(x) {\r\n//   x += 1.57079632;\r\n//\r\n//   // modulo to range of -PI..PI\r\n//   const width = 3.14159265 - -3.14159265;\r\n//   const offsetValue = x - -3.14159265;\r\n//   x = (offsetValue - (Math.floor(offsetValue / width) * width)) + -3.14159265;\r\n//\r\n//   return x < 0 ? 1.27323954 * x + 0.405284735 * x * x : 1.27323954 * x - 0.405284735 * x * x;\r\n// }\r\n","// function assert(title, condition) {\r\n//   if (condition)\r\n//     console.log('%s %c[  OK  ]', title + ' ' + '.'.repeat(88 - title.length), 'color:green;')\r\n//   else\r\n//     console.log('%s %c[FAILED]', title + ' ' + '.'.repeat(88 - title.length), 'color:red;')\r\n// }\r\n//\r\n// function perfTest(testName, fn, ctx, count = 1000) {\r\n//   let startTime = new Date().getTime();\r\n//\r\n//   for (var i = 0; i < count; i++)\r\n//     fn.apply(ctx);\r\n//     //fn();\r\n//\r\n//   return (new Date().getTime() - startTime);\r\n// }\r\n//\r\n// function perfCompare(testsName, fn1, fn2, ctx, count = 1000) {\r\n//   let t1 = perfTest(testsName, fn1, ctx, count);\r\n//   let t2 = perfTest(testsName, fn2, ctx, count);\r\n//\r\n//   let c1 = 'color:green;'\r\n//   let c2 = 'color:red;'\r\n//\r\n//   if (t1 > t2) {\r\n//     c1 = c2;\r\n//     c2 = 'color:green;'\r\n//   }\r\n//\r\n//   console.log('%s:%c %dms %cvs%c %dms', testsName, c1, t1, 'color:black;', c2, t2);\r\n// }\r\n//\r\n// function assertf(title, func) {\r\n//   const r = func();\r\n//\r\n//   const statuses = ['[  OK  ]', '[FAILED]'];\r\n//   const colors = ['color:green;', 'color:red;'];\r\n//\r\n//   console.log('%s %c%s', title + ' ' + '.'.repeat(88 - title.length), r ? colors[0] : colors[1], r ? statuses[0] : statuses[1]);\r\n// }\r\n","\r\nclass Vector {\r\n  /**\r\n   * @param  {number=} x = 0 description\r\n   * @param  {number=} y = 0 description\r\n   */\r\n  constructor(x = 0, y = 0) {\r\n    /** @type {number} */\r\n    this.x = x;\r\n\r\n    /** @type {number} */\r\n    this.y = y;\r\n  }\r\n\r\n  /**\r\n   * set - Description\r\n   *\r\n   * @param {number=} [x=0] Description\r\n   * @param {number=} [y=0] Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  set(x = 0, y = 0) {\r\n    this.x = x;\r\n    this.y = y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * add - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  add(vector) {\r\n    this.x += vector.x;\r\n    this.y += vector.y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * subtract - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  subtract(vector) {\r\n    this.x -= vector.x;\r\n    this.y -= vector.y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * distance - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  distance(vector) {\r\n    let x = this.x - vector.x;\r\n    let y = this.y - vector.y;\r\n\r\n    return Math.sqrt((x * x) + (y * y));\r\n  }\r\n\r\n  /**\r\n   * multiply - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  multiply(vector) {\r\n    this.x *= vector.x;\r\n    this.y *= vector.y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * multiplyScalar - Description\r\n   *\r\n   * @param {number} scalar Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  multiplyScalar(scalar) {\r\n    this.x *= scalar;\r\n    this.y *= scalar;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * dot - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  dot(vector) {\r\n    return this.x * vector.x + this.y * vector.y;\r\n  }\r\n\r\n  /**\r\n   * length - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  length() {\r\n    let x = this.x;\r\n    let y = this.y;\r\n\r\n    return Math.sqrt(x * x + y * y);\r\n  }\r\n\r\n  /**\r\n   * lengthSqr - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  lengthSqr() {\r\n    let x = this.x;\r\n    let y = this.y;\r\n\r\n    return x * x + y * y;\r\n  }\r\n\r\n  normalize() {\r\n    let sum = this.lengthSqr();\r\n\r\n    if (sum > 0) {\r\n      sum = Math.sqrt(sum);\r\n      this.x /= sum;\r\n      this.y /= sum;\r\n    } else {\r\n      this.x = 0;\r\n      this.y = 0;\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * clamp - Description\r\n   *\r\n   * @param {number} min Description\r\n   * @param {number} max Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  clamp(min, max) {\r\n    this.x = Math.clamp(this.x, min, max);\r\n    this.y = Math.clamp(this.y, min, max);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * lerp - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   * @param {number} t      Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  lerp(vector, t) {\r\n    this.x = Math.lerp(this.x, vector.x, t);\r\n    this.y = Math.lerp(this.y, vector.y, t);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * copyTo - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  copyTo(vector) {\r\n    vector.x = this.x;\r\n    vector.y = this.y;\r\n\r\n    return vector;\r\n  }\r\n\r\n  /**\r\n   * copyFrom - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  copyFrom(vector) {\r\n    this.x = vector.x;\r\n    this.y = vector.y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * clone - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  clone() {\r\n    return new Vector(this.x, this.y);\r\n  }\r\n\r\n  /**\r\n   * equals - Description\r\n   *\r\n   * @param {Vector} vector Description\r\n   * @param {number=} epsilon Description\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  equals(vector, epsilon = Number.EPSILON) {\r\n    return vector !== null && (Math.abs(vector.x - this.x) < epsilon) && (Math.abs(vector.y - this.y) < epsilon);\r\n  }\r\n\r\n  /**\r\n   * isEmpty - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  isEmpty() {\r\n    return this.x === 0 && this.y === 0;\r\n  }\r\n\r\n  /**\r\n   * setRotationFrom - Rotates this vector around specified point.\r\n   *\r\n   * @param {Vector} vector Center vector.\r\n   * @param {number} rotation Angle in radians.\r\n   *\r\n   * @return {Vector} This rotated vector.\r\n   */\r\n  setRotationFrom(vector, rotation) {\r\n    return this\r\n      .subtract(vector)\r\n      .setRotation(rotation)\r\n      .add(vector);\r\n  }\r\n\r\n  /**\r\n   * setRotation - Rotates this vector around zero vector\r\n   *\r\n   * @param {number} rotation Angle in radians\r\n   *\r\n   * @return {Vector} This rotated vector.\r\n   */\r\n  setRotation(rotation) {\r\n    let cos = Math.cos(rotation).toFixed(15);\r\n    let sin = Math.sin(rotation).toFixed(15);\r\n\r\n    return this.set(this.x * cos - this.y * sin, this.x * sin + this.y * cos);\r\n  }\r\n\r\n  /**\r\n   * theta - Calculates angle in radians within this and specified vectors.\r\n   *\r\n   * @return {number} Angle in radians.\r\n   */\r\n  theta(vector) {\r\n    return Math.acos(this.dot(vector) / this.length() / vector.length());\r\n  }\r\n\r\n  /**\r\n   * perp - Rotates this vector to normal.\r\n   *\r\n   * @return {Vector} This vector.\r\n   */\r\n  perp() {\r\n    return this.set(this.y, -this.x);\r\n  }\r\n\r\n  /**\r\n   * fromAngle - Description\r\n   *\r\n   * @param {number=} [angle=0] Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  static fromAngle(angle = 0) {\r\n    return new Vector(Math.cos(angle), Math.sin(angle));\r\n  }\r\n\r\n  /**\r\n   * randomRange\r\n   *\r\n   * @param {Vector} vectorMin\r\n   * @param {Vector} vectorMax\r\n   * @param {Vector=} outVector\r\n   *\r\n   * @return {Vector}\r\n   */\r\n  static randomRange(vectorMin, vectorMax, outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n\r\n    outVector.x = Math.random() * (vectorMax.x - vectorMin.x) + vectorMin.x;\r\n    outVector.y = Math.random() * (vectorMax.y - vectorMin.y) + vectorMin.y;\r\n\r\n    return outVector;\r\n  }\r\n\r\n}\r\n\r\n/** @type {Vector}\r\n * @nocollapse\r\n */\r\nVector.__cache = new Vector();\r\n","\r\nclass Matrix {\r\n  /**\r\n   * @param  {number} a = 1  description\r\n   * @param  {number} b = 0  description\r\n   * @param  {number} c = 0  description\r\n   * @param  {number} d = 1  description\r\n   * @param  {number} tx = 0 description\r\n   * @param  {number} ty = 0 description\r\n   * @return {number}        description\r\n   */\r\n  constructor(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\r\n    /** @type {Float32Array} */\r\n    this._matrix = new Float32Array(6);\r\n\r\n    this.set(a, b, c, d, tx, ty);\r\n  }\r\n\r\n  /**\r\n\r\n   * @param  {number} a  description\r\n   * @param  {number} b  description\r\n   * @param  {number} c  description\r\n   * @param  {number} d  description\r\n   * @param  {number} tx description\r\n   * @param  {number} ty description\r\n   * @return {Matrix}    description\r\n   */\r\n  set(a = 1, b = 0, c = 0, d = 1, tx = 0, ty = 0) {\r\n    let m = this._matrix;\r\n\r\n    m[0] = a;\r\n    m[1] = b;\r\n    m[2] = c;\r\n    m[3] = d;\r\n    m[4] = tx;\r\n    m[5] = ty;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * translate - Description\r\n   *\r\n   * @param {number} dx Description\r\n   * @param {number} dy Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  translate(dx, dy) {\r\n    let a = this._matrix;\r\n\r\n    let /** @type {number} */ a0 = a[0]; // a\r\n    let /** @type {number} */ a1 = a[1]; // b\r\n    let /** @type {number} */ a2 = a[2]; // c\r\n    let /** @type {number} */ a3 = a[3]; // d\r\n    let /** @type {number} */ a4 = a[4]; // tx\r\n    let /** @type {number} */ a5 = a[5]; // ty\r\n\r\n    this._matrix[4] += dx;\r\n    this._matrix[5] += dy;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * setTranslation - Description\r\n   *\r\n   * @param {number} x Description\r\n   * @param {number} y Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  setTranslation(x, y) {\r\n    this._matrix[4] = x;\r\n    this._matrix[5] = y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @param  {number} theta     description\r\n   * @param  {number} scale = 1 description\r\n   */\r\n  setRotation(theta, scale = 1) {\r\n    let m = this._matrix;\r\n    m[0] = Math.cos(theta) * scale;\r\n    m[2] = Math.sin(theta) * scale;\r\n    m[1] = -m[2];\r\n    m[3] = m[0];\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * rotate - angle\r\n   *\r\n   * @param  {number} angle description\r\n   * @return {Matrix}       description\r\n   */\r\n  rotate(angle) {\r\n    let a = this._matrix;\r\n    let cos = Math.cos(angle);\r\n    let sin = Math.sin(angle);\r\n    let a0 = a[0];\r\n    let a2 = a[2];\r\n    let a4 = a[4];\r\n\r\n    a[0] = a0 * cos - a[1] * sin;\r\n    a[1] = a0 * sin + a[1] * cos;\r\n    a[2] = a2 * cos - a[3] * sin;\r\n    a[3] = a2 * sin + a[3] * cos;\r\n    a[4] = a4 * cos - a[5] * sin;\r\n    a[5] = a4 * sin + a[5] * cos;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * scale - Description\r\n   *\r\n   * @param {number} sx Description\r\n   * @param {number} sy Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  scale(sx, sy) {\r\n    let a = this._matrix;\r\n    let /** @type {number} */ a0 = a[0]; // a\r\n    let /** @type {number} */ a1 = a[1]; // b\r\n    let /** @type {number} */ a2 = a[2]; // c\r\n    let /** @type {number} */ a3 = a[3]; // d\r\n    let /** @type {number} */ a4 = a[4]; // tx\r\n    let /** @type {number} */ a5 = a[5]; // ty\r\n\r\n    this._matrix[0] = a0 * sx;\r\n    this._matrix[1] = a1 * sx;\r\n    this._matrix[2] = a2 * sy;\r\n    this._matrix[3] = a3 * sy;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * identity - Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  identity() {\r\n    return this.set(1, 0, 0, 1, 0, 0);\r\n  }\r\n\r\n  /**\r\n   * Same as concat in flash\r\n   * @param  {Matrix} b description\r\n   * @return {Matrix}   description\r\n   */\r\n  prepend(b) {\r\n    let a = this._matrix;\r\n    let bv = b._matrix;\r\n\r\n    let /** @type {number} */ a0 = a[0]; // a\r\n    let /** @type {number} */ a1 = a[1]; // b\r\n    let /** @type {number} */ a2 = a[2]; // c\r\n    let /** @type {number} */ a3 = a[3]; // d\r\n    let /** @type {number} */ a4 = a[4]; // tx\r\n    let /** @type {number} */ a5 = a[5]; // ty\r\n\r\n    let /** @type {number} */ b0 = bv[0]; // a\r\n    let /** @type {number} */ b1 = bv[1]; // b\r\n    let /** @type {number} */ b2 = bv[2]; // c\r\n    let /** @type {number} */ b3 = bv[3]; // d\r\n    let /** @type {number} */ b4 = bv[4]; // tx\r\n    let /** @type {number} */ b5 = bv[5]; // ty\r\n\r\n    let a11 = (a0 * b0 + a1 * b2);\r\n    a[1] = a0 * b1 + a1 * b3;\r\n    a[0] = a11;\r\n\r\n    let c11 = (a2 * b0 + a3 * b2);\r\n    a[3] = a2 * b1 + a3 * b3;\r\n    a[2] = c11;\r\n\r\n    let tx11 = (a4 * b0 + a5 * b2 + b4);\r\n    a[5] = a4 * b1 + a5 * b3 + b5;\r\n    a[4] = tx11;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @param  {Matrix} b description\r\n   * @return {Matrix}   description\r\n   */\r\n  append(b) {\r\n    let a = this._matrix;\r\n    let bv = b._matrix;\r\n\r\n    let /** @type {number} */ a0 = a[0];\r\n    let /** @type {number} */ a1 = a[1];\r\n    let /** @type {number} */ a2 = a[2];\r\n    let /** @type {number} */ a3 = a[3];\r\n    let /** @type {number} */ a4 = a[4];\r\n    let /** @type {number} */ a5 = a[5];\r\n    let /** @type {number} */ b0 = bv[0];\r\n    let /** @type {number} */ b1 = bv[1];\r\n    let /** @type {number} */ b2 = bv[2];\r\n    let /** @type {number} */ b3 = bv[3];\r\n    let /** @type {number} */ b4 = bv[4];\r\n    let /** @type {number} */ b5 = bv[5];\r\n\r\n    a[0] = a0 * b0 + a2 * b1;\r\n    a[1] = a1 * b0 + a3 * b1;\r\n    a[2] = a0 * b2 + a2 * b3;\r\n    a[3] = a1 * b2 + a3 * b3;\r\n    a[4] = a0 * b4 + a2 * b5 + a4;\r\n    a[5] = a1 * b4 + a3 * b5 + a5;\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @param  {number} x         description\r\n   * @param  {number} y         description\r\n   * @param  {Vector=} outVector description\r\n   * @return {Vector}           description\r\n   */\r\n  transformXY(x, y, outVector) {\r\n    outVector = outVector || new Vector();\r\n    let m = this._matrix;\r\n\r\n    outVector.x = m[0] * x + m[2] * y + m[4];\r\n    outVector.y = m[1] * x + m[3] * y + m[5];\r\n\r\n    return outVector;\r\n  }\r\n\r\n  /**\r\n   * @param  {number} x         description\r\n   * @param  {number} y         description\r\n   * @param  {Vector=} outVector description\r\n   * @return {Vector}           description\r\n   */\r\n  transformDirectionXY(x, y, outVector) {\r\n    let m = this._matrix;\r\n    outVector = outVector || new Vector();\r\n\r\n    outVector.x = m[0] * x + m[2] * y;\r\n    outVector.y = m[1] * x + m[3] * y;\r\n\r\n    return outVector;\r\n  }\r\n\r\n  /**\r\n   * transformVector - transforms vector by current matrix object.\r\n   *\r\n   * @param  {Vector} vector    description\r\n   * @param  {Vector=} outVector description\r\n   * @return {Vector}           description\r\n   */\r\n  transformVector(vector, outVector) {\r\n    outVector = outVector || new Vector();\r\n    let m = this._matrix;\r\n\r\n    outVector.x = m[0] * vector.x + m[2] * vector.y + m[4];\r\n    outVector.y = m[1] * vector.x + m[3] * vector.y + m[5];\r\n\r\n    return outVector;\r\n  }\r\n\r\n  /**\r\n   * transformRect - transforms rectangle by current matrix object.\r\n   *\r\n   * @param  {Rectangle} rect    description\r\n   * @param  {Rectangle|null} outRect description\r\n   * @return {Rectangle}         description\r\n   */\r\n  transformRect(rect, outRect) {\r\n    outRect = outRect || new Rectangle();\r\n\r\n    let minX = Number.MAX_VALUE;\r\n    let maxX = -Number.MAX_VALUE;\r\n    let minY = Number.MAX_VALUE;\r\n    let maxY = -Number.MAX_VALUE;\r\n    let xx = 0;\r\n    let yy = 0;\r\n    let tmpVector = new Vector();\r\n\r\n    // TODO: fix dirty hack. rewrite to use rect\r\n    //let points = [rect.x, rect.y, rect.x + rect.width, rect.y + rect.height];\r\n\r\n    /** @type {Array<number>} */\r\n    let points = [rect.x, rect.y, rect.x + rect.width, rect.y, rect.x, rect.y + rect.height, rect.x + rect.width, rect.y + rect.height];\r\n\r\n    for (var i = 0; i < points.length; i += 2) {\r\n      xx = points[i];\r\n      yy = points[i + 1];\r\n\r\n      this.transformXY(xx, yy, tmpVector);\r\n\r\n      if (minX > tmpVector.x)\r\n        minX = tmpVector.x;\r\n      if (maxX < tmpVector.x)\r\n        maxX = tmpVector.x;\r\n      if (minY > tmpVector.y)\r\n        minY = tmpVector.y;\r\n      if (maxY < tmpVector.y)\r\n        maxY = tmpVector.y;\r\n    }\r\n\r\n    outRect.set(minX, minY, maxX - minX, maxY - minY);\r\n    return outRect;\r\n  }\r\n\r\n  /**\r\n   * invert - inverts current matrix.\r\n   *\r\n   * @return {Matrix}  description\r\n   */\r\n  invert() {\r\n    let a = this._matrix;\r\n\r\n    let aa = a[0];\r\n    let ab = a[1];\r\n    let ac = a[2];\r\n    let ad = a[3];\r\n    let atx = a[4];\r\n    let aty = a[5];\r\n\r\n    let det = aa * ad - ab * ac;\r\n    if (det === 0) {\r\n      a[0] = a[1] = a[2] = a[3] = 0;\r\n      a[4] = -atx;\r\n      a[5] = -aty;\r\n      return this;\r\n    }\r\n    det = 1.0 / det;\r\n\r\n    a[0] = ad * det;\r\n    a[1] = -ab * det;\r\n    a[2] = -ac * det;\r\n    a[3] = aa * det;\r\n    a[4] = (ac * aty - ad * atx) * det;\r\n    a[5] = (ab * atx - aa * aty) * det;\r\n\r\n    return this;\r\n  }\r\n\r\n  // NOTE: remove or finish\r\n  __decompose() {\r\n    let m = this._matrix;\r\n    let a = m[0];\r\n    let b = m[1];\r\n    let c = m[2];\r\n    let d = m[3];\r\n    let tx = m[4];\r\n    let ty = m[5];\r\n\r\n    let skewX = -Math.atan2(-c, d);\r\n    let skewY = Math.atan2(b, a);\r\n\r\n    let delta = Math.abs(skewX + skewY);\r\n\r\n    let r_rotation = 0\r\n    let r_skewX = 0;\r\n    let r_skewY = 0;\r\n    let r_scaleX = 0;\r\n    let r_scaleY = 0;\r\n    let r_x = 0;\r\n    let r_y = 0;\r\n\r\n    if (delta < 0.00001) {\r\n      r_rotation = skewY;\r\n\r\n      if (a < 0 && d >= 0)\r\n        r_rotation += (r_rotation <= 0) ? Math.PI : -Math.PI;\r\n    } else {\r\n      r_skewX = skewX;\r\n      r_skewY = skewY;\r\n    }\r\n\r\n    r_scaleX = Math.sqrt((a * a) + (b * b));\r\n    r_scaleY = Math.sqrt((c * c) + (d * d));\r\n\r\n    r_x = tx;\r\n    r_y = ty;\r\n\r\n    return [r_x, r_y, r_rotation, r_scaleX, r_scaleY, r_skewX, r_skewY];\r\n  }\r\n\r\n  /**\r\n   * clone - clones the current matrix and returns new cloned object.\r\n   *\r\n   * @return {Matrix}  description\r\n   */\r\n  clone() {\r\n    let m = new Matrix();\r\n    let v = this._matrix;\r\n    m.set(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n    return m;\r\n  }\r\n\r\n  /**\r\n   * copyTo - copies\r\n   *\r\n   * @param  {Matrix} matrix description\r\n   * @return {Matrix}        description\r\n   */\r\n  copyTo(matrix) {\r\n    let a = this._matrix;\r\n    let b = matrix._matrix;\r\n\r\n    b[0] = a[0];\r\n    b[1] = a[1];\r\n    b[2] = a[2];\r\n    b[3] = a[3];\r\n    b[4] = a[4];\r\n    b[5] = a[5];\r\n\r\n    return matrix;\r\n  }\r\n\r\n  /**\r\n   * copyFrom - description\r\n   *\r\n   * @param  {Matrix} matrix description\r\n   * @return {Matrix}        description\r\n   */\r\n  copyFrom(matrix) {\r\n    return matrix.copyTo(this);\r\n  }\r\n\r\n  /**\r\n   * equals - description\r\n   *\r\n   * @param  {Matrix} matrix                   description\r\n   * @param  {number} epsilon = Number.EPSILON description\r\n   * @return {boolean}                          description\r\n   */\r\n  equals(matrix, epsilon = Number.EPSILON) {\r\n    let a = this._matrix;\r\n    let b = matrix._matrix;\r\n    if (!matrix)\r\n      return false;\r\n\r\n    return (Math.abs(a[0] - b[0]) < epsilon) && (Math.abs(a[1] - b[1]) < epsilon) && (Math.abs(a[2] - b[2]) < epsilon) &&\r\n      (Math.abs(a[3] - b[3]) < epsilon) && (Math.abs(a[4] - b[4]) < epsilon) && (Math.abs(a[5] - b[5]) < epsilon);\r\n  }\r\n\r\n  /**\r\n   * get - description\r\n   *\r\n   * @return {Float32Array}  description\r\n   */\r\n  get value() {\r\n    return this._matrix;\r\n  }\r\n\r\n}\r\n\r\n/**\r\n * @type {Matrix}\r\n * @nocollapse\r\n */\r\nMatrix.__cache = new Matrix();\r\n","\r\nclass Rectangle {\r\n  /**\r\n   * @param  {number=} y = 0 description\r\n   * @param  {number=} x = 0 description\r\n   * @param  {number=} w = 0 description\r\n   * @param  {number=} h = 0 description\r\n   */\r\n  constructor(x = 0, y = 0, w = 0, h = 0) {\r\n    /** @type {number} */\r\n    this.x = x;\r\n\r\n    /** @type {number} */\r\n    this.y = y;\r\n\r\n    /** @type {number} */\r\n    this.width = w;\r\n\r\n    /** @type {number} */\r\n    this.height = h;\r\n  }\r\n\r\n  /**\r\n   * set - Description\r\n   *\r\n   * @param {number} x Description\r\n   * @param {number} y Description\r\n   * @param {number} w Description\r\n   * @param {number} h Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  set(x, y, w, h) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.width = w;\r\n    this.height = h;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * copyFrom - Description\r\n   *\r\n   * @param {Rectangle} rect Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  copyFrom(rect) {\r\n    this.x = rect.x;\r\n    this.y = rect.y;\r\n    this.width = rect.width;\r\n    this.height = rect.height;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * copyTo - Description\r\n   *\r\n   * @param {Rectangle} rect Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  copyTo(rect) {\r\n    rect.x = this.x;\r\n    rect.y = this.y;\r\n    rect.width = this.width;\r\n    rect.height = this.height;\r\n\r\n    return rect;\r\n  }\r\n\r\n\r\n  /**\r\n   * left - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get left() {\r\n    return this.x;\r\n  }\r\n\r\n  /**\r\n   * left - Description\r\n   *\r\n   * @param {number} left Left x position.\r\n   */\r\n  set left(left) {\r\n    this.x = left;\r\n  }\r\n\r\n  /**\r\n   * right - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get right() {\r\n    return this.x + this.width;\r\n  }\r\n\r\n  /**\r\n   * right - Description\r\n   *\r\n   * @param {number} right Right x position.\r\n   */\r\n  set right(right) {\r\n    this.x = right - this.width;\r\n  }\r\n\r\n  /**\r\n   * top - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get top() {\r\n    return this.y;\r\n  }\r\n\r\n  /**\r\n   * top - Description\r\n   *\r\n   * @param {number} top Top y position.\r\n   */\r\n  set top(top) {\r\n    this.y = top;\r\n  }\r\n\r\n  /**\r\n   * bottom - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get bottom() {\r\n    return this.y + this.height;\r\n  }\r\n\r\n  /**\r\n   * bottom - Description\r\n   *\r\n   * @param {number} bottom Bottom y position.\r\n   */\r\n  set bottom(bottom) {\r\n    this.y = bottom - this.height;\r\n  }\r\n\r\n  /**\r\n   * topLeft - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get topLeft() {\r\n    return new Vector(this.x, this.y);\r\n  }\r\n\r\n  /**\r\n   * topLeft - Description\r\n   *\r\n   * @param {Vector} vector Top left position.\r\n   */\r\n  set topLeft(vector) {\r\n    this.left = vector.x;\r\n    this.top = vector.y;\r\n  }\r\n\r\n  /**\r\n   * topRight - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get topRight() {\r\n    return new Vector(this.right, this.y);\r\n  }\r\n\r\n  /**\r\n   * topRight - Description\r\n   *\r\n   * @param {Vector} vector Top right position.\r\n   */\r\n  set topRight(vector) {\r\n    this.right = vector.x;\r\n    this.top = vector.y;\r\n  }\r\n\r\n  /**\r\n   * bottomRight - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get bottomRight() {\r\n    return new Vector(this.right, this.bottom);\r\n  }\r\n\r\n  /**\r\n   * bottomRight - Description\r\n   *\r\n   * @param {Vector} vector Right bottom position.\r\n   */\r\n  set bottomRight(vector) {\r\n    this.right = vector.x;\r\n    this.bottom = vector.y;\r\n  }\r\n\r\n  /**\r\n   * bottomLeft - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get bottomLeft() {\r\n    return new Vector(this.right, this.bottom);\r\n  }\r\n\r\n  /**\r\n   * bottomLeft - Description\r\n   *\r\n   * @param {Vector} vector Left bottom position.\r\n   */\r\n  set bottomLeft(vector) {\r\n    this.left = vector.x;\r\n    this.bottom = vector.y;\r\n  }\r\n\r\n  /**\r\n   * size - Description\r\n   *\r\n   * @param {Vector=} outVector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  size(outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n    return outVector.set(this.width, this.height);\r\n  }\r\n\r\n  /**\r\n   * zero - Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  zero() {\r\n    return this.set(0, 0, 0, 0);\r\n  }\r\n\r\n\r\n  /**\r\n   * equals - Description\r\n   *\r\n   * @param {Rectangle} rect Description\r\n   * @param {number=} epsilon Description\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  equals(rect, epsilon = Number.EPSILON) {\r\n    return rect !== null && (Math.abs(this.x - rect.x) < epsilon) && (Math.abs(this.y - rect.y) < epsilon) &&\r\n           (Math.abs(this.width - rect.width) < epsilon) && (Math.abs(this.height - rect.height) < epsilon);\r\n  }\r\n\r\n\r\n  /**\r\n   * containsXY - Description\r\n   *\r\n   * @param {number} x Description\r\n   * @param {number} y Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  containsXY(x, y) {\r\n    return x >= this.x && x <= this.right && y >= this.y && y <= this.bottom;\r\n  }\r\n\r\n\r\n  /**\r\n   * contains - Description\r\n   *\r\n   * @param {Rectangle} rect Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  contains(rect) {\r\n    return rect.x >= this.x && rect.y >= this.y && rect.right <= this.right && rect.bottom <= this.bottom;\r\n  }\r\n\r\n  /**\r\n   * intersects - Description\r\n   *\r\n   * @param {Rectangle} rect Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  intersects(rect) {\r\n    return rect.right > this.x && rect.bottom > this.y &&\r\n           rect.x < this.right && rect.y < this.bottom;\r\n  }\r\n\r\n\r\n  /**\r\n   * union - Description\r\n   *\r\n   * @param {Rectangle} toUnion Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  union(toUnion) {\r\n    if (this.width === 0 || this.height === 0)\r\n      return toUnion.clone();\r\n    else if (toUnion.width === 0 || toUnion.height === 0)\r\n      return this.clone();\r\n\r\n    let x0 = this.x > toUnion.x ? toUnion.x : this.x;\r\n    let x1 = this.right < toUnion.right ? toUnion.right : this.right;\r\n    let y0 = this.y > toUnion.y ? toUnion.y : this.y;\r\n    let y1 = this.bottom < toUnion.bottom ? toUnion.bottom : this.bottom;\r\n\r\n    return new Rectangle(x0, y0, x1 - x0, y1 - y0);\r\n  }\r\n\r\n\r\n  /**\r\n   * volume - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get volume() {\r\n    return this.width * this.height;\r\n  }\r\n\r\n\r\n  /**\r\n   * expand - Description\r\n   *\r\n   * @param {number} x      Description\r\n   * @param {number} y      Description\r\n   * @param {number} width  Description\r\n   * @param {number} height Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  expand(x, y, width, height) {\r\n    if (this.volume === 0)\r\n      return this.set(x, y, width, height);\r\n\r\n    let cacheRight = this.right;\r\n\t\tlet cacheBottom = this.bottom;\r\n\r\n    if (this.x > x) {\r\n      this.x = x;\r\n      this.width = cacheRight - x;\r\n    }\r\n\r\n    if (this.y > y) {\r\n      this.y = y;\r\n      this.height = cacheBottom - y;\r\n    }\r\n\r\n    if (cacheRight < x + width)\r\n      this.width = x + width - this.x;\r\n\r\n\t\tif (cacheBottom < y + height)\r\n      this.height = y + height - this.y;\r\n\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * inflate - Description\r\n   *\r\n   * @param {number=} [x=0] Description\r\n   * @param {number=} [y=0] Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  inflate(x = 0, y = 0) {\r\n    this.x -= x;\r\n    this.y -= y;\r\n    this.width += 2 * x;\r\n    this.height += 2 * y;\r\n\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * clone - Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  clone() {\r\n    return new Rectangle(this.x, this.y, this.width, this.height);\r\n  }\r\n\r\n  /**\r\n   * perimeter - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get perimeter() {\r\n    return 2 * (this.width + this.height);\r\n  }\r\n\r\n\r\n  /**\r\n   * center - Description\r\n   *\r\n   * @param {Vector=} outVector Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  center(outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n    return outVector.set(this.x + this.width * 0.5, this.y + this.height * 0.5);\r\n  }\r\n\r\n  /**\r\n   * scale - Scales this rectangle.\r\n   *\r\n   * @param {number} x Width multiplier.\r\n   * @param {number} y Height multiplier.\r\n   *\r\n   * @return {Rectangle} This rectangle.\r\n   */\r\n  scale(x, y) {\r\n    this.width *= x;\r\n    this.height *= y;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * isEmpty - Checks rectangle has area.\r\n   *\r\n   * @return {boolean} True if has.\r\n   */\r\n  isEmpty() {\r\n    return this.width === 0 && this.height === 0;\r\n  }\r\n\r\n  get lines() { // todo\r\n    return [\r\n      new Line(this.topLeft, this.topRight),\r\n      new Line(this.topRight, this.bottomRight),\r\n      new Line(this.bottomRight, this.bottomLeft),\r\n      new Line(this.bottomLeft, this.topLeft)\r\n    ];\r\n  }\r\n\r\n\r\n}\r\n\r\n/** @type {Rectangle}\r\n  * @nocollapse\r\n  */\r\nRectangle.__cache = new Rectangle();\r\n","\r\nclass Circle {\r\n  /**\r\n   * @param  {number=} x = 0 Position x.\r\n   * @param  {number=} y = 0 Position y.\r\n   * @param  {number=} r = 1 Radius.\r\n   */\r\n  constructor(x = 0, y = 0, r = 1) {\r\n    /** @type {number} */\r\n    this.x = x;\r\n\r\n    /** @type {number} */\r\n    this.y = y;\r\n\r\n    /** @type {number} */\r\n    this.r = r;\r\n  }\r\n\r\n  /**\r\n   * set - Sets new circle properties\r\n   *\r\n   * @param {number} x Position x.\r\n   * @param {number} y Position y.\r\n   * @param {number} r Radius.\r\n   *\r\n   * @return {Circle} This circle.\r\n   */\r\n  set(x, y, r) {\r\n    this.x = x;\r\n    this.y = y;\r\n    this.r = r;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * clone - Clones this circle.\r\n   *\r\n   * @return {Circle} Created circle.\r\n   */\r\n  clone() {\r\n    return new Circle(this.x, this.y, this.r);\r\n  }\r\n\r\n  /**\r\n   * copyTo - Copy this properties to another circle.\r\n   *\r\n   * @param {Circle} circle Object to copy to.\r\n   *\r\n   * @return {Circle} Passed circle.\r\n   */\r\n  copyTo(circle) {\r\n    return circle.set(this.x, this.y, this.r);\r\n  }\r\n\r\n  /**\r\n   * copyFrom - Copy another circle properties to this.\r\n   *\r\n   * @param {Circle} circle Object to copy from.\r\n   *\r\n   * @return {Circle} This circle.\r\n   */\r\n  copyFrom(circle) {\r\n    return this.set(circle.x, circle.y, circle.r);\r\n  }\r\n\r\n  /**\r\n   * equals - Shows whether circles are identical.\r\n   *\r\n   * @param {Circle} circle Object to comparison.\r\n   * @param {number=} epsilon Compare precision.\r\n   *\r\n   * @return {boolean} True if circles are identical.\r\n   */\r\n  equals(circle, epsilon = Number.EPSILON) {\r\n    return circle !== null && (Math.abs(this.x - circle.x) < epsilon) && (Math.abs(this.y - circle.y) < epsilon) &&\r\n      (Math.abs(this.r - circle.r) < epsilon);\r\n  }\r\n\r\n  /**\r\n   * containsXY - Shows whether point is in circle.\r\n   *\r\n   * @param {number} x Point position x.\r\n   * @param {number} y Point position y.\r\n   *\r\n   * @return {boolean} True if circle contains point.\r\n   */\r\n  containsXY(x, y) {\r\n    return this.contains(new Vector(x, y));\r\n  }\r\n\r\n  /**\r\n   * contains - Shows whether point is in circle.\r\n   *\r\n   * @param {Vector} vector Point to check.\r\n   *\r\n   * @return {boolean} True if circle contains point.\r\n   */\r\n  contains(vector) {\r\n    return new Vector(this.x, this.y).subtract(vector).length() <= this.r;\r\n  }\r\n\r\n  /**\r\n   * left - Finds left X position.\r\n   *\r\n   * @return {number} Left X position.\r\n   */\r\n  get left() {\r\n    return this.x - this.r;\r\n  }\r\n\r\n  /**\r\n   * right - Finds right X position.\r\n   *\r\n   * @return {number} Right X position.\r\n   */\r\n  get right() {\r\n    return this.x + this.r;\r\n  }\r\n\r\n  /**\r\n   * top - Finds top Y position.\r\n   *\r\n   * @return {number} Top Y position.\r\n   */\r\n  get top() {\r\n    return this.y - this.r;\r\n  }\r\n\r\n  /**\r\n   * bottom - Finds bottom Y position.\r\n   *\r\n   * @return {number} Bottom Y position.\r\n   */\r\n  get bottom() {\r\n    return this.y + this.r;\r\n  }\r\n\r\n  /**\r\n   * topPoint - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get topPoint() {\r\n    return new Vector(this.x, this.top);\r\n  }\r\n\r\n  /**\r\n   * bottomPoint - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  get bottomPoint() {\r\n    return new Vector(this.x, this.bottom);\r\n  }\r\n\r\n  /**\r\n   * zero - Description\r\n   *\r\n   * @return {Circle} Description\r\n   */\r\n  zero() {\r\n    return this.set(0, 0, 0);\r\n  }\r\n\r\n  /**\r\n   * intersects - Shows whether this circle intersects another.\r\n   *\r\n   * @param {Circle} circle Circle to check.\r\n   *\r\n   * @return {boolean} True if intersects.\r\n   */\r\n  intersects(circle) {\r\n    let d = new Vector(this.x, this.y).distance(new Vector(circle.x, circle.y));\r\n    return d <= this.r + circle.r && d >= this.r - circle.r;\r\n  }\r\n\r\n  /**\r\n   * collide - Shows whether this circle collide with another.\r\n   *\r\n   * @param {Circle} circle Circle to check.\r\n   *\r\n   * @return {boolean} True if collide.\r\n   */\r\n  collide(circle) {\r\n    let d = new Vector(this.x, this.y).distance(new Vector(circle.x, circle.y));\r\n    return d <= this.r + circle.r;\r\n  }\r\n\r\n  /**\r\n   * overlap - Shows whether this circle overlap another.\r\n   *\r\n   * @param {Circle} circle Circle to check.\r\n   *\r\n   * @return {boolean} True if overlap.\r\n   */\r\n  overlap(circle) {\r\n    if (this.r < circle.r) {\r\n      return false;\r\n    }\r\n\r\n    let d = new Vector(this.x, this.y).distance(new Vector(circle.x, circle.y));\r\n    return d <= this.r - circle.r;\r\n  }\r\n\r\n  /**\r\n   * volume - Area of this circle.\r\n   *\r\n   * @return {number} area.\r\n   */\r\n  get volume() {\r\n    return Math.PI * this.r * this.r;\r\n  }\r\n\r\n  /**\r\n   * perimeter - Perimeter of this circle.\r\n   *\r\n   * @return {number} perimeter.\r\n   */\r\n  get perimeter() {\r\n    return 2 * Math.PI * this.r;\r\n  }\r\n\r\n  /**\r\n   * center - Represents center as vector.\r\n   *\r\n   * @param {Vector=} outVector Object for result.\r\n   *\r\n   * @return {Vector} Center point.\r\n   */\r\n  center(outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n    return outVector.set(this.x, this.y);\r\n  }\r\n\r\n}\r\n\r\n/** @type {Circle}\r\n * @nocollapse\r\n */\r\nCircle.__cache = new Circle();\r\n","\r\nclass Line {\r\n  /**\r\n   * @param  {Vector} start Start point.\r\n   * @param  {Vector} end End point.\r\n   */\r\n  constructor(start, end) {\r\n    /** @type {Vector} */\r\n    this.start = start;\r\n\r\n    /** @type {Vector} */\r\n    this.end = end;\r\n  }\r\n\r\n  /**\r\n   * set - Sets new line properties\r\n   *\r\n   * @param  {Vector} start Start point.\r\n   * @param  {Vector} end End point.\r\n   *\r\n   * @return {Line} This circle.\r\n   */\r\n  set(start, end) {\r\n    this.start = start;\r\n    this.end = end;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * clone - Clones this line.\r\n   *\r\n   * @return {Line} Created line.\r\n   */\r\n  clone() {\r\n    return new Line(this.start.clone(), this.end.clone());\r\n  }\r\n\r\n  /**\r\n   * copyTo - Copy this properties to another line.\r\n   *\r\n   * @param {Line} line Object to copy to.\r\n   *\r\n   * @return {Line} Passed line.\r\n   */\r\n  copyTo(line) {\r\n    return line.set(this.start.clone(), this.end.clone());\r\n  }\r\n\r\n  /**\r\n   * copyFrom - Copy another line properties to this.\r\n   *\r\n   * @param {Line} line Object to copy from.\r\n   *\r\n   * @return {Line} This circle.\r\n   */\r\n  copyFrom(line) {\r\n    return this.set(line.start.clone(), line.end.clone());\r\n  }\r\n\r\n  /**\r\n   * equals - Shows whether lines are identical.\r\n   *\r\n   * @param {Line} line Object to comparison.\r\n   * @param {number=} epsilon Compare precision.\r\n   *\r\n   * @return {boolean} True if lines are identical.\r\n   */\r\n  equals(line, epsilon = Number.EPSILON) {\r\n    return (this.start.equals(line.start, epsilon) && this.end.equals(line.end, epsilon)) ||\r\n      (this.start.equals(line.end, epsilon) && this.end.equals(line.start, epsilon));\r\n  }\r\n\r\n  /**\r\n   * left - Finds left X position.\r\n   *\r\n   * @return {number} Left X position.\r\n   */\r\n  get left() {\r\n    return Math.min(this.start.x, this.end.x);\r\n  }\r\n\r\n\r\n  /**\r\n   * right - Finds right X position.\r\n   *\r\n   * @return {number} Right X position.\r\n   */\r\n  get right() {\r\n    return Math.max(this.start.x, this.end.x);\r\n  }\r\n\r\n  /**\r\n   * top - Finds top Y position.\r\n   *\r\n   * @return {number} Top Y position.\r\n   */\r\n  get top() {\r\n    return Math.min(this.start.y, this.end.y);\r\n  }\r\n\r\n  /**\r\n   * bottom - Finds bottom Y position.\r\n   *\r\n   * @return {number} Bottom Y position.\r\n   */\r\n  get bottom() {\r\n    return Math.max(this.start.y, this.end.y);\r\n  }\r\n\r\n  /**\r\n   * reverse - Replace line start and end points.\r\n   *\r\n   * @return {Line} This line.\r\n   */\r\n  reverse() {\r\n    let start = this.start;\r\n    this.start = this.end;\r\n    this.end = start;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * normalize - Change line's length to one. Moves end point.\r\n   *\r\n   * @return {Line} This line.\r\n   */\r\n  normalize() {\r\n    this.end\r\n      .subtract(this.start)\r\n      .normalize()\r\n      .add(this.start);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * scale - Change line's length to scaled. Moves end point.\r\n   *\r\n   * @return {Line} This line.\r\n   */\r\n  scale(multyplier) {\r\n    this.end\r\n      .subtract(this.start)\r\n      .multiplyScalar(multyplier)\r\n      .add(this.start);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * zero - Description\r\n   *\r\n   * @return {Line} Description\r\n   */\r\n  zero() {\r\n    return this.set(new Vector(), new Vector());\r\n  }\r\n\r\n  /**\r\n   * length - Length of this line.\r\n   *\r\n   * @return {number} length.\r\n   */\r\n  length() {\r\n    return this.start.distance(this.end);\r\n  }\r\n\r\n  /**\r\n   * center - Represents center as vector.\r\n   *\r\n   * @param {Vector=} outVector Object for result.\r\n   *\r\n   * @return {Vector} Center point.\r\n   */\r\n  center(outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n    return outVector.set((this.start.x + this.end.x) / 2, (this.start.y + this.end.y) / 2);\r\n  }\r\n\r\n\r\n  /**\r\n   * type - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get type() {\r\n    return 'Line';\r\n  }\r\n\r\n  /**\r\n   * containsXY - Shows whether point is on line.\r\n   *\r\n   * @param {number} x Point position x.\r\n   * @param {number} y Point position y.\r\n   *\r\n   * @return {boolean} True if line contains point.\r\n   */\r\n  containsXY(x, y) {\r\n    return this.contains(new Vector(x, y));\r\n  }\r\n\r\n  /**\r\n   * contains - Shows whether point is on line.\r\n   *\r\n   * @param {Vector} vector Point to check.\r\n   *\r\n   * @return {boolean} True if line contains point.\r\n   */\r\n  contains(vector) {\r\n    return this.start.distance(vector) + this.end.distance(vector) === this.length();\r\n  }\r\n\r\n  /**\r\n   * intersects - Shows whether this line intersects another.\r\n   *\r\n   * @param {Line} line Line to check.\r\n   *\r\n   * @return {boolean} True if intersects.\r\n   */\r\n  intersects(line) {\r\n    let start1 = this.start;\r\n    let end1 = this.end;\r\n    let start2 = line.start;\r\n    let end2 = line.end;\r\n\r\n    let denominator = ((end2.y - start2.y) * (end1.x - start1.x)) - ((end2.x - start2.x) * (end1.y - start1.y));\r\n\r\n    if (denominator === 0) {\r\n      return false;\r\n    }\r\n\r\n    let a = start1.y - start2.y;\r\n    let b = start1.x - start2.x;\r\n    let numerator1 = ((end2.x - start2.x) * a) - ((end2.y - start2.y) * b);\r\n    let numerator2 = ((end1.x - start1.x) * a) - ((end1.y - start1.y) * b);\r\n    a = numerator1 / denominator;\r\n    b = numerator2 / denominator;\r\n\r\n    return a >= 0 && a <= 1 && b > 0 && b < 1;\r\n  }\r\n\r\n  /**\r\n   * intersects - Shows whether this line intersects circle.\r\n   *\r\n   * @param {Circle} circle Circle to check.\r\n   *\r\n   * @return {boolean} True if intersects.\r\n   */\r\n  intersectsCircle(circle) {\r\n    let start = this.start;\r\n    let end = this.end;\r\n\r\n    if (circle.contains(start) || circle.contains(end)) {\r\n      return true;\r\n    }\r\n\r\n    let distance = start.distance(end);\r\n    let directionX = (end.x - start.x) / distance;\r\n    let directionY = (end.y - start.y) / distance;\r\n\r\n    let t = directionX * (circle.x - start.x) + directionY * (circle.y - start.y);\r\n\r\n    let nearest = new Vector((t * directionX) + start.x, (t * directionY) + start.y);\r\n    let nearestDistance = nearest.distance(new Vector(circle.x, circle.y));\r\n\r\n    if (nearestDistance < circle.r) {\r\n      let dt = Math.sqrt(Math.pow(circle.r, 2) - Math.pow(nearestDistance, 2));\r\n\r\n      let x1 = ((t - dt) * directionX + start.x).toFixed(15);\r\n      let y1 = ((t - dt) * directionY + start.y).toFixed(15);\r\n      let x2 = ((t + dt) * directionX + start.x).toFixed(15);\r\n      let y2 = ((t + dt) * directionY + start.y).toFixed(15);\r\n\r\n      return this.__isInBoundsXY(x1, y1) || this.__isInBoundsXY(x2, y2);\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  __isInBoundsXY(x, y) {\r\n    let x1 = this.start.x;\r\n    let y1 = this.start.y;\r\n    let x2 = this.end.x;\r\n    let y2 = this.end.y;\r\n    \r\n    return x > Math.min(x1, x2) && x < Math.max(x1, x2) && y > Math.min(y1, y2) && y < Math.max(y1, y2);\r\n  }\r\n\r\n}\r\n\r\n/** @type {Line}\r\n * @nocollapse\r\n */\r\nLine.__cache = new Line(new Vector(), new Vector());\r\n","\r\nclass Polygon {\r\n\r\n  /**\r\n   * @param  {Array<Vector>} vertices = [] Array of vertex points;\r\n   */\r\n  constructor(vertices = []) {\r\n\r\n    /** @type {Array<Vector>} */\r\n    this.vertices = vertices;\r\n\r\n    /** @type {Array<Line>} */\r\n    this.lines = [];\r\n\r\n    /** @type {Rectangle} */\r\n    this.bounds = new Rectangle();\r\n\r\n    /** @type {Vector} */\r\n    this.center = new Vector();\r\n\r\n    this.refresh();\r\n  }\r\n\r\n  /**\r\n   * set - Sets new vertices.\r\n   *\r\n   * @param {Array<Vector>} vertices New points.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  set(vertices) {\r\n    this.vertices = vertices;\r\n    this.refresh();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * copyTo - Copy this properties to another polygon.\r\n   *\r\n   * @param {Polygon} polygon Object to copy to.\r\n   *\r\n   * @return {Polygon} Passed polygon.\r\n   */\r\n  copyTo(polygon) {\r\n    let len = this.vertices.length;\r\n    let vertices = [];\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      vertices.push(this.vertices[i].clone());\r\n    }\r\n\r\n    return polygon.set(vertices);\r\n  }\r\n\r\n  /**\r\n   * copyFrom - Copy another polygon properties to this.\r\n   *\r\n   * @param {Polygon} polygon Object to copy from.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  copyFrom(polygon) {\r\n    let polygonVertices = polygon.vertices;\r\n    let len = polygonVertices.length;\r\n    let vertices = [];\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      vertices.push(polygonVertices[i].clone());\r\n    }\r\n\r\n    return this.set(vertices);\r\n  }\r\n\r\n  /**\r\n   * clone - Clones this polygon.\r\n   *\r\n   * @return {Polygon} Created polygon.\r\n   */\r\n  clone() {\r\n    let thisVertices = this.vertices;\r\n    let len = thisVertices.length;\r\n    let vertices = [];\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      vertices.push(thisVertices[i].clone());\r\n    }\r\n\r\n    return new Polygon(vertices);\r\n  }\r\n\r\n  get width() {\r\n    return this.bounds.width;\r\n  }\r\n\r\n  get height() {\r\n    return this.bounds.height;\r\n  }\r\n\r\n  /**\r\n   * containsXY - Shows whether point is in polygon.\r\n   *\r\n   * @param {number} x Point position x.\r\n   * @param {number} y Point position y.\r\n   *\r\n   * @return {boolean} True if polygon contains point.\r\n   */\r\n  containsXY(x, y) {\r\n    return this.contains(new Vector(x, y));\r\n  }\r\n\r\n  /**\r\n   * contains - Shows whether point is in polygon.\r\n   *\r\n   * @param {Vector} vector Point to check.\r\n   *\r\n   * @return {boolean} True if polygon contains point.\r\n   */\r\n  contains(vector) {\r\n    let center = this.center;\r\n    let lines = this.lines;\r\n    let len = lines.length;\r\n\r\n    if (center.equals(vector)) {\r\n      return true;\r\n    }\r\n\r\n    let intersectionLine = new Line(vector, center.clone());\r\n    let intersects = 0;\r\n    intersectionLine.scale((this.width + this.height) / intersectionLine.length());\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      intersects += lines[i].intersects(intersectionLine) ? 1 : 0;\r\n    }\r\n\r\n    return intersects % 2 !== 0;\r\n  }\r\n\r\n  /**\r\n   * perimeter - Perimeter of this polygon.\r\n   *\r\n   * @return {number} perimeter.\r\n   */\r\n  get perimeter() {\r\n    let thisLines = this.lines;\r\n    let len = thisLines.length;\r\n    let perimeter = 0;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      perimeter += thisLines[i].length();\r\n    }\r\n\r\n    return perimeter;\r\n  }\r\n\r\n  /**\r\n   * collide - Checks collides between two polygons.\r\n   *\r\n   * @param {Polygon} polygon Object to check.\r\n   *\r\n   * @return {boolean} True if polygon collides with another polygon.\r\n   */\r\n  collide(polygon) {\r\n    if (!this.bounds.intersects(polygon.bounds)) {\r\n      return false;\r\n    }\r\n\r\n    let thisLines = this.lines;\r\n    let thisLen = thisLines.length;\r\n    let polygonLines = polygon.lines;\r\n    let polygonLen = polygonLines.length;\r\n\r\n    for (let i = 0; i < thisLen; i++) {\r\n      for (let j = 0; j < polygonLen; j++) {\r\n        if (thisLines[i].intersects(polygonLines[j])) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * collideCircle - Checks collides between this polygon and circle.\r\n   *\r\n   * @param {Circle} circle Object to check.\r\n   *\r\n   * @return {boolean} True if polygon collides with circle.\r\n   */\r\n  collideCircle(circle) {\r\n    let bounds = this.bounds;\r\n    let lines = this.lines;\r\n\r\n    if (bounds.left > circle.right || bounds.right < circle.left || bounds.top > circle.bottom || bounds.bottom < circle.top) {\r\n      return false;\r\n    }\r\n\r\n    let len = lines.length;\r\n    for (let i = 0; i < len; i++) {\r\n      if (lines[i].intersectsCircle(circle)) {\r\n        return true;\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * collideRectangle - Checks collides between this polygon and rectangle.\r\n   *\r\n   * @param {Rectangle} rectangle Object to check.\r\n   *\r\n   * @return {boolean} True if polygon collides with rectangle.\r\n   */\r\n  collideRectangle(rectangle) {\r\n    if (!this.bounds.intersects(rectangle)) {\r\n      return false;\r\n    }\r\n\r\n    let thisLines = this.lines;\r\n    let thisLen = thisLines.length;\r\n    let rectangleLines = rectangle.lines;\r\n    let rectangleLen = rectangleLines.length;\r\n\r\n    for (let i = 0; i < thisLen; i++) {\r\n      for (let j = 0; j < rectangleLen; j++) {\r\n        if (thisLines[i].intersects(rectangleLines[j])) {\r\n          return true;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * overlap - Checks overlaps between this polygon and another.\r\n   *\r\n   * @param {Polygon} polygon Object to check.\r\n   *\r\n   * @return {boolean} True if polygon overlaps second.\r\n   */\r\n  overlap(polygon) {\r\n    if (this.bounds.width < polygon.bounds.width || this.bounds.height < polygon.bounds.height) {\r\n      return false;\r\n    }\r\n\r\n    if (!this.contains(polygon.center)) {\r\n      return false;\r\n    }\r\n\r\n    let thisLines = this.lines;\r\n    let thisLen = thisLines.length;\r\n    let polygonLines = polygon.lines;\r\n    let polygonLen = polygonLines.length;\r\n\r\n    for (let i = 0; i < thisLen; i++) {\r\n      for (let j = 0; j < polygonLen; j++) {\r\n        if (thisLines[i].intersects(polygonLines[j])) {\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * overlapCircle - Checks overlaps between this polygon and circle.\r\n   *\r\n   * @param {Circle} circle Object to check.\r\n   *\r\n   * @return {boolean} True if polygon overlaps circle.\r\n   */\r\n  overlapCircle(circle) {\r\n    if (!this.containsXY(circle.x, circle.y)) {\r\n      return false;\r\n    }\r\n\r\n    let thisLines = this.lines;\r\n    let len = thisLines.length;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      if (thisLines[i].intersectsCircle(circle)) {\r\n        return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * overlapRectangle - Checks overlaps between this polygon and rectangle.\r\n   *\r\n   * @param {Rectangle} rectangle Object to check.\r\n   *\r\n   * @return {boolean} True if polygon overlaps rectangle.\r\n   */\r\n  overlapRectangle(rectangle) {\r\n    if (!this.contains(rectangle.center())) {\r\n      return false;\r\n    }\r\n\r\n    let thisLines = this.lines;\r\n    let thisLen = thisLines.length;\r\n    let rectangleLines = rectangle.lines;\r\n    let rectangleLen = rectangleLines.length;\r\n\r\n    for (let i = 0; i < thisLen; i++) {\r\n      for (let j = 0; j < rectangleLen; j++) {\r\n        if (thisLines[i].intersects(rectangleLines[j])) {\r\n          return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * refresh - ReCalc center, bounds, and edges of this polygon.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  refresh() {\r\n    let center = this.center;\r\n    let bounds = this.bounds;\r\n    let vertices = this.vertices;\r\n    let lines = this.lines = [];\r\n    center.set(0, 0);\r\n\r\n    // bounds\r\n    let maxX = -Number.MAX_VALUE;\r\n    let maxY = -Number.MAX_VALUE;\r\n    let minX = Number.MAX_VALUE;\r\n    let minY = Number.MAX_VALUE;\r\n\r\n    for (let i = 0; i < vertices.length; i++) {\r\n      let vector = vertices[i];\r\n      center.add(vector);\r\n\r\n      // bounds\r\n      let {\r\n        x,\r\n        y\r\n      } = vector;\r\n      maxX = x > maxX ? x : maxX;\r\n      maxY = y > maxY ? y : maxY;\r\n      minX = x < minX ? x : minX;\r\n      minY = y < minY ? y : minY;\r\n\r\n      lines.push(new Line(vector, vertices[i + 1] || vertices[0]));\r\n    }\r\n\r\n    center.multiplyScalar(1 / vertices.length);\r\n    bounds.set(minX, minY, maxX - minX, maxY - minY);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * refreshCenter - ReCalc center of this polygon.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  refreshCenter() {\r\n    let center = this.center;\r\n    let vertices = this.vertices;\r\n    let len = vertices.length;\r\n    center.set(0, 0);\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      center.add(vertices[i]);\r\n    }\r\n\r\n    center.multiplyScalar(1 / vertices.length);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * refreshBounds - ReCalc bounds of this polygon.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  refreshBounds() {\r\n    let bounds = this.bounds;\r\n    let vertices = this.vertices;\r\n    let maxX = -Number.MAX_VALUE;\r\n    let maxY = -Number.MAX_VALUE;\r\n    let minX = Number.MAX_VALUE;\r\n    let minY = Number.MAX_VALUE;\r\n    let len = vertices.length;\r\n    let x;\r\n    let y;\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      x = vertices[i].x;\r\n      y = vertices[i].y;\r\n      maxX = x > maxX ? x : maxX;\r\n      maxY = y > maxY ? y : maxY;\r\n      minX = x < minX ? x : minX;\r\n      minY = y < minY ? y : minY;\r\n    }\r\n\r\n    bounds.set(minX, minY, maxX - minX, maxY - minY);\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * refreshLines - ReCalc edges of this polygon.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  refreshLines() {\r\n    let vertices = this.vertices;\r\n    let lines = this.lines = [];\r\n\r\n    for (let i = 0; i < vertices.length; i += 2) {\r\n      lines.push(new Line(vertices[i], vertices[i + 1] || vertices[0]));\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * fromPath - Creates instance of Polygon.\r\n   *\r\n   * @param {string} path Numbers x y divided with space.\r\n   *\r\n   * @return {Polygon} Created polygon.\r\n   */\r\n  static fromPath(path) {\r\n    let vertices = [];\r\n    let path2 = path.split(' ');\r\n\r\n    for (let i = 0; i < path2.length; i += 2) {\r\n      vertices.push(new Vector(Number(path2[i]), Number(path2[i + 1])));\r\n    }\r\n\r\n    return new Polygon(vertices);\r\n  }\r\n\r\n  /**\r\n   * setRotation - Sets rotation. Rotate this polygon around it center.\r\n   *\r\n   * @param {number} rotation Angle in radians.\r\n   *\r\n   * @return {Polygon} This polygon.\r\n   */\r\n  setRotation(rotation) {\r\n    let center = this.center;\r\n    let vertices = this.vertices;\r\n    let cos = Math.cos(rotation).toFixed(15);\r\n    let sin = Math.sin(rotation).toFixed(15);\r\n\r\n    for (let i = 0, len = vertices.length; i < len; i++) {\r\n      let vector = vertices[i];\r\n      vector\r\n        .subtract(center)\r\n        .set(vector.x * cos - vector.y * sin, vector.x * sin + vector.y * cos)\r\n        .add(center);\r\n    }\r\n\r\n    return this.refresh();\r\n  }\r\n\r\n  /**\r\n   * setTranslation - Translates this polygon to specified position.\r\n   *\r\n   * @param {Vector} point Translation vector.\r\n   *\r\n   * @return {Polygon} This vertices.\r\n   */\r\n  setTranslation(point) {\r\n    let center = this.center;\r\n    let vertices = this.vertices;\r\n    let len = vertices.length;\r\n    point.subtract(center);\r\n\r\n    for (let i = 0; i < len; i++) {\r\n      vertices[i].add(point);\r\n    }\r\n\r\n    return this.refresh();\r\n  }\r\n\r\n}\r\n\r\n/** @type {Polygon}\r\n * @nocollapse\r\n */\r\nPolygon.__cache = new Polygon();\r\n","\r\nclass Curve {\r\n  constructor() {\r\n\r\n    /** @type {Array<number>} */\r\n    this.mPoints = [];\r\n\r\n    /** @type {Array<Vector>} */\r\n    this.mLookup = null;\r\n\r\n    /** @type {boolean} */\r\n    this.mBaked = false;\r\n\r\n    /** @type {number} */\r\n    this.mStep = 1 / 60;\r\n\r\n    /** @type {Array<number>} */\r\n    this.mEachT = [];\r\n  }\r\n\r\n  /**\r\n   * set - Sets new points coordinates.\r\n   *\r\n   * @param  {...number} points Coordinates: startX, startY, cpStartX, cpStartY, cpEndX, cpEndY, endX/start2X, endY/start2Y, cp2StartX, cp2StartX... 8 or 14 or 20...\r\n   *\r\n   * @return {Curve} This curve.\r\n   */\r\n  set(...points) {\r\n    this.mPoints = this.__initPoints(points);\r\n    this.__refreshEachT();\r\n\r\n    if (this.mBaked)\r\n      this.__refreshCache();\r\n\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * baked - Returns true or false depending on baked is enabled or not.\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  get baked() {\r\n    return this.mBaked;\r\n  }\r\n\r\n  /**\r\n   * baked - Enables or disables interpolation from cache (lookup).\r\n   *\r\n   * @param  {boolean} label\r\n   */\r\n  set baked(label) {\r\n    this.mBaked = label;\r\n\r\n    if (!this.mLookup && this.mPoints) {\r\n      this.__refreshCache();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * __initPoints - Wides points array. Sets first point for next bezier same as last of previous.\r\n   *\r\n   * @param  {Array<number>} points Array of points coordinates.\r\n   *\r\n   * @return {Array<number>} Points coordinates array.\r\n   */\r\n  __initPoints(points) {\r\n    let res = [];\r\n\r\n    for (let i = 6; i < points.length; i += 6) {\r\n      res = res.concat(points.slice(i - 6, i + 2));\r\n    }\r\n\r\n    return res;\r\n  }\r\n\r\n  /**\r\n   * __refreshCache - Refresh cache (lookup) for fast interpolations.\r\n   *\r\n   * @return {Curve} This curve.\r\n   */\r\n  __refreshCache() {\r\n    let lookup = this.mLookup = [];\r\n    let getFullLength = this.getFullLength();\r\n    let points = this.mPoints;\r\n    let pointsLen = points.length;\r\n\r\n    for (let i = 0; i < pointsLen; i += 8) {\r\n      let length = Curve.getLength(...points.slice(i, i + 8));\r\n      let step = this.mStep * getFullLength / length;\r\n\r\n      for (let t = step; t < 1; t += step)\r\n        lookup.push(Curve.lerp(t, ...points.slice(i, i + 8)));\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n\r\n  /**\r\n   * __refreshEachT - Refresh local interpolation kof for each bezier in curve.\r\n   *\r\n   * @return {Curve} This curve.\r\n   */\r\n  __refreshEachT() {\r\n    let points = this.mPoints;\r\n    let eachT = this.mEachT = [];\r\n    let pointsLen = points.length;\r\n    let eachLength = [];\r\n\r\n    for (let i = 0; i < pointsLen; i += 8)\r\n      eachLength.push(Curve.getLength(...points.slice(i, i + 8)));\r\n\r\n    let length = this.getFullLength();\r\n    let s = 0;\r\n    for (let i = 0; i < pointsLen; i += 8) {\r\n      s += eachLength[i / 8];\r\n      eachT.push(s / length);\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * lerp - Interpolates single bezier on t position.\r\n   *\r\n   * @param  {number} t Interpolation position (0...1).\r\n   * @param  {number} startX\r\n   * @param  {number} startY\r\n   * @param  {number} cpStartX\r\n   * @param  {number} cpStartY\r\n   * @param  {number} cpEndX\r\n   * @param  {number} cpEndY\r\n   * @param  {number} endX\r\n   * @param  {number} endY\r\n   * @param  {Vector=} outVector\r\n   *\r\n   * @return {Vector} Position on bezier.\r\n   */\r\n  static lerp(t, startX, startY, cpStartX, cpStartY, cpEndX, cpEndY, endX, endY, outVector) {\r\n    let u = 1 - t;\r\n    let tt = t * t;\r\n    let uu = u * u;\r\n    let uuu = uu * u;\r\n    let ttt = tt * t;\r\n\r\n    let p = outVector || new Vector();\r\n    p.set(startX, startY);\r\n    p.x *= uuu;\r\n    p.y *= uuu;\r\n\r\n    // first\r\n    p.x += 3 * uu * t * cpStartX;\r\n    p.y += 3 * uu * t * cpStartY;\r\n\r\n    // second\r\n    p.x += 3 * u * tt * cpEndX;\r\n    p.y += 3 * u * tt * cpEndY;\r\n\r\n    // third\r\n    p.x += ttt * endX;\r\n    p.y += ttt * endY;\r\n\r\n    return p;\r\n  }\r\n\r\n  /**\r\n   * interpolate - Interpolates across whole curve.\r\n   *\r\n   * @param  {number} t Interpolation position (0...1).\r\n   * @param  {Vector=} outVector\r\n   *\r\n   * @return {Vector} Position on curve.\r\n   */\r\n  interpolate(t, outVector) {\r\n    let res = outVector || new Vector();\r\n    let lookup = this.mLookup;\r\n\r\n    if (this.mBaked) {\r\n      let i = Math.ceil((lookup.length - 1) * t);\r\n      let p = lookup[i];\r\n      res.copyFrom(p);\r\n\r\n      return res;\r\n    }\r\n\r\n    // not backed\r\n    let { mEachT, mPoints } = this;\r\n    let i = 0;\r\n\r\n    while (mEachT[i] < t)\r\n      i++;\r\n\r\n    let minT = mEachT[i - 1] || 0;\r\n    let maxT = mEachT[i];\r\n    let bezier = mPoints.slice(i * 8, i * 8 + 8);\r\n\r\n    return Curve.lerp((t - minT) / (maxT - minT), ...bezier, res);\r\n  }\r\n\r\n  /**\r\n   * length - Returns single bezier length.\r\n   *\r\n   * @param  {...number} points Coordinates: startX, startY, cpStartX, cpStartY, cpEndX, cpEndY, endX, endY\r\n   *\r\n   * @return {number} Length.\r\n   */\r\n  static getLength(...points) {\r\n    let p0 = new Vector(points[0], points[1]);\r\n    let p1 = new Vector(points[2], points[3]);\r\n    let p2 = new Vector(points[4], points[5]);\r\n    let p3 = new Vector(points[6], points[7]);\r\n\r\n    return (p3.distance(p0) + p0.distance(p1) + p1.distance(p2) + p2.distance(p3)) / 2;\r\n  }\r\n\r\n  /**\r\n   * getFullLength - Returns this curve length.\r\n   *\r\n   * @return {number} Length.\r\n   */\r\n  getFullLength() {\r\n    let points = this.mPoints;\r\n    let mPointsLen = points.length;\r\n    let res = 0;\r\n\r\n    for (let i = 0; i < mPointsLen; i += 8)\r\n      res += Curve.getLength(...points.slice(i, i + 8));\r\n\r\n    return res;\r\n  }\r\n}\r\n\r\n/** @type {Curve}\r\n * @nocollapse\r\n */\r\nCurve.__cache = new Curve();\r\n","\r\nclass Debug {\r\n  constructor() {\r\n    Debug.assert(false, 'Static class.');\r\n  }\r\n\r\n  static assert(value, message) {\r\n    if (value === true)\r\n      return;\r\n\r\n    message = message == null ? 'Assertation failed.' : message;\r\n\r\n    if (Debug.logOnFail)\r\n      console.error('[ASSERT]', message);\r\n\r\n    if (Debug.throwOnFail)\r\n      throw new Error(message);\r\n  }\r\n\r\n  static info(...message) {\r\n    console.info(...message);\r\n  }\r\n\r\n  static warn(...message) {\r\n    console.warn(...message);\r\n  }\r\n\r\n  static error(...message) {\r\n    console.error(...message);\r\n  }\r\n}\r\n\r\nDebug.throwOnFail = false;\r\nDebug.logOnFail = true;\r\n","/**\r\n * MessageDispatcher - Description\r\n * @unrestricted\r\n */\r\n\r\nclass MessageDispatcher {\r\n  constructor() {\r\n    // object of arrays\r\n\r\n    /** @type {Object<string, Array>} */\r\n    this.mListeners = null;\r\n  }\r\n\r\n  /**\r\n   * on - Listens to message by given name\r\n   *\r\n   * @param {string} name           Name of a message to listen\r\n   * @param {Function} callback       The callback function\r\n   * @param {Object=} [context=null] The context for callback function\r\n   *\r\n   * @return {void}\r\n   */\r\n  on(name, callback, context = null) {\r\n    Debug.assert(name !== null, 'name cannot be null.');\r\n    Debug.assert(callback !== null, 'callback cannot be null.');\r\n\r\n    // TODO: refactor, expore dispatching provider\r\n    let filterIx = name.indexOf('@') ;\r\n    if (filterIx !== -1) {\r\n      // global handler\r\n\r\n      let pureName = name.substring(0, filterIx);\r\n      let pathMask = name.substring(filterIx + 1);\r\n\r\n      //console.log(pureName, pathMask);\r\n\r\n      if (MessageDispatcher.mGlobalHandlers.hasOwnProperty(pureName) === false)\r\n        MessageDispatcher.mGlobalHandlers[pureName] = [];\r\n\r\n      let dispatchers = (MessageDispatcher.mGlobalHandlers[pureName]);\r\n      for (let i = 0; i < dispatchers.length; i++)\r\n        if (dispatchers[i].callback === callback)\r\n          return;\r\n\r\n      dispatchers.push({\r\n        callback: callback,\r\n        context: context,\r\n        pathMask: pathMask\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    if (this.mListeners === null)\r\n      this.mListeners = {};\r\n\r\n    if (this.mListeners.hasOwnProperty(name) === false)\r\n      this.mListeners[name] = [];\r\n\r\n    let dispatchers = /** @type {Array<{callback: Function, context}>} */ (this.mListeners[name]);\r\n\r\n    for (let i = 0; i < dispatchers.length; i++)\r\n      if (dispatchers[i].callback === callback)\r\n        return;\r\n\r\n    dispatchers.push({\r\n      callback: callback,\r\n      context: context\r\n    });\r\n  }\r\n\r\n  /**\r\n   * removeOn - Description\r\n   *\r\n   * @param {string} name            Description\r\n   * @param {Function=} [callback=null] Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  removeOn(name, callback = null) {\r\n    if (name === null || name.length === 0)\r\n      throw new Error('Name cannot be null.');\r\n\r\n    if (this.mListeners === null)\r\n      return;\r\n\r\n    let dispatchers = /** @type {Array<{callback: Function, context}>} */ (this.mListeners[name]);\r\n\r\n    if (dispatchers === undefined)\r\n      return;\r\n\r\n    if (callback === null) {\r\n      dispatchers.splice(0, dispatchers.length);\r\n      return;\r\n    }\r\n\r\n    for (let i = dispatchers.length; i--;) {\r\n      if (dispatchers[i].callback === callback) {\r\n        dispatchers.splice(i, 1);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * post - Sends message with given pattern and params\r\n   *\r\n   * @param {string}  name   The name of a message\r\n   * @param {...*} params A list of params to send\r\n   *\r\n   * @return {void}\r\n   */\r\n  post(name, ...params) {\r\n    // TODO: add wildcard support and name mask annotation support\r\n    Debug.assert(name !== null, 'name cannot be null.');\r\n    // if (name === null || name.length === 0)\r\n    //   throw new Error('Name cannot be null.');\r\n\r\n    let message = this.__parseMessage(this, name);\r\n\r\n    // TODO: o'really 62?\r\n    let isGameObject = this instanceof GameObject;\r\n    if (message.mDirection !== 'none' && isGameObject === false)\r\n      throw new Error('Dispatching not direct messages are not allowed on non Game Objects.');\r\n\r\n    if (message.mDirection === 'none') {\r\n      this.__invoke(this, message, ...params);\r\n      this.__invokeGlobal(this, message, ...params);\r\n    } else if (message.mDirection === 'down') {\r\n      message.mOrigin = ( /** @type {GameObject} */ (this)).root;\r\n\r\n      if (message.mSibblings === true) {\r\n        this.__sendGlobal(this, message, null, ...params);\r\n        message.mOrigin.__invokeGlobal(this, message, ...params);\r\n      }\r\n      else\r\n        this.__sendBubbles(this, message, false, ...params);\r\n    } else if (message.mDirection === 'up') {\r\n      this.__sendBubbles(this, message, true, ...params);\r\n    } else {\r\n      throw new Error('Unknown message type.');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * __sendBubbles - Description\r\n   *\r\n   * @param {*}  sender  Description\r\n   * @param {string}  message Description\r\n   * @param {boolean}  toTop   Description\r\n   * @param {...*} params  Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __sendBubbles(sender, message, toTop, ...params) {\r\n    message.mOrigin = toTop === true ? this : ( /** @type {GameObject} */ (this)).root;\r\n\r\n    let list = [this];\r\n\r\n    let current = /** @type {GameObject} */ (this);\r\n    while (current.parent !== null) {\r\n      list.push(current.parent);\r\n      current = current.parent;\r\n    }\r\n\r\n    if (toTop) {\r\n      for (let i = 0; i < list.length; i++) {\r\n        let dispatcher = /** @type {GameObject} */ (list[i]);\r\n        dispatcher.__invoke(sender, message, ...params);\r\n      }\r\n    } else {\r\n      for (let i = list.length - 1; i >= 0; i--) {\r\n        let dispatcher = /** @type {GameObject} */ (list[i]);\r\n        dispatcher.__invoke(sender, message, ...params);\r\n      }\r\n    }\r\n\r\n    message.sender.__invokeGlobal(message.sender, message, ...params);\r\n  }\r\n\r\n  /**\r\n   * __sendGlobal - Description\r\n   *\r\n   * @param {*}  sender  Description\r\n   * @param {Message}  message Description\r\n   * @param {GameObject=}  origin  Description\r\n   * @param {...*} params  Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __sendGlobal(sender, message, origin, ...params) {\r\n    if (origin === null)\r\n      origin = /** @type {GameObject} */ (message.mOrigin);\r\n\r\n    origin.__invoke(sender, message, ...params);\r\n\r\n    for (let i = 0; i < origin.numChildren; i++) {\r\n      let child = origin.getChildAt(i);\r\n      child.__sendGlobal(sender, message, child, ...params);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {*}  sender\r\n   * @param {Message}  message\r\n   * @param {...*} params\r\n   *\r\n   * @return {void}\r\n   */\r\n  __invoke(sender, message, ...params) {\r\n    if (this.mListeners === null)\r\n      return;\r\n\r\n    let dispatchers = /** @type {Array<{callback: Function, context}>} */ (this.mListeners[message.mName]);\r\n\r\n    if (dispatchers === undefined || dispatchers.length === 0)\r\n      return;\r\n\r\n    if (message.mPathMask !== null) {\r\n      let inPath = this.__checkPath(this.path, message.mPathMask);\r\n      if (!inPath)\r\n        return;\r\n    }\r\n\r\n    // no path filter found - just invoke it\r\n    let clone = dispatchers.slice(0);\r\n\r\n    for (let i = 0; i < clone.length; i++) {\r\n      let dispatcher = /** @type {{callback: Function, context: *}} */ (clone[i]);\r\n      message.mTarget = this;\r\n      dispatcher.callback.call(dispatcher.context, message, ...params);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {*}  sender\r\n   * @param {Message}  message\r\n   * @param {...*} params\r\n   *\r\n   * @return {void}\r\n   */\r\n  __invokeGlobal(sender, message, ...params) {\r\n    let dispatchers = MessageDispatcher.mGlobalHandlers[message.mName];\r\n\r\n    if (dispatchers === undefined || dispatchers.length === 0)\r\n      return;\r\n\r\n    let clone = dispatchers.slice(0);\r\n\r\n    for (let i = 0; i < clone.length; i++) {\r\n      let dispatcher = /** @type {{callback: Function, context: *}} */ (clone[i]);\r\n\r\n      if (!this.__checkPath(sender.path, dispatcher.pathMask))\r\n        continue;\r\n\r\n      message.mTarget = this;\r\n      dispatcher.callback.call(dispatcher.context, message, ...params);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @param {string} path\r\n   * @param {string} pattern\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  __checkPath(path, pathMask) {\r\n    if (path == null || pathMask == null)\r\n      return false;\r\n\r\n    if (path === pathMask)\r\n      return true;\r\n\r\n    if (pathMask.indexOf('*') === -1)\r\n      return path === pathMask;\r\n    else\r\n      return new RegExp(\"^\" + pathMask.split(\"*\").join(\".*\") + \"$\").test(path);\r\n  }\r\n\r\n  // TODO: parse exception path'ses like: ~tatata@@@omg####imnotidiout###@@~~\r\n  /**\r\n   * __parseMessage - Description\r\n   *\r\n   * @param {*} sender Description\r\n   * @param {string} info   Description\r\n   *\r\n   * @return {Message} Description\r\n   */\r\n  __parseMessage(sender, info) {\r\n    // TODO: make message pool... this type of objects shall not be\r\n    // but dont forget to take care about cancel property\r\n\r\n    // EXAMPLES:\r\n    //  this.post('clicked', data); // Sends to all listeners of this\r\n    //  this.post('~clicked', data); // Sends to all listeners of this and to each parent of this object\r\n    //  this.post('clicked@mySprite'); // From top to bottom looking for mySprite\r\n    //  this.post('~clicked@mySprite'); // From this to top over each parent looks for mySprite\r\n    //  this.post('clicked@mySprite#ColliderComponent'); // message to a component with type of ColliderComponent\r\n    //  this.post('~clicked@mySprite#ColliderComponent');\r\n\r\n    // DIRECTIONS\r\n    // clicked - none, direct\r\n    // ~clicked - up, bubbling\r\n    // clicked@ - down starting from root, with no filter to everyone\r\n    // clicked@mySpriter - down with 'mySprite' filter\r\n    // ~clicked@ - inversed bubbling starting from the root, ending at this\r\n\r\n    let result = new Message();\r\n    result.mSender = sender;\r\n    result.mDirection = 'none';\r\n    result.mSibblings = true;\r\n    result.mPathMask = null;\r\n    result.mComponentMask = null;\r\n\r\n    if (info.charAt(0) === '~') {\r\n      result.mSibblings = false;\r\n      result.mDirection = 'up';\r\n    }\r\n\r\n    let ixAt = info.indexOf('@');\r\n    let ixHash = info.indexOf('#');\r\n\r\n    if (ixAt === -1 && ixHash === -1) {\r\n      result.mSibblings = false;\r\n      result.mName = info.substr(result.mDirection === 'up' ? 1 : 0);\r\n      return result;\r\n    }\r\n\r\n    result.mDirection = 'down';\r\n\r\n    if (ixHash === -1) { // we got no hash but we have a dog\r\n      result.mName = info.substring(result.mSibblings ? 0 : 1, ixAt);\r\n\r\n      if (info.length === ixAt + 1)\r\n        result.mPathMask = null;\r\n      else\r\n        result.mPathMask = info.substring(ixAt + 1);\r\n\r\n      return result;\r\n    } else {\r\n      if (ixAt !== -1) {\r\n        result.mPathMask = info.substring(ixAt + 1, ixHash);\r\n        result.mName = info.substring(result.mSibblings ? 0 : 1, ixAt);\r\n      } else {\r\n        result.mName = info.substring(result.mSibblings ? 0 : 1, ixHash);\r\n      }\r\n\r\n      if (info.length === ixHash + 1)\r\n        result.mComponentMask = null;\r\n      else\r\n        result.mComponentMask = info.substring(ixHash + 1);\r\n\r\n      return result;\r\n    }\r\n  }\r\n}\r\n\r\nMessageDispatcher.mGlobalHandlers = {};\r\n\r\n\r\nclass Message {\r\n  constructor() {\r\n    /** @type {*} */\r\n    this.mSender = null;\r\n\r\n    /** @type {string} */\r\n    this.mName;\r\n\r\n    /** @type {string|null} */\r\n    this.mPathMask = null;\r\n\r\n    /** @type {string|null} */\r\n    this.mComponentMask = null;\r\n\r\n    /** @type {string} */\r\n    this.mDirection = 'none';\r\n\r\n    /** @type {boolean} */\r\n    this.mSibblings = false;\r\n\r\n    /** @type {Object} */\r\n    this.mOrigin = null;\r\n\r\n    /** @type {Object} */\r\n    this.mTarget = null;\r\n\r\n    /** @type {boolean} */\r\n    this.mCanceled = false;\r\n  }\r\n\r\n  /**\r\n   * sender - Who send the message\r\n   *\r\n   * @return {*} Description\r\n   */\r\n  get sender() {\r\n    return this.mSender;\r\n  }\r\n\r\n  /**\r\n   * name - The name of the message\r\n   *\r\n   * @return {string}\r\n   */\r\n  get name() {\r\n    return this.mName;\r\n  }\r\n\r\n  /**\r\n   * direction - direction in what message was sent. Can be 'none', 'up' and 'down'.\r\n   *\r\n   * @return {string}\r\n   */\r\n  get direction() {\r\n    return this.mDirection;\r\n  }\r\n\r\n  /**\r\n   * sibblings - Indicates if sibblings should be included into dispatching process.\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get sibblings() {\r\n    return this.mSibblings;\r\n  }\r\n\r\n  /**\r\n   * pathMask - The GameObject.name mask string if was used.\r\n   *\r\n   * @return {string|null} Description\r\n   */\r\n  get pathMask() {\r\n    return this.mPathMask;\r\n  }\r\n\r\n  /**\r\n   * componentMask - Component mask string if was used.\r\n   *\r\n   * @return {string|null}\r\n   */\r\n  get componentMask() {\r\n    return this.mComponentMask;\r\n  }\r\n\r\n  /**\r\n   * origin - The original sender of a message.\r\n   *\r\n   * @return {*|null}\r\n   */\r\n  get origin() {\r\n    return this.mOrigin;\r\n  }\r\n\r\n  /**\r\n   * target - The destination object for this message.\r\n   *\r\n   * @return {*|null}\r\n   */\r\n  get target() {\r\n    return this.mTarget;\r\n  }\r\n\r\n  /**\r\n   * cancel - Stops propagation of the message.\r\n   *\r\n   * @return {void}\r\n   */\r\n  cancel() {\r\n    this.mCanceled = true;\r\n  }\r\n\r\n  /**\r\n   * canceled - True/False if\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  get canceled() {\r\n    return this.mCanceled;\r\n  }\r\n\r\n  static get PROGRESS() {\r\n    return 'progress';\r\n  }\r\n  static get COMPLETE() {\r\n    return 'complete';\r\n  }\r\n}\r\n","\r\nclass Time {\r\n  constructor() {\r\n  }\r\n\r\n  static get time(){\r\n    return Time.mTime;\r\n  }\r\n\r\n  static get dt() {\r\n    return Time.mDeltaTime;\r\n  }\r\n\r\n  static get scale() {\r\n    return Time.mScale;\r\n  }\r\n\r\n  static set scale(value) {\r\n    Debug.assert(value >= 0, 'Time.scale must be >= 0.');\r\n\r\n    Time.mScale = value;\r\n  }\r\n}\r\n\r\n/** @type {number} */\r\nTime.mTime = 0;\r\n\r\n/** @type {number} */\r\nTime.mDeltaTime = 0;\r\n\r\n/** @type {number} */\r\nTime.mScale = 1;\r\n","\r\nclass System extends MessageDispatcher {\r\n  constructor(){\r\n    super();\r\n  }\r\n\r\n\r\n  /**\r\n   * onFixedUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onFixedUpdate(dt){\r\n  }\r\n\r\n\r\n  /**\r\n   * onUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   * @param {number} t Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onUpdate(dt, t){\r\n  }\r\n\r\n  /**\r\n   * onPostUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   * @param {number} t Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onPostUpdate(dt, t){\r\n  }\r\n\r\n\r\n  /**\r\n   * onChildrenAdded - Description\r\n   *\r\n   * @param {GameObject} child Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onChildrenAdded(child){\r\n  }\r\n\r\n\r\n  /**\r\n   * onChildrenRemoved - Description\r\n   *\r\n   * @param {GameObject} child Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onChildrenRemoved(child){\r\n  }\r\n\r\n\r\n  /**\r\n   * onComponentAdded - Description\r\n   *\r\n   * @param {GameObject} child     Description\r\n   * @param {Component} component Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onComponentAdded(child, component)\r\n  {}\r\n\r\n\r\n  /**\r\n   * onComponentRemoved - Description\r\n   *\r\n   * @param {GameObject} child     Description\r\n   * @param {Component} component Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onComponentRemoved(child, component)\r\n  {}\r\n}\r\n","\r\nclass Viewport extends MessageDispatcher {\r\n  /**\r\n   * constructor\r\n   * @param {HTMLElement} containerElement\r\n   * @return {void}\r\n   */\r\n  constructor(containerElement) {\r\n    super();\r\n\r\n    /** @type {HTMLElement} */\r\n    this.mContainerElement = containerElement;\r\n\r\n    this.mContainerElement.style.userSelect = 'none';\r\n    this.mContainerElement.style.touchAction = 'none';\r\n    this.mContainerElement.style.overflow = 'hidden';\r\n    this.mContainerElement.style.cursor = 'auto';\r\n    this.mContainerElement.style.WebkitTapHighlightColor = 'rgba(0, 0, 0, 0)';\r\n\r\n    let size = this.mContainerElement.getBoundingClientRect();\r\n\r\n    /** @type {Rectangle} */\r\n    this.mSize = new Rectangle(size.left, size.top, size.width, size.height);\r\n\r\n    window.addEventListener('resize', x=> this.__onResize());\r\n  }\r\n\r\n  __onResize() {\r\n    let size = this.mContainerElement.getBoundingClientRect();\r\n    this.mSize = new Rectangle(size.left, size.top, size.width, size.height);\r\n\r\n    this.post('resize', this.mSize);\r\n  }\r\n\r\n  /**\r\n   * size - Returns the size of a viewport.\r\n   * @return {Rectangle}\r\n   */\r\n  get size(){\r\n    return this.mSize;\r\n  }\r\n\r\n  /**\r\n   * nativeDOM - Retruns the HTML container element the engine runs in.\r\n   * @return {Element}\r\n   */\r\n  get nativeDOM(){\r\n    return this.mContainerElement;\r\n  }\r\n\r\n  // TODO: dispose, remove resize event\r\n}\r\n","/**\r\n * Component - Description\r\n * @unrestricted\r\n * @extends MessageDispatcher\r\n */\r\n\r\nclass Component extends MessageDispatcher {\r\n  /**\r\n   * constructor - description\r\n   *\r\n   * @return {void}          description\r\n   */\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {number} */\r\n    this.mId = ++GameObject.ID;\r\n\r\n    /** @type {GameObject|null} */\r\n    this.gameObject = null;\r\n\r\n    /** @type {boolean} */\r\n    this.mAdded = false;\r\n  }\r\n\r\n  /**\r\n   * onAdded - description\r\n   *\r\n   * @param  {GameObject} gameObject description\r\n   * @return {void}            description\r\n   */\r\n  onAdded(gameObject) {}\r\n\r\n  /**\r\n   * onRemoved - description\r\n   *\r\n   * @param  {GameObject} gameObject description\r\n   * @return {void}            description\r\n   */\r\n  onRemoved(gameObject) {}\r\n\r\n  /**\r\n   * onFixedUpdate - description\r\n   *\r\n   * @param  {number} dt description\r\n   * @return {void}    description\r\n   */\r\n  onFixedUpdate(dt) {}\r\n\r\n  /**\r\n   * onUpdate - description\r\n   *\r\n   * @param  {number} dt description\r\n   * @return {void}    description\r\n   */\r\n  onUpdate(dt) {}\r\n\r\n  /**\r\n   * onUpdate - description\r\n   *\r\n   * @param  {number} dt description\r\n   * @return {void}    description\r\n   */\r\n  onPostUpdate(dt) {}\r\n\r\n  // TODO: finish\r\n  dispose() {}\r\n\r\n  // TODO: finish\r\n  removeFromParent() {\r\n    if (this.gameObject === null)\r\n      return;\r\n\r\n    this.gameObject.removeComponent(this);\r\n  }\r\n}\r\n\r\n\r\n/** @type {number}\r\n * @nocollapse\r\n */\r\nComponent.ID = 0;\r\n","/**\r\n * GameObject - Base class for all black game objects.\r\n * @unrestricted\r\n * @extends MessageDispatcher\r\n */\r\n\r\nclass GameObject extends MessageDispatcher {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {number} */\r\n    this.mId = ++GameObject.ID;\r\n\r\n    /** @type {string|null} */\r\n    this.mName = null;\r\n\r\n    /** @type {Array<Component>} */\r\n    this.mComponents = [];\r\n\r\n    /** @type {Array<GameObject>} */\r\n    this.mChildren = [];\r\n\r\n    /** @type {number} */\r\n    this.mX = 0;\r\n\r\n    /** @type {number} */\r\n    this.mY = 0;\r\n\r\n    /** @type {number} */\r\n    this.mScaleX = 1;\r\n\r\n    /** @type {number} */\r\n    this.mScaleY = 1;\r\n\r\n    /** @type {number} */\r\n    this.mPivotX = 0;\r\n\r\n    /** @type {number} */\r\n    this.mPivotY = 0;\r\n\r\n    /** @type {number} */\r\n    this.mRotation = 0;\r\n\r\n    /** @type {Rectangle} */\r\n    this.mBounds = null;\r\n\r\n    /** @type {Matrix} */\r\n    this.mLocalTransform = new Matrix();\r\n\r\n    /** @type {Matrix} */\r\n    this.mWorldTransform = new Matrix();\r\n\r\n    /** @type {DirtyFlag} */\r\n    this.mDirty = DirtyFlag.DIRTY;\r\n\r\n    /** @type {GameObject} */\r\n    this.mParent = null;\r\n\r\n    /** @type {string|null} */\r\n    this.mTag = null;\r\n\r\n    /** @type {number} */\r\n    this.mIndex = 0;\r\n\r\n    /** @type {boolean} */\r\n    this.mAdded = false;\r\n  }\r\n\r\n  /**\r\n   * id - Unique object id.\r\n   *\r\n   * @returns {number} Unique object id.\r\n   */\r\n  get id() {\r\n    return this.mId;\r\n  }\r\n\r\n  /**\r\n   * onAdded - This method called each time object added to stage.\r\n   *\r\n   * @return {void}\r\n   */\r\n  onAdded() { }\r\n\r\n  /**\r\n   * onRemoved - Called when object is removed from stage.\r\n   *\r\n   * @return {void}\r\n   */\r\n  onRemoved() {}\r\n\r\n\r\n  /**\r\n   * add - Sugar method for adding child GameObjects or Components.\r\n   *\r\n   * @param {...GameObject|...Component} gameObjectsAndOrComponents A GameObject or Component to add.\r\n   *\r\n   * @return {Array<GameObject|Component>} The passed GameObject or Component.\r\n   */\r\n  add(...gameObjectsAndOrComponents) {\r\n    for (let i = 0; i < gameObjectsAndOrComponents.length; i++) {\r\n      let gooc = gameObjectsAndOrComponents[i];\r\n\r\n      if (gooc instanceof GameObject)\r\n        this.addChild(/* @type {!GameObject} */ (gooc));\r\n      else\r\n        this.addComponent(/* @type {!Component} */ (gooc));\r\n    }\r\n\r\n    return gameObjectsAndOrComponents;\r\n  }\r\n\r\n  /**\r\n   * Adds a child GameObject instance to this GameObject instance. The child is added to the top of all other children in this GameObject instance.\r\n   *\r\n   * @param  {GameObject} child The GameObject instance to add as a child of this GameObject instance.\r\n   * @return {GameObject}\r\n   */\r\n  addChild(child) {\r\n    return this.addChildAt(child, this.mChildren.length);\r\n  }\r\n\r\n  /**\r\n   * Adds a child GameObject instance to this GameObject instance. The child is added to the top of all other children in this GameObject instance.\r\n   *\r\n   * @param  {GameObject} child The GameObject instance to add as a child of this GameObject instance.\r\n   * @param  {number=} index = 0 The index position to which the child is added.\r\n   * @return {GameObject} The GameObject instance that you pass in the child parameter.\r\n   */\r\n  addChildAt(child, index = 0) {\r\n    let numChildren = this.mChildren.length;\r\n\r\n    if (index < 0 || index > numChildren)\r\n      throw new Error('Child index is out of bounds.');\r\n\r\n    if (child.mParent === this)\r\n      return this.setChildIndex(child, index);\r\n\r\n    // this operation should be atomic. since __setParent can throw exception.\r\n    this.mChildren.splice(index, 1, child);\r\n\r\n    child.removeFromParent();\r\n    child.__setParent(this);\r\n\r\n    if (this.root !== null)\r\n      Black.instance.onChildrenAdded(child);\r\n\r\n    return child;\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param {GameObject} value Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  __setParent(value) {\r\n    let p = value;\r\n\r\n    while (p !== null && p !== this)\r\n      p = p.mParent;\r\n\r\n    if (p === this)\r\n      throw new Error('Object cannot be a child to itself.');\r\n\r\n    this.mParent = value;\r\n    this.setTransformDirty();\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * setChildIndex - Sets the index (layer) of the specified GameObject to the specified index (layer).\r\n   *\r\n   * @param {GameObject} child The GameObject instance to change index for.\r\n   * @param {number} index Desired index.\r\n   *\r\n   * @returns {GameObject} The GameObject instance that you pass in the child parameter.\r\n   */\r\n  setChildIndex(child, index) {\r\n    let ix = this.mChildren.indexOf(child);\r\n\r\n    if (ix < 0)\r\n      throw new Error('Child is not a child of this object.');\r\n\r\n    if (ix === index)\r\n      return child;\r\n\r\n    this.mChildren.splice(ix, 1);\r\n    this.mChildren.splice(index, 1, child);\r\n    this.setTransformDirty();\r\n\r\n    return child;\r\n  }\r\n\r\n  /**\r\n   * removeFromParent - Removes this GameObject instance from its parent.\r\n   *\r\n   * @param {boolean} [dispose=false]\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  removeFromParent(dispose = false) {\r\n    if (this.mParent)\r\n      this.mParent.removeChild(this);\r\n\r\n    if (dispose)\r\n      this.dispose();\r\n\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * removeChild - Removes specified GameObjects instance.\r\n   *\r\n   * @param {GameObject} child GameObject instance to remove.\r\n   * @param {boolean} [dispose=false]\r\n   *\r\n   * @return {GameObject} The GameObject instance that you pass in the child parameter.\r\n   */\r\n  removeChild(child, dispose) {\r\n    let ix = this.mChildren.indexOf(child);\r\n\r\n    if (ix < 0)\r\n      return null;\r\n\r\n    return this.removeChildAt(ix);\r\n  }\r\n\r\n\r\n  /**\r\n   * getChildByName\r\n   *\r\n   * @param {string} name\r\n   *\r\n   * @return {GameObject|null}\r\n   */\r\n  getChildByName(name) {\r\n    for (var i = 0; i < this.mChildren.length; i++) {\r\n      if (this.mChildren[i].name === name)\r\n        return this.mChildren[i];\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * removeChildAt - Removes GameObjects instance from specified index.\r\n   *\r\n   * @param {number} index Description\r\n   * @param {boolean} [dispose=false]\r\n   *\r\n   * @return {GameObject} The removed GameObject instance.\r\n   */\r\n  removeChildAt(index, dispose) {\r\n    if (index < 0 || index > this.numChildren)\r\n      throw new Error('Child index is out of bounds.');\r\n\r\n    let hadRoot = this.root !== null;\r\n\r\n    let child = this.mChildren[index];\r\n    child.__setParent(null);\r\n\r\n    this.mChildren.splice(index, 1);\r\n\r\n    if (hadRoot)\r\n      Black.instance.onChildrenRemoved(child);\r\n\r\n    if (dispose)\r\n      child.dispose();\r\n\r\n    this.setTransformDirty();\r\n\r\n    return child;\r\n  }\r\n\r\n  /**\r\n   * getChildAt - Returns GameObject at specified index.\r\n   *\r\n   * @param {number} index The index of child GameObject.\r\n   *\r\n   * @return {GameObject} The GameObject at specified index.\r\n   */\r\n  getChildAt(index) {\r\n    return this.mChildren[index];\r\n  }\r\n\r\n  /**\r\n   * addComponent - Adds Component instance to the end of the list,\r\n   *\r\n   * @param  {Component} component Component instance or instances.\r\n   * @return {Component} The Component instance you pass in the instances parameter.\r\n   */\r\n  addComponent(component) {\r\n    let instance = component;\r\n\r\n    if (instance.gameObject)\r\n      throw new Error('Component cannot be added to two game objects at the same time.');\r\n\r\n    this.mComponents.push(instance);\r\n    instance.gameObject = this;\r\n\r\n    if (this.root !== null)\r\n      Black.instance.onComponentAdded(this, instance);\r\n\r\n    instance.onAdded(this);\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * removeComponent - Description\r\n   *\r\n   * @param {Component} instance Description\r\n   *\r\n   * @return {Component|null} Description\r\n   */\r\n  removeComponent(instance) {\r\n    if (!instance)\r\n      return null;\r\n\r\n    let index = this.mComponents.indexOf(instance);\r\n    if (index > -1)\r\n      this.mComponents.splice(index, 1);\r\n\r\n    // detach game object after or before?\r\n    instance.gameObject = null;\r\n    instance.onRemoved(this);\r\n\r\n    if (this.root !== null)\r\n      Black.instance.onComponentRemoved(this, instance);\r\n\r\n    return instance;\r\n  }\r\n\r\n  /**\r\n   * getComponent\r\n   *\r\n   * @param {*} typeName\r\n   *\r\n   * @return {Component|null}\r\n   */\r\n  getComponent(typeName) {\r\n    for (let i = 0; i < this.mComponents.length; i++) {\r\n      let c = this.mComponents[i];\r\n      if (c instanceof typeName)\r\n        return c;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n\r\n  /**\r\n   * numComponenets - Returns number of component's\r\n   *\r\n   * @return {number}\r\n   */\r\n  get numComponenets() {\r\n    return this.mComponents.length;\r\n  }\r\n\r\n\r\n  /**\r\n   * getComponentAt - Retrives Component at given index.\r\n   *\r\n   * @param {number} index\r\n   *\r\n   * @return {Component|null}\r\n   */\r\n  getComponentAt(index) {\r\n    if (index >= 0 && index < this.mComponents.length)\r\n      return this.mComponents[index];\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * localTransformation - Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  get localTransformation() {\r\n    if (this.mDirty & DirtyFlag.LOCAL) {\r\n      this.mDirty ^= DirtyFlag.LOCAL;\r\n\r\n      if (this.mRotation === 0) {\r\n        let tx = this.mX - this.mPivotX * this.mScaleX;\r\n        let ty = this.mY - this.mPivotY * this.mScaleY;\r\n        return this.mLocalTransform.set(this.mScaleX, 0, 0, this.mScaleY, tx, ty);\r\n      } else {\r\n        let cos = Math.cos(this.mRotation);\r\n        let sin = Math.sin(this.mRotation);\r\n        let a = this.mScaleX * cos;\r\n        let b = this.mScaleX * sin;\r\n        let c = this.mScaleY * -sin;\r\n        let d = this.mScaleY * cos;\r\n        let tx = this.mX - this.mPivotX * a - this.mPivotY * c;\r\n        let ty = this.mY - this.mPivotX * b - this.mPivotY * d;\r\n        return this.mLocalTransform.set(a, b, c, d, tx, ty);\r\n      }\r\n    }\r\n\r\n    return this.mLocalTransform;\r\n  }\r\n\r\n  /**\r\n   * worldTransformation - returns cloned Matrix object which represents object orientation in world space.\r\n   *\r\n   * @return {Matrix}\r\n   */\r\n  get worldTransformation() {\r\n    if (this.mDirty & DirtyFlag.WORLD) {\r\n      this.mDirty ^= DirtyFlag.WORLD;\r\n\r\n      if (this.mParent)\r\n        this.mParent.worldTransformation.copyTo(this.mWorldTransform).append(this.localTransformation);\r\n      else\r\n        this.localTransformation.copyTo(this.mWorldTransform);\r\n    }\r\n\r\n    return this.mWorldTransform.clone();\r\n  }\r\n\r\n  /**\r\n   * worldTransformationInversed - Description\r\n   *\r\n   * @return {Matrix} Description\r\n   */\r\n  get worldTransformationInversed() {\r\n    // TODO: optimize, cache\r\n    return this.worldTransformation.clone().invert();\r\n  }\r\n\r\n  /**\r\n   * __fixedUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __fixedUpdate(dt) {\r\n    this.onFixedUpdate(dt);\r\n\r\n    for (let k = 0; k < this.mComponents.length; k++) {\r\n      let c = this.mComponents[k];\r\n      c.gameObject = this;\r\n      c.onFixedUpdate(dt);\r\n    }\r\n\r\n    for (let i = 0; i < this.mChildren.length; i++)\r\n      this.mChildren[i].__fixedUpdate(dt);\r\n  }\r\n\r\n  /**\r\n   * __update - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __update(dt) {\r\n    this.onUpdate(dt);\r\n\r\n    for (let k = 0; k < this.mComponents.length; k++) {\r\n      let c = this.mComponents[k];\r\n      c.gameObject = this;\r\n      c.onUpdate(dt);\r\n    }\r\n\r\n    for (let i = 0; i < this.mChildren.length; i++)\r\n      this.mChildren[i].__update(dt);\r\n  }\r\n\r\n  /**\r\n   * __update - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __postUpdate(dt) {\r\n    this.onPostUpdate(dt);\r\n\r\n    for (let k = 0; k < this.mComponents.length; k++) {\r\n      let c = this.mComponents[k];\r\n      c.gameObject = this;\r\n      c.onPostUpdate(dt);\r\n    }\r\n\r\n    for (let i = 0; i < this.mChildren.length; i++) {\r\n      this.mChildren[i].__postUpdate(dt);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onFixedUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onFixedUpdate(dt) {}\r\n\r\n  /**\r\n   * onUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onUpdate(dt) {}\r\n\r\n  /**\r\n   * onUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onPostUpdate(dt) {}\r\n\r\n  /**\r\n   * __render - Description\r\n   *\r\n   * @param {VideoNullDriver} video           Description\r\n   * @param {number} time            Description\r\n   * @param {number} parentAlpha     Description\r\n   * @param {string} parentBlendMode Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __render(video, time, parentAlpha, parentBlendMode) {\r\n    this.onRender(video, time);\r\n\r\n    let child = null;\r\n    for (let i = 0; i < this.mChildren.length; i++) {\r\n      child = this.mChildren[i];\r\n      child.__render(video, time, parentAlpha, parentBlendMode);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onRender - Description\r\n   *\r\n   * @param {VideoNullDriver} video Description\r\n   * @param {number} time  Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onRender(video, time) {}\r\n\r\n  /**\r\n   * onGetLocalBounds - Override this method if you need to specify GameObject size. Should be always be a local coordinates.\r\n   *\r\n   * @protected\r\n   * @param {Rectangle=} outRect Description\r\n   *\r\n   * @return {Rectangle} bounds in local space withoout taking care about transformation matrix\r\n   */\r\n  onGetLocalBounds(outRect = undefined) {\r\n    outRect = outRect || new Rectangle();\r\n    return outRect.set(0, 0, 0, 0);\r\n  }\r\n\r\n  /**\r\n   * getBounds - Returns world bounds of this object and all children if specified (true by default).\r\n   * object.getBounds() - relative to world.\r\n   * object.getBounds(object) - local bounds.\r\n   * object.getBounds(object.parent) - relative to parent.\r\n   * object.getBounds(objectB) - relative to objectB space.\r\n   *\r\n   * @param {GameObject} [space=undefined]\r\n   * @param {boolean} [includeChildren=true]\r\n   * @param {Rectangle=} [outRect=null]\r\n   *\r\n   * @return {Rectangle} returns bounds of the object and all childrens\r\n   */\r\n  getBounds(space = undefined, includeChildren = true, outRect = undefined) {\r\n    outRect = outRect || new Rectangle();\r\n\r\n    let matrix = this.worldTransformation;\r\n\r\n    // TODO: optimize, check if space == null, space == this, space == parent\r\n    // TODO: use wtInversed instead\r\n    if (space != null) {\r\n      matrix = this.worldTransformation.clone();\r\n      matrix.prepend(space.worldTransformation.clone().invert());\r\n    }\r\n\r\n    let bounds = new Rectangle();\r\n    this.onGetLocalBounds(bounds);\r\n\r\n    matrix.transformRect(bounds, bounds);\r\n    outRect.expand(bounds.x, bounds.y, bounds.width, bounds.height);\r\n\r\n    if (includeChildren)\r\n      for (let i = 0; i < this.numChildren; i++)\r\n        this.getChildAt(i).getBounds(space, includeChildren, outRect);\r\n\r\n    return outRect;\r\n  }\r\n\r\n  /**\r\n   * setTransform -\r\n   *\r\n   * @param {number} [x=0]      x-cord\r\n   * @param {number} [y=0]      y-cord\r\n   * @param {number} [r=0]      rotation\r\n   * @param {number} [scaleX=1] scale-x\r\n   * @param {number} [scaleY=1] scale-y\r\n   * @param {number} [anchorX=0] anchor-x\r\n   * @param {number} [anchorY=0] anchor-y\r\n   * @param {number} [includeChildren=true] include children when adjusting pivot?\r\n   *\r\n   * @return {GameObject}\r\n   */\r\n  setTransform(x = 0, y = 0, r = 0, scaleX = 1, scaleY = 1, anchorX = 0, anchorY = 0, includeChildren = true) {\r\n    this.mX = x;\r\n    this.mY = y;\r\n    this.mRotation = r;\r\n    this.mScaleX = scaleX;\r\n    this.mScaleY = scaleY;\r\n\r\n    this.getBounds(this, includeChildren, Rectangle.__cache.zero());\r\n    this.mPivotX = Rectangle.__cache.width * anchorX;\r\n    this.mPivotY = Rectangle.__cache.height * anchorY;\r\n\r\n    this.setTransformDirty();\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * localToGlobal - Description\r\n   *\r\n   * @param {Vector} localPoint       Description\r\n   * @param {Vector|null} [outVector=null] Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  localToGlobal(localPoint, outVector = null) {\r\n    return this.worldTransformation.transformVector(localPoint, outVector);\r\n  }\r\n\r\n  /**\r\n   * globalToLocal - Description\r\n   *\r\n   * @param {Vector} globalPoint       Description\r\n   * @param {Vector|null} [outVector=null] Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  globalToLocal(globalPoint, outVector = null) {\r\n    return this.worldTransformationInversed.transformVector(globalPoint, outVector);\r\n  }\r\n\r\n  /*:--- PROPERTIES ---:*/\r\n\r\n  /**\r\n   * numChildren - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get numChildren() {\r\n    return this.mChildren.length;\r\n  }\r\n\r\n  /**\r\n   * name - Description\r\n   *\r\n   * @return {string|null} Description\r\n   */\r\n  get name() {\r\n    return this.mName;\r\n  }\r\n\r\n  /**\r\n   * name - Description\r\n   *\r\n   * @param {string|null} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set name(value) {\r\n    this.mName = value;\r\n  }\r\n\r\n  /**\r\n   * x - Gets the x coordinate of the GameoObject instance relative to the local coordinates of the parent GameoObject.\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get x() {\r\n    return this.mX;\r\n  }\r\n\r\n  /**\r\n   * x - Sets the x coordinate of the GameoObject instance relative to the local coordinates of the parent GameoObject.\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set x(value) {\r\n    if (this.mX == value)\r\n      return;\r\n\r\n    this.mX = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * y - Gets the y coordinate of the GameoObject instance relative to the local coordinates of the parent GameoObject.\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get y() {\r\n    return this.mY;\r\n  }\r\n\r\n  /**\r\n   * y - Sets the y coordinate of the GameoObject instance relative to the local coordinates of the parent GameoObject.\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set y(value) {\r\n    if (this.mY == value)\r\n      return;\r\n\r\n    this.mY = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * pivotX - Description\r\n   * @export\r\n   * @return {number} Description\r\n   */\r\n  get pivotX() {\r\n    return this.mPivotX;\r\n  }\r\n\r\n  /**\r\n   * pivotX - Description\r\n   *\r\n   * @export\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set pivotX(value) {\r\n    if (this.mPivotX == value)\r\n      return;\r\n\r\n    this.mPivotX = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * pivotY - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get pivotY() {\r\n    return this.mPivotY;\r\n  }\r\n\r\n  /**\r\n   * pivotY - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set pivotY(value) {\r\n    if (this.mPivotY == value)\r\n      return;\r\n\r\n    this.mPivotY = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * alignPivot\r\n   *\r\n   * @param {number}  [ax=0.5]\r\n   * @param {number}  [ay=0.5]\r\n   * @param {boolean} [includeChildren=true]\r\n   *\r\n   * @return {GameObject}\r\n   */\r\n  alignPivot(ax = 0.5, ay = 0.5, includeChildren = true) {\r\n    this.getBounds(this, includeChildren, Rectangle.__cache.zero());\r\n\r\n    this.mPivotX = Rectangle.__cache.width * ax;\r\n    this.mPivotY = Rectangle.__cache.height * ay;\r\n    this.setTransformDirty();\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * scaleX - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get scaleX() {\r\n    return this.mScaleX;\r\n  }\r\n\r\n  /**\r\n   * scaleX - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set scaleX(value) {\r\n    if (this.mScaleX == value)\r\n      return;\r\n\r\n    this.mScaleX = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * scaleY - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get scaleY() {\r\n    return this.mScaleY;\r\n  }\r\n\r\n  /**\r\n   * scaleY - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set scaleY(value) {\r\n    if (this.mScaleY == value)\r\n      return;\r\n\r\n    this.mScaleY = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * rotation - returns current rotation\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get rotation() {\r\n    return this.mRotation;\r\n  }\r\n\r\n  /**\r\n   * rotation - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set rotation(value) {\r\n    if (this.mRotation == value)\r\n      return;\r\n\r\n    this.mRotation = value;\r\n    this.setTransformDirty();\r\n  }\r\n\r\n  /**\r\n   * parent - Description\r\n   *\r\n   * @return {GameObject} Description\r\n   */\r\n  get parent() {\r\n    return this.mParent;\r\n  }\r\n\r\n  /**\r\n   * root - Description\r\n   *\r\n   * @return {GameObject|null} Description\r\n   */\r\n  get root() {\r\n    let current = this;\r\n\r\n    if (current === Black.instance.root)\r\n      return current;\r\n\r\n    while (current.mParent) {\r\n      if (current === Black.instance.root)\r\n        return current;\r\n      else if (current.mParent === Black.instance.root)\r\n        return Black.instance.root;\r\n      else\r\n        current = current.mParent;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * depth - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get depth() {\r\n    if (this.mParent)\r\n      return this.mParent.depth + 1;\r\n    else\r\n      return 0;\r\n  }\r\n\r\n  /**\r\n   * index - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get index() {\r\n    return this.mIndex;\r\n  }\r\n\r\n  /**\r\n   * width - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get width() {\r\n    return this.getBounds(this.mParent).width;\r\n  }\r\n\r\n  /**\r\n   * width - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set width(value) {\r\n    this.scaleX = 1;\r\n    const currentWidth = this.width;\r\n\r\n    if (currentWidth != 0.0)\r\n      this.scaleX = value / currentWidth;\r\n  }\r\n\r\n  /**\r\n   * height - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get height() {\r\n    return this.getBounds(this.mParent).height;\r\n  }\r\n\r\n  /**\r\n   * height - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set height(value) {\r\n    this.scaleY = 1;\r\n    const currentHeight = this.height;\r\n\r\n    if (currentHeight != 0)\r\n      this.scaleY = value / currentHeight;\r\n  }\r\n\r\n\r\n  /**\r\n   * localWidth - returns height in local space without children.\r\n   *\r\n   * @return {number}\r\n   */\r\n  get localWidth() {\r\n    return this.getBounds(this, false).width;\r\n  }\r\n\r\n\r\n  /**\r\n   * localHeight - returns height in local space without children.\r\n   *\r\n   * @return {number}\r\n   */\r\n  get localHeight() {\r\n    return this.getBounds(this, false).height;\r\n  }\r\n\r\n  // TODO: precache\r\n  /**\r\n   * path - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get path() {\r\n    if (this.mParent !== null)\r\n      return this.mParent.path + '/' + this.mName;\r\n\r\n    return this.mName;\r\n  }\r\n\r\n  /**\r\n   * tag - Description\r\n   *\r\n   * @return {string|null} Description\r\n   */\r\n  get tag() {\r\n    return this.mTag;\r\n  }\r\n\r\n  /**\r\n   * tag - Description\r\n   *\r\n   * @param {string|null} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set tag(value) {\r\n    if (this.mTag === value)\r\n      return;\r\n\r\n    /** @type {string|null} */\r\n    let old = this.mTag;\r\n    this.mTag = value;\r\n\r\n    if (this.mAdded)\r\n      Black.instance.onTagUpdated(this, old, value);\r\n  }\r\n\r\n\r\n  /**\r\n   * co - Starts coroutine.\r\n   *\r\n   * @param {Function} gen\r\n   * @param {*=} [ctx=null]\r\n   *\r\n   * @return {Generator}\r\n   */\r\n  spawn(gen, ctx = null) {\r\n    var iter = gen.apply(ctx == null ? this : ctx);\r\n\r\n    function step(it) {\r\n      if (it.done)\r\n        return;\r\n\r\n      if (typeof it.value === 'function')\r\n        it.value(x => step(iter.next(x)));\r\n      else\r\n        step(iter.next(it.value));\r\n    }\r\n\r\n    step(iter.next());\r\n    return iter;\r\n  }\r\n\r\n\r\n  /**\r\n   * @return {function(gen:*):*}\r\n   */\r\n  wait(seconds = 1) {\r\n    return cb => setTimeout(cb.bind(this, seconds * 1000), seconds * 1000);\r\n  }\r\n\r\n\r\n  /**\r\n   * waitMessage - Waits for a speceific message\r\n   *\r\n   * @param {string} message The name of the message to wait for\r\n   *\r\n   * @return {function(gen:*):*} Description\r\n   */\r\n  waitMessage(message) {\r\n    return cb => this.on(message, cb.bind(this));\r\n  }\r\n\r\n\r\n  /**\r\n   * setDirty\r\n   *\r\n   * @param {DirtyFlag} flag\r\n   * @param {boolean} [includeChildren=true] Description\r\n   *\r\n   * @return {void}\r\n   */\r\n  setDirty(flag, includeChildren = true) {\r\n    if (includeChildren) {\r\n      GameObject.forEach(this, x=> {\r\n        x.mDirty |= flag;\r\n      });\r\n    } else {\r\n      this.mDirty |= flag;\r\n    }\r\n  }\r\n\r\n  setTransformDirty() {\r\n    this.setDirty(DirtyFlag.LOCAL, false);\r\n    this.setDirty(DirtyFlag.WORLD, true);\r\n  }\r\n\r\n  /**\r\n   * dispose\r\n   *\r\n   * @return {void}\r\n   */\r\n  dispose() {\r\n  }\r\n\r\n  // TODO: rename method\r\n  /**\r\n   * getBoundsWithPoints - Description\r\n   *\r\n   * @param {Array<number>} points              Description\r\n   * @param {Matrix} worldTransformation Description\r\n   * @param {Rectangle=} outRect             Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  static getBoundsWithPoints(points, worldTransformation, outRect) {\r\n    outRect = outRect || new Rectangle();\r\n\r\n    let minX = Number.MAX_VALUE;\r\n    let maxX = -Number.MAX_VALUE;\r\n    let minY = Number.MAX_VALUE;\r\n    let maxY = -Number.MAX_VALUE;\r\n    let xx = 0;\r\n    let yy = 0;\r\n    let tmpVector = new Vector();\r\n\r\n    for (let i = 0; i < points.length; i += 2) {\r\n      worldTransformation.transformXY(points[i], points[i + 1], tmpVector);\r\n\r\n      if (minX > tmpVector.x)\r\n        minX = tmpVector.x;\r\n\r\n      if (maxX < tmpVector.x)\r\n        maxX = tmpVector.x;\r\n\r\n      if (minY > tmpVector.y)\r\n        minY = tmpVector.y;\r\n\r\n      if (maxY < tmpVector.y)\r\n        maxY = tmpVector.y;\r\n    }\r\n\r\n    outRect.set(minX, minY, maxX - minX, maxY - minY);\r\n    return outRect;\r\n  }\r\n\r\n  /**\r\n   * intersects - Description\r\n   *\r\n   * @param {GameObject} gameObject Description\r\n   * @param {Vector} point      Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  static intersects(gameObject, point) {\r\n    let tmpVector = new Vector();\r\n    let inv = gameObject.worldTransformation.invert();\r\n\r\n    inv.transformVector(point, tmpVector);\r\n\r\n    let rect = gameObject.getBounds(gameObject, false);\r\n    return rect.containsXY(tmpVector.x, tmpVector.y);\r\n  }\r\n\r\n  /**\r\n   * intersectsAt - Description\r\n   *\r\n   * @param {GameObject} gameObject Description\r\n   * @param {Vector} point      Description\r\n   * @param {Vector=} outVector  Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  static intersectsAt(gameObject, point, outVector = undefined) {\r\n    outVector = outVector || new Vector();\r\n\r\n    let tmpVector = Vector.__cache;\r\n    let inv = gameObject.worldTransformationInversed;\r\n\r\n    inv.transformVector(point, tmpVector);\r\n\r\n    let rect = gameObject.getBounds(gameObject, false);\r\n    let contains = rect.containsXY(tmpVector.x, tmpVector.y);\r\n\r\n    if (!contains)\r\n      return false;\r\n\r\n    outVector.x = tmpVector.x - rect.x;\r\n    outVector.y = tmpVector.y - rect.y;\r\n    return true;\r\n  }\r\n\r\n  /**\r\n   * intersectsWith - Description\r\n   *\r\n   * @param {GameObject} gameObject Description\r\n   * @param {Vector} point      Description\r\n   *\r\n   * @return {GameObject|null} returns object or null\r\n   */\r\n  static intersectsWith(gameObject, point) {\r\n    let obj = null;\r\n    for (let i = gameObject.numChildren - 1; i >= 0; --i) {\r\n      let child = gameObject.mChildren[i];\r\n\r\n      obj = GameObject.intersectsWith(child, point);\r\n      if (obj != null)\r\n        return obj;\r\n\r\n      let inside = GameObject.intersects(child, point);\r\n      if (inside) {\r\n        obj = child;\r\n        break;\r\n      }\r\n    }\r\n\r\n    if (obj === null && GameObject.intersects(gameObject, point)) {\r\n      return gameObject;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * findWithTag - Description\r\n   *\r\n   * @param {string} tag Description\r\n   *\r\n   * @return {Array<GameObject>|null} Description\r\n   */\r\n  static findWithTag(tag) {\r\n    if (Black.instance.mTagCache.hasOwnProperty(tag) === false)\r\n      return null;\r\n\r\n    return Black.instance.mTagCache[tag];\r\n  }\r\n\r\n  /**\r\n   * findComponents - Returns a list of Components\r\n   *\r\n   * @param {GameObject} gameObject\r\n   * @param {function (new:Component)} type\r\n   *\r\n   * @return {Array<Component>}\r\n   */\r\n  static findComponents(gameObject, type) {\r\n    Debug.assert(gameObject !== null, 'gameObject cannot be null.');\r\n    Debug.assert(type !== null, 'type cannot be null.');\r\n\r\n    /** @type {Array<Component>} */\r\n    let list = [];\r\n\r\n    /** @type {function(GameObject, function(new:Component)):void} */\r\n    let f = function(gameObject, type) {\r\n      for (let i = 0; i < gameObject.mComponents.length; i++) {\r\n        let c = gameObject.mComponents[i];\r\n        if (c instanceof type)\r\n          list.push(c);\r\n      }\r\n\r\n      for (let i = 0; i < gameObject.mChildren.length; i++)\r\n        f(gameObject.mChildren[i], type);\r\n    };\r\n\r\n    f(gameObject, type);\r\n\r\n    return list;\r\n  }\r\n\r\n  /**\r\n   * forEach - Runs action accross all object mathing the name.\r\n   *\r\n   * @param {GameObject} node   Description\r\n   * @param {function(node:GameObject)} action Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  static forEach(node, action) {\r\n    if (node == null)\r\n      node = Black.instance.root;\r\n\r\n    action(node);\r\n\r\n    for (let i = 0; i < node.numChildren; i++)\r\n      GameObject.forEach(node.getChildAt(i), action);\r\n  }\r\n\r\n\r\n  /**\r\n   * find - Finds object by its name.\r\n   *\r\n   * @param {string} name Description\r\n   * @param {GameObject} node Description\r\n   *\r\n   * @return {GameObject} Description\r\n   */\r\n  static find(name, node) {\r\n    if (node == null)\r\n      node = Black.instance.root;\r\n\r\n    if (node.name === name)\r\n      return node;\r\n\r\n    for (let i = 0; i < node.numChildren; i++) {\r\n      let r = GameObject.find(name, node.getChildAt(i));\r\n      if (r != null)\r\n        return r;\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n\r\n/** @type {number}\r\n * @nocollapse\r\n */\r\nGameObject.ID = 0;\r\n\r\n/**\r\n * @enum {number}\r\n */\r\n\r\nvar DirtyFlag = {\r\n  LOCAL: 1,\r\n  WORLD: 2,\r\n  DIRTY: 0xffffff\r\n};\r\n","// TODO:\r\n// [_] Do not handle is loaded or not.\r\n// Texture shall not be responsible for loading itself.\r\n// We have TextureAsset for it.\r\n// native size - always the size of physical texture\r\n// source size - the original size of a texture to\r\n//\r\n\r\n\r\nclass Texture {\r\n  /**\r\n   * @param  {Image} nativeTexture description\r\n   * @param  {Rectangle=} region = undefined description\r\n   * @param  {Rectangle=} untrimmedRect = undefined description\r\n   */\r\n  constructor(nativeTexture, region, untrimmedRect) {\r\n    /** @type {Image} */\r\n    this.mTexture = nativeTexture;\r\n\r\n    /** @type {Rectangle} */\r\n    this.mRegion;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsSubtexture = false;\r\n\r\n    /** @type {number} */\r\n    this.mId = ++Texture.__ID;\r\n\r\n    if (region === undefined) {\r\n      this.mRegion = new Rectangle(0, 0, nativeTexture.naturalWidth, nativeTexture.naturalHeight);\r\n    } else {\r\n      this.mRegion = /** @type {Rectangle} */ (region);\r\n      this.mIsSubtexture = true;\r\n    }\r\n\r\n    /** @type {boolean} */\r\n    this.mTrimmed = untrimmedRect !== undefined;\r\n\r\n    if (this.mTrimmed === false)\r\n      untrimmedRect = new Rectangle(0, 0, this.mRegion.width, this.mRegion.height);\r\n\r\n    /** @type {Rectangle} */\r\n    this.mUntrimmedRect = /** @type {Rectangle} */ (untrimmedRect);\r\n\r\n    /** @type {boolean} */\r\n    this.mIsLoaded = true;\r\n  }\r\n\r\n  /**\r\n   * id - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get id() {\r\n    return this.mId;\r\n  }\r\n\r\n  /**\r\n   * isTrimmed - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get isTrimmed() {\r\n    return this.mTrimmed;\r\n  }\r\n\r\n  /**\r\n   * isSubTexture - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get isSubTexture() {\r\n    return this.mIsSubtexture;\r\n  }\r\n\r\n  // TODO: if we update texture we have to nofity everything, send signal\r\n  // update(nativeTexture = null, region = null, source = null, crop = null){\r\n  // }\r\n\r\n  // render width\r\n  // render height\r\n  // croppedWidth, croppedHeight\r\n  // width, height\r\n  //\r\n\r\n  /**\r\n   * untrimmedRect - Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  get untrimmedRect() {\r\n    return this.mUntrimmedRect;\r\n  }\r\n\r\n  /**\r\n   * width - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get width() {\r\n    if (this.mRegion)\r\n      return this.mRegion.width;\r\n\r\n    return this.mTexture.naturalWidth;\r\n  }\r\n\r\n  /**\r\n   * height - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get height() {\r\n    if (this.mRegion)\r\n      return this.mRegion.height;\r\n\r\n    return this.mTexture.naturalHeight;\r\n  }\r\n\r\n  /**\r\n   * region - Description\r\n   *\r\n   * @return {Rectangle} Description\r\n   */\r\n  get region() {\r\n    return this.mRegion;\r\n  }\r\n\r\n  /**\r\n   * native - Description\r\n   *\r\n   * @return {Image} Description\r\n   */\r\n  get native() {\r\n    return this.mTexture;\r\n  }\r\n\r\n  /**\r\n   * isLoaded - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get isLoaded() {\r\n    return this.mIsLoaded;\r\n  }\r\n\r\n  /**\r\n   * type - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get type() {\r\n    return 'Texture';\r\n  }\r\n\r\n  /**\r\n   * baseType - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get baseType() {\r\n    return 'Texture';\r\n  }\r\n\r\n  /**\r\n   * dispose - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  dispose() {\r\n    this.mTexture = null;\r\n  }\r\n\r\n  /**\r\n   * fromBase64String - Description\r\n   *\r\n   * @param {string} string Description\r\n   *\r\n   * @return {Texture} Description\r\n   */\r\n  static fromBase64String(string) {\r\n    let imgElement = new Image();\r\n    imgElement.src = string;\r\n    return new Texture(imgElement);\r\n  }\r\n\r\n\r\n  /**\r\n   * fromCanvasAsImage - Description\r\n   *\r\n   * @param {HTMLElement}   canvas           Description\r\n   * @param {string} [type=image/png] Description\r\n   * @param {number} [quality=1]      Description\r\n   *\r\n   * @return {Texture} Description\r\n   */\r\n  static fromCanvasAsImage(canvas, type = 'image/png', quality = 1) {\r\n    let imgElement = new Image();\r\n    imgElement.src = canvas.toDataURL(type, quality);\r\n\r\n    return new Texture(imgElement);\r\n  }\r\n\r\n\r\n  /**\r\n   * fromCanvas - Description\r\n   *\r\n   * @param {HTMLElement} canvas Description\r\n   *\r\n   * @return {Texture} Description\r\n   */\r\n  static fromCanvas(canvas) {\r\n    return Black.instance.video.getTextureFromCanvas(canvas);\r\n  }\r\n}\r\n\r\n/** @type {number}\r\n * @nocollapse\r\n */\r\nTexture.__ID = 0;\r\n\r\n/** @type {Image|null}\r\n * @nocollapse\r\n */\r\nTexture.MISSING_IMAGE_CACHE = null;\r\n","\r\nclass AtlasTexture extends Texture {\r\n  /**\r\n   * constructor - Creates an Texture Atlas\r\n   *\r\n   * @param {Texture} texture A base texture object.\r\n   * @param {{meta: *, frames: *}} jsonObject\r\n   *\r\n   * @return {void}\r\n   */\r\n  constructor(texture, jsonObject) {\r\n    super(texture.native);\r\n\r\n    /** @type {Object} */\r\n    this.mMeta = {};\r\n\r\n    /** @dict */\r\n    this.mSubTextures = {}; // dictionary\r\n\r\n    this.__parseJson(jsonObject);\r\n  }\r\n\r\n  /**\r\n   * __parseJson\r\n   *\r\n   * @param  {{meta: *, frames: *}} o\r\n   * @return {void}\r\n   */\r\n  __parseJson(o) {\r\n    const NEGATIVE_HALF_PI = -(Math.PI / 2);\r\n\r\n    // if (o.meta.format)\r\n    //   this.mMeta.format = o.meta.format;\r\n    //\r\n    // if (o.meta.scale)\r\n    //   this.mMeta.scale = parseFloat(o.meta.scale);\r\n\r\n    for (let key in o.frames) {\r\n      let data = /** @type {Array<number>} */ (o.frames[key]);\r\n\r\n      let region = new Rectangle(data[0], data[1], data[2], data[3]);\r\n      let untrimmedRect = new Rectangle(data[4], data[5], data[6], data[7]);\r\n\r\n      this.mSubTextures[key] = new Texture(this.native, region, untrimmedRect);\r\n    }\r\n  }\r\n\r\n  // addRegion(name, region, frame) {}\r\n  //\r\n  // removeRegion() {}\r\n\r\n  /**\r\n   * getTexture - Returns the textures by a given name.\r\n   *\r\n   * @param {string} name\r\n   *\r\n   * @return {Texture} The Texture or null;\r\n   */\r\n  getTexture(name) {\r\n    /** @type {Texture} */\r\n    let t = this.mSubTextures[name];\r\n    if (t === undefined)\r\n      console.warn('Texture \\'%s\\' was not found in cache.', name);\r\n\r\n    return /** @type {Texture} */ (t);\r\n  }\r\n\r\n  /**\r\n   * getTextures - Returns list of Textures.\r\n   *\r\n   * @param {string|null} [nameMask=null] The mask to filter by.\r\n   * @param {Array<Texture>|null} outTextures\r\n   *\r\n   * @return {Array<Texture>} The list of found textures.\r\n   */\r\n  getTextures(nameMask = null, outTextures = null) {\r\n    let out = outTextures || [];\r\n    if (nameMask === null) {\r\n      for (let key in this.mSubTextures)\r\n        out.push(this.mSubTextures[key]);\r\n\r\n      return /** @type {Array<Texture>} */ (out);\r\n    }\r\n\r\n    let names = [];\r\n\r\n    // TODO: make helper wild function\r\n    let re = new RegExp(\"^\" + nameMask.split(\"*\").join(\".*\") + \"$\");\r\n    for (let key in this.mSubTextures)\r\n      if (re.test(key))\r\n        names.push(key);\r\n\r\n    names.sort(this.__naturalComparer);\r\n\r\n    for (let i = 0; i < names.length; i++)\r\n      out.push(this.mSubTextures[names[i]]);\r\n\r\n    return out;\r\n  }\r\n\r\n  /**\r\n   * @param {*} a\r\n   * @param {*} b\r\n   *\r\n   * @return {number}\r\n   */\r\n  __naturalComparer(a, b) {\r\n    const NUMBER_GROUPS = /(-?\\d*\\.?\\d+)/g;\r\n    let aa = String(a).split(NUMBER_GROUPS);\r\n    let bb = String(b).split(NUMBER_GROUPS);\r\n    let min = Math.min(aa.length, bb.length);\r\n\r\n    for (let i = 0; i < min; i++) {\r\n      let x = parseFloat(aa[i]) || aa[i].toLowerCase();\r\n      let y = parseFloat(bb[i]) || bb[i].toLowerCase();\r\n\r\n      if (x < y)\r\n        return -1;\r\n      else if (x > y)\r\n        return 1;\r\n    }\r\n\r\n    return 0;\r\n  };\r\n\r\n  //dispose() {}\r\n}\r\n","// TODO: handle errors\r\n// TODO: v2: parallel loading?\r\n//\r\n//\r\n\r\nclass Asset extends MessageDispatcher {\r\n  /**\r\n   * @param  {string} name description\r\n   * @param  {string} url  description\r\n   */\r\n  constructor(name, url) {\r\n    super();\r\n\r\n    /** @type {string} */\r\n    this.mName = name;\r\n\r\n    /** @type {string} */\r\n    this.mUrl = url;\r\n\r\n    /** @type {*|null} */\r\n    this.mData = null;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsLoaded = false;\r\n\r\n    /** @type {string|undefined} */\r\n    this.mMimeType = undefined;\r\n\r\n    /** @type {string} */\r\n    this.mResponseType = '';\r\n\r\n    /** @type {string} */\r\n    this.mExtension = this.getExtension(url);\r\n\r\n    /** @type {XMLHttpRequest|null} */\r\n    this.mRequest = null;\r\n  }\r\n\r\n  /**\r\n   * load\r\n   *\r\n   * @return {void}\r\n   */\r\n  load() {\r\n    //console.log('Asset: loading asset \\'%s\\' from \\'%s\\'', this.mName, this.mUrl);\r\n\r\n    this.mRequest = new XMLHttpRequest();\r\n    //this.mRequest.onprogress = (pe) => this.onProgressChanged(pe);\r\n\r\n    if (this.mRequest.overrideMimeType && this.mMimeType)\r\n      this.mRequest.overrideMimeType(this.mMimeType);\r\n\r\n    this.mRequest.responseType = this.mResponseType;\r\n    this.mRequest.open(\"GET\", this.mUrl, true);\r\n    this.mRequest.onreadystatechange = () => {\r\n      if (this.mRequest.readyState === 4) {\r\n        if ((this.mRequest.status === 200) || ((this.mRequest.status === 0) && this.mRequest.responseText))\r\n          this.onLoaded();\r\n        else\r\n          throw new Error('Error loading ' + this.mUrl + \" (\" + this.mRequest.status + \":\"+ this.mRequest.responseText + \")\"); //TODO handle errors\r\n      }\r\n    };\r\n\r\n    this.mRequest.send(null);\r\n  }\r\n\r\n\r\n  /**\r\n   * onLoaded\r\n   *\r\n   * @return {void}\r\n   */\r\n  onLoaded() {\r\n    this.mIsLoaded = true;\r\n    this.post('complete');\r\n  }\r\n\r\n  /**\r\n   * name\r\n   *\r\n   * @return {string}\r\n   */\r\n  get name() {\r\n    return this.mName;\r\n  }\r\n\r\n  /**\r\n   * data\r\n   *\r\n   * @return {*}\r\n   */\r\n  get data() {\r\n    return this.mData;\r\n  }\r\n\r\n  /**\r\n   * isLoaded\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  get isLoaded() {\r\n    return this.mIsLoaded;\r\n  }\r\n\r\n  // TODO: finish\r\n  dispose() {}\r\n\r\n  /**\r\n   * getExtension\r\n   *\r\n   * @param {string} url\r\n   *\r\n   * @return {string}\r\n   */\r\n  getExtension(url) {\r\n    if (url.indexOf(\".\") === -1)\r\n      return '';\r\n\r\n    return url.substring(url.indexOf(\".\")).toLowerCase();\r\n  }\r\n}\r\n","\r\nclass TextureAsset extends Asset {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {string} name Description\r\n   * @param {string} url  Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(name, url) {\r\n    super(name, url);\r\n\r\n    /** @type {Image} */\r\n    this.mImageElement = new Image();\r\n  }\r\n\r\n  /**\r\n   * onLoaded - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onLoaded() {\r\n    //console.log('TextureAsset: \\'%s\\' loaded', this.mName);\r\n\r\n    this.mData = new Texture(this.mImageElement);\r\n\r\n    super.onLoaded();\r\n  }\r\n\r\n  /**\r\n   * load - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  load() {\r\n    this.mImageElement.src = this.mUrl;\r\n    this.mImageElement.onload = () => {\r\n      this.onLoaded();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * type - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get type() {\r\n    return \"TextureAsset\";\r\n  }\r\n}\r\n","\r\nclass JSONAsset extends Asset {\r\n  /**\r\n   * constructor\r\n   *\r\n   * @param {string} name\r\n   * @param {string} url\r\n   *\r\n   * @return {void}\r\n   */\r\n  constructor(name, url) {\r\n    super(name, url);\r\n    this.mimeType = \"application/json\";\r\n  }\r\n\r\n  /**\r\n   * onLoaded\r\n   *\r\n   * @return {void}\r\n   */\r\n  onLoaded(){\r\n    this.mData = JSON.parse(/** @type {string} */ (this.mRequest.responseText) );\r\n    super.onLoaded();\r\n  }\r\n}\r\n","\r\nclass AtlasTextureAsset extends Asset {\r\n  /**\r\n   * constructor\r\n   *\r\n   * @param {string} name\r\n   * @param {string} imageUrl\r\n   * @param {string} dataUrl\r\n   *\r\n   * @return {void}\r\n   */\r\n  constructor(name, imageUrl, dataUrl) {\r\n    super(name, imageUrl);\r\n\r\n    /** @type {Image} */\r\n    this.mImageElement = new Image();\r\n\r\n    /** @type {JSONAsset} */\r\n    this.dataAsset = new JSONAsset(name, dataUrl);\r\n    this.dataAsset.on('complete', this.onJsonLoaded, this);\r\n  }\r\n\r\n  onJsonLoaded() {\r\n    this.mImageElement.src = this.mUrl;\r\n    this.mImageElement.onload = () => {\r\n      this.onLoaded();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onLoaded\r\n   *\r\n   * @return {void}\r\n   */\r\n  onLoaded() {\r\n    this.mData = new AtlasTexture(new Texture(this.mImageElement), /** @type {{meta: *, frames: *}} */ (this.dataAsset.data));\r\n\r\n    super.onLoaded();\r\n  }\r\n\r\n  /**\r\n   * load\r\n   * @override\r\n   *\r\n   * @return {void}\r\n   */\r\n  load() {\r\n    this.dataAsset.load();\r\n  }\r\n}\r\n","/*\r\nTODO:\r\n  1. propper error handling\r\n  2. max parallel downloads\r\n  3. check for name dublicates\r\n  4. load progress\r\n*/\r\n\r\n\r\nclass AssetManager extends MessageDispatcher {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {string} */\r\n    this.mDefaultPath = '';\r\n\r\n    /** @type {number} */\r\n    this.mTotalLoaded = 0;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsAllLoaded = false;\r\n\r\n    /** @type {number} */\r\n    this.mLoadingProgress = 0;\r\n\r\n    /** @type {Array<Asset>} */\r\n    this.mQueue = [];\r\n\r\n    /** @dict */\r\n    this.mTextures = {};\r\n\r\n    /** @dict */\r\n    this.mAtlases = {};\r\n\r\n    /** @dict */\r\n    this.mJsons = {};\r\n  }\r\n\r\n  enqueueImage(name, url) {\r\n    this.mQueue.push(new TextureAsset(name, this.mDefaultPath + url));\r\n  }\r\n\r\n  enqueueAtlas(name, imageUrl, dataUrl) {\r\n    this.mQueue.push(new AtlasTextureAsset(name, this.mDefaultPath + imageUrl, this.mDefaultPath + dataUrl));\r\n  }\r\n\r\n  enqueueJson(name, url) {\r\n    this.mQueue.push(new JSONAsset(name, this.mDefaultPath + url));\r\n  }\r\n\r\n  /**\r\n   * loadQueue\r\n   *\r\n   * @return {void}\r\n   */\r\n  loadQueue() {\r\n    for (let i = 0; i < this.mQueue.length; i++) {\r\n      let item = this.mQueue[i];\r\n\r\n      item.on(Message.COMPLETE, this.onAssetLoaded, this);\r\n      item.load();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * onAssetLoaded\r\n   *\r\n   * @param {Message} msg\r\n   *\r\n   * @return {void}\r\n   */\r\n  onAssetLoaded(msg) {\r\n    this.mTotalLoaded++;\r\n    this.mLoadingProgress = this.mTotalLoaded / this.mQueue.length;\r\n\r\n    let item = msg.sender;\r\n\r\n    // TODO: rework this\r\n    // TODO: check for dups\r\n    if (item.constructor === TextureAsset)\r\n      this.mTextures[item.name] = item.data;\r\n    else if (item.constructor === AtlasTextureAsset)\r\n      this.mAtlases[item.name] = item.data;\r\n    else if (item.constructor === JSONAsset)\r\n      this.mJsons[item.name] = item.data;\r\n    else\r\n      console.error('Unable to handle asset type.', item);\r\n\r\n    this.post(Message.PROGRESS, this.mLoadingProgress);\r\n\r\n    if (this.mTotalLoaded === this.mQueue.length) {\r\n      this.mQueue.splice(0, this.mQueue.length);\r\n\r\n      this.mIsAllLoaded = true;\r\n      this.post(Message.COMPLETE);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * getTexture\r\n   *\r\n   * @param {string} name\r\n   *\r\n   * @return {Texture|null}\r\n   */\r\n  getTexture(name) {\r\n    /** @type {Texture} */\r\n    let t = this.mTextures[name];\r\n\r\n    if (t != null)\r\n      return t;\r\n\r\n    for (let key in this.mAtlases) {\r\n      t = this.mAtlases[key].getTexture(name);\r\n      if (t != null)\r\n        return t;\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n\r\n  /**\r\n   * @param {string} name\r\n   *\r\n   * @return {AtlasTexture}\r\n   */\r\n  getAtlas(name) {\r\n    return this.mAtlases[name];\r\n  }\r\n\r\n  /**\r\n   * defaultPath\r\n   *\r\n   * @return {string}\r\n   */\r\n  get defaultPath() {\r\n    return this.mDefaultPath;\r\n  }\r\n\r\n  /**\r\n   * defaultPath\r\n   *\r\n   * @param {string} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set defaultPath(value) {\r\n    this.mDefaultPath = value;\r\n  }\r\n\r\n  /**\r\n   * isAllLoaded\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  get isAllLoaded() {\r\n    return this.mIsAllLoaded;\r\n  }\r\n}\r\n\r\n/** @type {AssetManager} */\r\nAssetManager.default = new AssetManager();\r\n","/**\r\n * A blend mode enum.\r\n * @enum {string}\r\n */\r\n\r\nvar BlendMode = {\r\n  AUTO: 'auto',\r\n  NORMAL: 'source-over',\r\n  ADD: 'lighter',\r\n  MULTIPLY: 'multiply',\r\n  SCREEN: 'screen',\r\n  OVERLAY: 'overlay',\r\n  DARKEN: 'darken',\r\n  LIGHTEN: 'lighten',\r\n  COLOR_DODGE: 'color-dodge',\r\n  COLOR_BURN: 'color-burn',\r\n  HARD_LIGHT: 'hard-light',\r\n  SOFT_LIGHT: 'soft-light',\r\n  DIFFERENCE: 'difference',\r\n  EXCLUSION: 'exclusion',\r\n  HUE: 'hue',\r\n  SATURATE: 'saturate',\r\n  COLOR: 'color',\r\n  LUMINOSITY: 'luminosity'\r\n};\r\n","\r\nclass VideoNullDriver {\r\n  /**\r\n   * @param  {HTMLElement} containerElement description\r\n   * @param  {number} width            description\r\n   * @param  {number} height           description\r\n   */\r\n  constructor(containerElement, width, height) {\r\n    /** @type {string} */\r\n    this.mGlobalBlendMode = 'auto';\r\n\r\n    /** @type {HTMLElement} */\r\n    this.mContainerElement = /** @type {HTMLElement} */ (containerElement);\r\n\r\n    /** @type {number} */\r\n    this.mClientWidth = width;\r\n\r\n    /** @type {number} */\r\n    this.mClientHeight = height;\r\n\r\n    /** @type {Matrix} */\r\n    this.mTransform = new Matrix();\r\n\r\n    /** @type {number} */\r\n    this.mGlobalAlpha = 1;\r\n\r\n    /** @type {HTMLElement} */\r\n    this.mMeasureElement = /** @type {HTMLElement} */ (document.createElement('span'));\r\n    this.mMeasureElement.style.position = 'absolute';\r\n    this.mContainerElement.appendChild(this.mMeasureElement);\r\n\r\n    Black.instance.viewport.on('resize', this.__onResize, this);\r\n  }\r\n\r\n  __onResize(msg, rect) {\r\n    let w = this.mContainerElement.clientWidth;\r\n    let h = this.mContainerElement.clientHeight;\r\n\r\n    this.mClientWidth = w;\r\n    this.mClientHeight = h;\r\n  }\r\n\r\n  /**\r\n   * start - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  start() {}\r\n\r\n  beginFrame() {}\r\n\r\n  endFrame() {}\r\n\r\n\r\n  /**\r\n   * getTextureFromCanvas - Description\r\n   *\r\n   * @param {HTMLElement} canvas Description\r\n   *\r\n   * @return {Texture|null} Description\r\n   */\r\n  getTextureFromCanvas(canvas){\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * setTransform - Description\r\n   *\r\n   * @param {Matrix} m Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  setTransform(m) {\r\n    this.mTransform = m;\r\n  }\r\n\r\n  /**\r\n   * globalAlpha - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get globalAlpha() {\r\n    return this.mGlobalAlpha;\r\n  }\r\n\r\n  /**\r\n   * globalAlpha - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set globalAlpha(value) {\r\n    this.mGlobalAlpha = value;\r\n  }\r\n\r\n  /**\r\n   * mGlobalBlendMode - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get globalBlendMode() {\r\n    return this.mGlobalBlendMode;\r\n  }\r\n\r\n  /**\r\n   * globalBlendMode - Description\r\n   *\r\n   * @param {string} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set globalBlendMode(value) {\r\n    this.mGlobalBlendMode = value;\r\n  }\r\n\r\n  /**\r\n   * drawImage - description\r\n   *\r\n   * @param  {Texture} texture description\r\n   */\r\n  drawImage(texture) {}\r\n\r\n  /**\r\n   * drawText\r\n   *\r\n   * @param {string} text\r\n   * @param {TextInfo} style\r\n   * @param {Rectangle} bounds\r\n   * @param {number} textWidth\r\n   * @param {number} textHeight\r\n   *\r\n   * @return {void}\r\n   */\r\n  drawText(text, style, bounds, textWidth, textHeight) {}\r\n\r\n  clear() {}\r\n\r\n  /**\r\n   * save - Description\r\n   *\r\n   * @param {GameObject|null} gameObject Used for internal binding.\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  save(gameObject) {}\r\n\r\n  restore() {}\r\n\r\n  hexColorToString(color) {\r\n    let parsedColor = color.toString(16);\r\n    return '#000000'.substring(0, 7 - parsedColor.length) + parsedColor;\r\n  }\r\n\r\n  /**\r\n   * measureText - Description\r\n   *\r\n   * @param {string} text  Description\r\n   * @param {TextInfo} style Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  measureText(text, style) {\r\n    let el = this.mMeasureElement;\r\n    el.innerHTML = text;\r\n    el.style.whiteSpace = 'pre';\r\n    el.style.fontSize = style.size + 'px';\r\n    el.style.fontFamily = style.name;\r\n    el.style.fontStyle = style.style;\r\n    el.style.fontWeight = style.weight;\r\n\r\n    let v = new Vector(el.offsetWidth + style.strokeThickness, el.offsetHeight + style.strokeThickness);\r\n    el.innerHTML = '';\r\n\r\n    return v;\r\n  }\r\n}\r\n","\r\nclass CanvasDriver extends VideoNullDriver {\r\n  /**\r\n   * @param  {HTMLElement} containerElement description\r\n   * @param  {number} width            description\r\n   * @param  {number} height           description\r\n   */\r\n  constructor(containerElement, width, height) {\r\n    super(containerElement, width, height);\r\n\r\n    /** @type {CanvasRenderingContext2D|null} */\r\n    this.mCtx = null;\r\n\r\n    this.mGlobalAlpha = 1;\r\n    this.mGlobalBlendMode = BlendMode.NORMAL;\r\n\r\n    this.__createCanvas();\r\n  }\r\n\r\n  /**\r\n   * __createCanvas\r\n   *\r\n   * @return {void}\r\n   */\r\n  __createCanvas() {\r\n    let cvs = /** @type {HTMLCanvasElement} */ (document.createElement('canvas'));\r\n    cvs.id = 'canvas';\r\n    this.mContainerElement.appendChild(cvs);\r\n\r\n    this.mCtx = /** @type {CanvasRenderingContext2D} */ (cvs.getContext('2d'));\r\n    this.mCtx.canvas.width = this.mClientWidth;\r\n    this.mCtx.canvas.height = this.mClientHeight;\r\n  }\r\n\r\n  __onResize(msg, rect) {\r\n    super.__onResize(msg, rect);\r\n\r\n    this.mCtx.canvas.width = this.mClientWidth;\r\n    this.mCtx.canvas.height = this.mClientHeight;\r\n  }\r\n\r\n  /**\r\n   * setTransform\r\n   *\r\n   * @param {Matrix} m\r\n   *\r\n   * @return {void}\r\n   */\r\n  setTransform(m) {\r\n    super.setTransform(m);\r\n\r\n    let v = m.value;\r\n    this.mCtx.setTransform(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n  }\r\n\r\n\r\n  /**\r\n   * globalAlpha\r\n   *\r\n   * @param {number} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set globalAlpha(value) {\r\n    this.mGlobalAlpha = value;\r\n    this.mCtx.globalAlpha = value;\r\n  }\r\n\r\n\r\n  /**\r\n   * globalBlendMode\r\n   *\r\n   * @param {string} blendMode\r\n   *\r\n   * @return {void}\r\n   */\r\n  set globalBlendMode(blendMode) {\r\n    if (blendMode === BlendMode.AUTO)\r\n      return;\r\n\r\n    this.mGlobalBlendMode = blendMode;\r\n    this.mCtx.globalCompositeOperation = blendMode;\r\n  }\r\n\r\n  /**\r\n   * drawImage\r\n   *\r\n   * @param {Texture} texture\r\n   *\r\n   * @return {void}\r\n   */\r\n  drawImage(texture) {\r\n    let w = texture.width;\r\n    let h = texture.height;\r\n    let ox = texture.untrimmedRect.x;\r\n    let oy = texture.untrimmedRect.y;\r\n\r\n    this.mCtx.drawImage(texture.native, texture.region.x, texture.region.y, w, h, ox, oy, w, h);\r\n  }\r\n\r\n  /**\r\n   * drawText\r\n   *\r\n   * @override\r\n   * @param {string} text\r\n   * @param {TextInfo} style\r\n   * @param {Rectangle} bounds\r\n   * @param {number} textWidth\r\n   * @param {number} textHeight\r\n   *\r\n   * @return {void}\r\n   */\r\n  drawText(text, style, bounds, textWidth, textHeight) {\r\n    this.mCtx.beginPath();\r\n    this.mCtx.rect(bounds.x, bounds.y, bounds.width, bounds.height);\r\n    this.mCtx.clip();\r\n\r\n    this.mCtx.font = `${style.style} ${style.weight} ${style.size}px \"${style.name}\"`;\r\n    this.mCtx.fillStyle = this.hexColorToString(style.color);\r\n\r\n    let x = 0;\r\n    if (style.align === 'center')\r\n      x = (bounds.width * 0.5) - textWidth * 0.5;\r\n\r\n    else if (style.align === 'right')\r\n      x = bounds.width - textWidth;\r\n\r\n    this.mCtx.textBaseline = 'top';\r\n    this.mCtx.fillText(text, x, 0);\r\n\r\n    if (style.strokeThickness > 0) {\r\n      this.mCtx.lineWidth = style.strokeThickness;\r\n      this.mCtx.strokeStyle = this.hexColorToString(style.strokeColor);\r\n      this.mCtx.strokeText(text, x, 0);\r\n    }\r\n    this.mCtx.closePath();\r\n  }\r\n\r\n  /**\r\n   * clear\r\n   *\r\n   * @return {void}\r\n   */\r\n  clear() {\r\n    this.mCtx.clearRect(0, 0, this.mCtx.canvas.width, this.mCtx.canvas.height);\r\n  }\r\n\r\n  /**\r\n   * beginFrame\r\n   *\r\n   * @return {void}\r\n   */\r\n  beginFrame() {\r\n    super.beginFrame();\r\n\r\n    this.clear();\r\n    this.mCtx.save();\r\n  }\r\n\r\n  /**\r\n   * endFrame\r\n   *\r\n   * @return {void}\r\n   */\r\n  endFrame() {\r\n    super.endFrame();\r\n\r\n    this.mCtx.restore();\r\n  }\r\n\r\n  /**\r\n   * getTextureFromCanvas - Description\r\n   *\r\n   * @param {HTMLElement} canvas Description\r\n   *\r\n   * @return {Texture|null} Description\r\n   */\r\n  getTextureFromCanvas(canvas) {\r\n    return new Texture(canvas, new Rectangle(0, 0, canvas.width, canvas.height));\r\n  }\r\n\r\n  /**\r\n   * save\r\n   *\r\n   * @override\r\n   * @param {GameObject|null} gameObject Used for internal binding.\r\n   *\r\n   * @return {void}\r\n   */\r\n  save(gameObject) {\r\n    this.mCtx.save();\r\n  }\r\n\r\n  /**\r\n   * restore\r\n   *\r\n   * @return {void}\r\n   */\r\n  restore() {\r\n    this.mCtx.restore();\r\n  }\r\n}\r\n","\r\nclass DOMDriver extends VideoNullDriver {\r\n  /**\r\n   * @param  {HTMLElement} containerElement description\r\n   * @param  {number} width            description\r\n   * @param  {number} height           description\r\n   */\r\n  constructor(containerElement, width, height) {\r\n    super(containerElement, width, height);\r\n\r\n    /** @type {number} */\r\n    this.mGlobalAlpha = 1;\r\n\r\n    /** @type {Array<Element>} */\r\n    this.mCache = [];\r\n\r\n    /** @type {number} */\r\n    this.mCounter = 0;\r\n\r\n    /** @type {boolean} */\r\n    this.mPixelated = true;\r\n\r\n    /** @type {GameObject|null} */\r\n    this.mCurrentObject = null;\r\n    this.__initCSS();\r\n  }\r\n\r\n  /**\r\n   * save - Description\r\n   *\r\n   * @override\r\n   * @param {GameObject|null} gameObject Used for internal binding.\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  save(gameObject) {\r\n    this.mCurrentObject = gameObject;\r\n  }\r\n\r\n  /**\r\n   * __initCSS - description\r\n   *\r\n   * @return {void}  description\r\n   */\r\n  __initCSS() {\r\n    let imgRendering = 'image-rendering:optimizeSpeed; image-rendering:optimize-contrast; image-rendering:crisp-edges; image-rendering:pixelated';\r\n\r\n    let sSprite = document.createElement('style');\r\n    sSprite.type = 'text/css';\r\n    sSprite.innerHTML = '.sprite { position: absolute; background-repeat: no-repeat; cursor: default !important; -webkit-transform-origin: 0px 0px;}';\r\n    document.getElementsByTagName('head')[0].appendChild(sSprite);\r\n\r\n    let sSpritePixelated = document.createElement('style');\r\n    sSpritePixelated.type = 'text/css';\r\n    sSpritePixelated.innerHTML = '.sprite-p { position: absolute; background-repeat: no-repeat; cursor: default !important; -webkit-transform-origin: 0px 0px; ' + imgRendering + '}';\r\n    document.getElementsByTagName('head')[0].appendChild(sSpritePixelated);\r\n\r\n    let sText = document.createElement('style');\r\n    sText.type = 'text/css';\r\n    sText.innerHTML = '.text { position: absolute; white-space: pre; overflow: hidden; cursor: default !important; -webkit-transform-origin: 0px 0px;}';\r\n    document.getElementsByTagName('head')[0].appendChild(sText);\r\n\r\n    let sViewport = document.createElement('style');\r\n    sViewport.type = 'text/css';\r\n    sViewport.innerHTML = '.viewport { width: 100%; height: 100%; position: relative; overflow: hidden; cursor: default; }';\r\n    document.getElementsByTagName('head')[0].appendChild(sViewport);\r\n\r\n    this.mContainerElement.className = 'viewport';\r\n  }\r\n\r\n  /**\r\n   * beginFrame - description\r\n   *\r\n   * @return {void}  description\r\n   */\r\n  beginFrame() {\r\n    this.mCounter = 0;\r\n  }\r\n\r\n  /**\r\n   * endFrame - description\r\n   *\r\n   * @return {void}  description\r\n   */\r\n  endFrame() {\r\n    if (this.mCounter === this.mCache.length)\r\n      return;\r\n\r\n    //TODO: cleanup unused divs\r\n    //TODO: remove them instead of hiding\r\n    for (let i = this.mCounter; i < this.mCache.length; i++) {\r\n      let el = this.mCache[i];\r\n\r\n      el.parentNode.removeChild(el);\r\n    }\r\n\r\n    this.mCache.splice(this.mCounter);\r\n  }\r\n\r\n  /**\r\n   * getTextureFromCanvas - Description\r\n   *\r\n   * @param {HTMLElement} canvas Description\r\n   *\r\n   * @return {Texture|null} Description\r\n   */\r\n  getTextureFromCanvas(canvas) {\r\n    return Texture.fromCanvasAsImage(canvas);\r\n  }\r\n\r\n  /**\r\n   * drawImage - description\r\n   *\r\n   * @param  {Texture} texture description\r\n   * @return {void}         description\r\n   */\r\n  drawImage(texture) {\r\n    /** @type {Matrix|null} */\r\n    let oldTransform = this.mTransform;\r\n\r\n    if (texture.untrimmedRect.x !== 0 || texture.untrimmedRect.y !== 0) {\r\n      Matrix.__cache.set(1, 0, 0, 1, texture.untrimmedRect.x, texture.untrimmedRect.y);\r\n      this.mTransform.append(Matrix.__cache);\r\n    }\r\n\r\n    let el = this.__popElement(this.mPixelated ? 'sprite-p' : 'sprite');\r\n    this.__updateElementCommon(el);\r\n    this.__updateImageElement(el, texture);\r\n\r\n    this.mTransform = oldTransform;\r\n  }\r\n\r\n  /**\r\n   * drawText - description\r\n   *\r\n   * @override\r\n   * @param {string} text\r\n   * @param {TextInfo} style\r\n   * @param {Rectangle} bounds\r\n   * @param {number} textWidth\r\n   * @param {number} textHeight\r\n   *\r\n   * @return {void}                      description\r\n   */\r\n  drawText(text, style, bounds, textWidth, textHeight) {\r\n    let el = this.__popElement('text');\r\n    this.__updateElementCommon(el);\r\n\r\n    // TODO: check this type. review the code.\r\n    this.__updateTextElement( /** @type {HTMLElement} */ (el), text, style, bounds);\r\n  }\r\n\r\n  /**\r\n   * __popElement - Description\r\n   *\r\n   * @param {string} className Description\r\n   *\r\n   * @return {Element} Description\r\n   */\r\n  __popElement(className) {\r\n    this.mCounter++;\r\n\r\n    if (this.mCounter <= this.mCache.length)\r\n      return this.mCache[this.mCounter - 1];\r\n\r\n    let el = document.createElement('div');\r\n    el.className = className;\r\n    this.mContainerElement.appendChild(el);\r\n\r\n    this.mCache.push(el);\r\n    return (el);\r\n  }\r\n\r\n  /**\r\n   * __updateElementCommon - Description\r\n   *\r\n   * @param {Element} el Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __updateElementCommon(el) {\r\n    let v = this.mTransform.value;\r\n\r\n    // TODO: slow, rework\r\n    // NOTE: toFixed(0) is faster then toFixed(6)\r\n    let transform = `matrix(${v[0].toFixed(6)}, ${v[1].toFixed(6)}, ${v[2].toFixed(6)}, ${v[3].toFixed(6)}, ${v[4].toFixed(6)}, ${v[5].toFixed(6)})`;\r\n    //let transform = `matrix(${v[0]}, ${v[1]}, ${v[2]}, ${v[3]}, ${v[4]}, ${v[5]})`;\r\n\r\n    //console.log(el.style.transform, transform);\r\n    if (el.style.webkitTransform !== transform)\r\n      el.style.webkitTransform = transform;\r\n\r\n    //el.style.transform = transform;\r\n\r\n    //if (el.style.opacity != this.mGlobalAlpha)\r\n    el.style.opacity = this.mGlobalAlpha; // would be faster to not compare string and int\r\n\r\n    //if (el.style.backgroundImage !== '') {\r\n    //el.style.backgroundImage = '';\r\n    //console.log('reset img');\r\n    //}\r\n\r\n    // if (el.style.width !== null)\r\n    //   el.style.width = null;\r\n    //\r\n    // if (el.style.height !== null)\r\n    //   el.style.height = null;\r\n\r\n    // if (el.style.display === 'none')\r\n    //   el.style.display = 'block';\r\n  }\r\n\r\n  /**\r\n   * __updateImageElement - description\r\n   *\r\n   * @param  {Element} el      description\r\n   * @param  {Texture} texture description\r\n   * @return {void}         description\r\n   */\r\n  __updateImageElement(el, texture) {\r\n    if (texture) {\r\n      let url = 'url(' + texture.native.src + ')';\r\n\r\n      if (el.style.backgroundImage !== url)\r\n        el.style.backgroundImage = url;\r\n\r\n      if (texture.isSubTexture) {\r\n        let vBackgroundPosition = `${-texture.region.x}px ${-texture.region.y}px`;\r\n\r\n        if (el.style.backgroundPosition !== vBackgroundPosition)\r\n          el.style.backgroundPosition = vBackgroundPosition;\r\n      }\r\n    } else {\r\n      el.style.backgroundImage = 'none';\r\n    }\r\n\r\n    if (el.style.width != texture.width + 'px')\r\n      el.style.width = texture.width + 'px';\r\n\r\n    if (el.style.height != texture.height + 'px')\r\n      el.style.height = texture.height + 'px';\r\n\r\n    if (el.innerHTML !== '')\r\n      el.innerHTML = '';\r\n  }\r\n\r\n  /**\r\n   * __updateTextElement - Description\r\n   *\r\n   * @param {HTMLElement} el     Description\r\n   * @param {string} text   Description\r\n   * @param {TextInfo} style  Description\r\n   * @param {Rectangle} bounds Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __updateTextElement(el, text, style, bounds) {\r\n    el.innerHTML = text;\r\n    el.style.fontSize = style.size + 'px';\r\n\r\n    if (el.style.width !== bounds.width + 'px')\r\n      el.style.width = bounds.width + 'px';\r\n\r\n    if (el.style.height !== bounds.height + 'px')\r\n      el.style.height = bounds.height + 'px';\r\n\r\n    if (el.style.fontFamily !== style.name)\r\n      el.style.fontFamily = style.name;\r\n\r\n    let color = this.hexColorToString(style.color);\r\n\r\n    if (el.style.color != color)\r\n      el.style.color = color;\r\n\r\n    if (el.style.fontStyle !== style.style)\r\n      el.style.fontStyle = style.style;\r\n\r\n    if (el.style.fontWeight != style.weight)\r\n      el.style.fontWeight = style.weight;\r\n\r\n    if (el.style.textAlign !== style.align)\r\n      el.style.textAlign = style.align;\r\n\r\n    if (style.strokeThickness > 0) {\r\n      let strokeColor = this.hexColorToString(style.strokeColor);\r\n\r\n      if (el.style.webkitTextStrokeColor != strokeColor)\r\n        el.style.webkitTextStrokeColor = strokeColor;\r\n\r\n      if (el.style.webkitTextStrokeWidth != style.strokeThickness + 'px') {\r\n        el.style.webkitTextStrokeWidth = style.strokeThickness + 'px';\r\n      }\r\n    }\r\n\r\n    if (el.style.backgroundImage !== 'none')\r\n      el.style.backgroundImage = 'none';\r\n  }\r\n}\r\n","\r\nclass DisplayObject extends GameObject {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {number} */\r\n    this.mAlpha = 1;\r\n\r\n    /** @type {string} */\r\n    this.blendMode = BlendMode.AUTO;\r\n\r\n    /** @type {boolean} */\r\n    this.mVisible = true;\r\n  }\r\n\r\n  /**\r\n   * __render - Description\r\n   *\r\n   * @param {VideoNullDriver} video           Description\r\n   * @param {number} time            Description\r\n   * @param {number} parentAlpha     Description\r\n   * @param {string} parentBlendMode Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __render(video, time, parentAlpha, parentBlendMode) {\r\n    if (this.mVisible === false)\r\n      return;\r\n\r\n    this.onRender(video, time);\r\n\r\n    let child = null;\r\n    for (var i = 0; i < this.mChildren.length; i++) {\r\n      child = this.mChildren[i];\r\n      child.__render(video, time, parentAlpha, parentBlendMode);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * alpha - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get alpha() {\r\n    return this.mAlpha;\r\n  }\r\n\r\n  /**\r\n   * alpha - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set alpha(value) {\r\n    this.mAlpha = Math.clamp(value, 0, 1);\r\n  }\r\n\r\n\r\n  /**\r\n   * visible - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get visible() {\r\n    return this.mVisible;\r\n  }\r\n\r\n\r\n  /**\r\n   * visible - Description\r\n   *\r\n   * @param {boolean} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set visible(value) {\r\n    this.mVisible = value;\r\n  }\r\n}\r\n","\r\nclass TextInfo {\r\n  /**\r\n   * @param  {string=} name = 'sans-serif' description\r\n   * @param  {number=} color = '0x000000' description\r\n   * @param  {number=} size = '14' description\r\n   * @param  {TextInfo.FontStyle=} style = 'normal' description\r\n   * @param  {TextInfo.FontWeight=} weight = '400' description\r\n   * @param  {TextInfo.FontAlign=} align = 'left' description\r\n   * @param  {number=} strokeThickness = '0' description\r\n   * @param  {number=} strokeColor = '0xffffff' description\r\n   */\r\n  constructor(name = 'sans-serif', color = 0x000000, size = 14, style = TextInfo.FontStyle.NORMAL, weight = TextInfo.FontWeight.NORMAL, align = TextInfo.FontAlign.LEFT, strokeThickness = 0, strokeColor = 0xffffff) {\r\n\r\n    /** @type {string} */\r\n    this.name = name;\r\n\r\n    /** @type {number} */\r\n    this.size = size;\r\n\r\n    /** @type {number} */\r\n    this.color = color;\r\n\r\n    /** @type {TextInfo.FontStyle} */\r\n    this.style = style;\r\n\r\n    /** @type {TextInfo.FontWeight} */\r\n    this.weight = weight;\r\n\r\n    /** @type {TextInfo.FontAlign} */\r\n    this.align = align;\r\n\r\n    /** @type {number} */\r\n    this.strokeThickness = strokeThickness;\r\n\r\n    /** @type {number} */\r\n    this.strokeColor = strokeColor;\r\n  }\r\n}\r\n\r\n/**\r\n * @enum {string}\r\n */\r\nTextInfo.FontStyle = {\r\n  NORMAL: 'normal',\r\n  ITALIC: 'italic'\r\n};\r\n\r\n/**\r\n * @enum {string}\r\n */\r\nTextInfo.FontWeight = {\r\n  NORMAL: '400',\r\n  BOLD: '700',\r\n  SUPERBOLD: '800'\r\n};\r\n\r\n/**\r\n * @enum {string}\r\n */\r\nTextInfo.FontAlign = {\r\n  LEFT: 'left',\r\n  RIGHT: 'right',\r\n  CENTER: 'center'\r\n};\r\n","\r\nclass Sprite extends DisplayObject {\r\n\r\n  /**\r\n   * constructor - Creates a new Sprite object instance.\r\n   *\r\n   * @param {Texture|string|null} texture The Texture instance or null.\r\n   */\r\n  constructor(texture = null) {\r\n    super();\r\n\r\n    /**\r\n     * @private\r\n     * @type {Texture|null} */\r\n    this.mTexture = null;\r\n\r\n    if (texture !== null && texture.constructor === String)\r\n      this.mTexture = AssetManager.default.getTexture(/** @type {string} */ (texture));\r\n    else\r\n      this.mTexture = /** @type {Texture} */ (texture);\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @private\r\n   * @param {VideoNullDriver} video\r\n   * @param {number} time\r\n   * @param {number} parentAlpha\r\n   * @param {string} parentBlendMode\r\n   *\r\n   * @return {void}\r\n   */\r\n  __render(video, time, parentAlpha, parentBlendMode) {\r\n    if (this.mAlpha <= 0 || this.mVisible === false)\r\n      return;\r\n\r\n    let tmpBlendMode = BlendMode.AUTO;\r\n\r\n    if (this.mTexture !== null) {\r\n      video.save(this);\r\n      video.setTransform(this.worldTransformation);\r\n      video.globalAlpha = parentAlpha * this.mAlpha;\r\n      video.globalBlendMode = tmpBlendMode = this.blendMode === BlendMode.AUTO ? parentBlendMode : this.blendMode;\r\n      video.drawImage(this.mTexture);\r\n      video.restore();\r\n    }\r\n\r\n    super.__render(video, time, parentAlpha * this.mAlpha, tmpBlendMode);\r\n  }\r\n\r\n  /**\r\n   * onGetLocalBounds - Returns a rectangle that completely encloses the object in local coordinate system.\r\n   *\r\n   * @override\r\n   * @protected\r\n   * @param {Rectangle=} outRect Description\r\n   *\r\n   * @return {Rectangle} The new Rectangle or outRect with .\r\n   */\r\n  onGetLocalBounds(outRect = undefined) {\r\n    outRect = outRect || new Rectangle();\r\n\r\n    if (!this.mTexture)\r\n      return outRect;\r\n\r\n    return outRect.set(0, 0, this.mTexture.untrimmedRect.width, this.mTexture.untrimmedRect.height);\r\n  }\r\n\r\n  /**\r\n   * texture - Returns the current Texture on this sprite.\r\n   *\r\n   * @return {Texture|null} The current texture set on this Sprite or null.\r\n   */\r\n  get texture() {\r\n    return this.mTexture;\r\n  }\r\n\r\n  /**\r\n   * texture - Sets the Texture on this sprite.\r\n   *\r\n   * @param {Texture|null} texture Texture to apply on.\r\n   *\r\n   * @return {void}\r\n   */\r\n  set texture(texture) {\r\n    if (this.mTexture === texture)\r\n      return;\r\n\r\n    this.mTexture = texture;\r\n  }\r\n\r\n  set touchable(value) {\r\n    let c = this.getComponent(InputComponent);\r\n\r\n    if (value === true) {\r\n      if (c === null)\r\n        this.addComponent(new InputComponent());\r\n      else\r\n        c.touchable = true;\r\n    } else {\r\n      if (c !== null)\r\n        this.removeComponent(c);\r\n    }\r\n  }\r\n\r\n  get touchable() {\r\n    let c = this.getComponent(InputComponent);\r\n    return c !== null && c.touchable === true;\r\n  }\r\n}\r\n","\r\nclass TextField extends DisplayObject {\r\n  /**\r\n   * @param  {string=} text = ''            description\r\n   * @param  {number=} size = 14        description\r\n   * @param  {string=} name = \"sans-serif\" description\r\n   * @param {TextInfo=} style\r\n   */\r\n  constructor(text = '', size = 14, name = 'sans-serif', style = undefined) {\r\n    super();\r\n\r\n    /** @type {string} */\r\n    this.mText = text;\r\n\r\n    /** @type {boolean} */\r\n    this.mNeedInvalidate = true;\r\n\r\n    /** @type {Rectangle} */\r\n    this.mCacheBounds = new Rectangle();\r\n\r\n    /** @type {number} */\r\n    this.mFieldWidth = 0;\r\n\r\n    /** @type {number} */\r\n    this.mFieldHeight = 0;\r\n\r\n    /** @type {number} */\r\n    this.mTextWidth = 0;\r\n\r\n    /** @type {number} */\r\n    this.mTextHeight = 0;\r\n\r\n    /** @type {TextInfo} */\r\n    this.mStyle = style || new TextInfo();\r\n\r\n    /** @type {string} */\r\n    this.mStyle.name = name || style.name;\r\n\r\n    /** @type {number} */\r\n    this.mStyle.size = size || style.size;\r\n\r\n    /** @type {boolean} */\r\n    this.mAutoSize = true;\r\n\r\n    this.__validate(this.mCacheBounds);\r\n  }\r\n\r\n  /**\r\n   * __render - Description\r\n   * @override\r\n   * @param {VideoNullDriver} video           Description\r\n   * @param {number} time            Description\r\n   * @param {number} parentAlpha     Description\r\n   * @param {string} parentBlendMode Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __render(video, time, parentAlpha, parentBlendMode) {\r\n    if (this.mAlpha <= 0 || this.mVisible === false)\r\n      return;\r\n\r\n    this.__validate(this.mCacheBounds);\r\n\r\n    let tmpBlendMode = BlendMode.AUTO;\r\n\r\n    video.save(this);\r\n    video.setTransform(this.worldTransformation);\r\n    video.globalAlpha = parentAlpha * this.mAlpha;\r\n    video.globalBlendMode = tmpBlendMode = this.blendMode === BlendMode.AUTO ? parentBlendMode : this.blendMode;\r\n    video.drawText(this.mText, this.mStyle, this.mCacheBounds, this.mTextWidth, this.mTextHeight);\r\n    video.restore();\r\n\r\n    super.__render(video, time, parentAlpha * this.mAlpha, tmpBlendMode);\r\n  }\r\n\r\n  /**\r\n   * onGetLocalBounds - Description\r\n   *\r\n   * @protected @override\r\n   * @param {Rectangle=} outRect Description\r\n   *\r\n   * @return {Rectangle} bounds in local space withoout taking care about transformation matrix\r\n   */\r\n  onGetLocalBounds(outRect = undefined) {\r\n    outRect = outRect || new Rectangle();\r\n    return this.__validate(outRect);\r\n  }\r\n\r\n\r\n  /**\r\n   * __validate - Description\r\n   *\r\n   * @private\r\n   * @param {Rectangle} outRect Description\r\n   *\r\n   * @return {Rectangle} bounds in local space withoout taking care about transformation matrix\r\n   */\r\n  __validate(outRect) {\r\n    let strokeCorrection = 0 - this.mStyle.strokeThickness * 0.5;\r\n    if (this.mNeedInvalidate === false)\r\n      return outRect.set(strokeCorrection, strokeCorrection, this.mFieldWidth, this.mFieldHeight);\r\n\r\n    let driver = Black.instance.video;\r\n    let vSize = driver.measureText(this.mText, this.mStyle);\r\n    this.mTextWidth = vSize.x;\r\n    this.mTextHeight = vSize.y;\r\n\r\n    if (this.mAutoSize) {\r\n      this.mFieldWidth = this.mTextWidth;\r\n      this.mFieldHeight = this.mTextHeight;\r\n    }\r\n\r\n    this.mNeedInvalidate = false;\r\n    return outRect.set(strokeCorrection, strokeCorrection, this.mFieldWidth, this.mFieldHeight);\r\n  }\r\n\r\n\r\n  /**\r\n   * size - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get size() {\r\n    return this.mStyle.size;\r\n  }\r\n\r\n  /**\r\n   * size - Description\r\n   *\r\n   * @param {number} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set size(value) {\r\n    this.mStyle.size = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * font - Description\r\n   *\r\n   * @public\r\n   * @return {string} Description\r\n   */\r\n  get font() {\r\n      return this.mStyle.name;\r\n    }\r\n    /**\r\n     * font - Description\r\n     *\r\n     * @param {string} value Description\r\n     * @public\r\n     *\r\n     * @return {void} Description\r\n     */\r\n\r\n  set font(value) {\r\n    this.mStyle.name = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * color - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get color() {\r\n    return this.mStyle.color;\r\n  }\r\n\r\n  /**\r\n   * color - Description\r\n   *\r\n   * @param {number} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set color(value) {\r\n    this.mStyle.color = value;\r\n  }\r\n\r\n  /**\r\n   * style - Description\r\n   *\r\n   * @public\r\n   * @return {TextInfo.FontStyle} Description\r\n   */\r\n  get style() {\r\n    return this.mStyle.style;\r\n  }\r\n\r\n  /**\r\n   * style - Description\r\n   *\r\n   * @param {TextInfo.FontStyle} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set style(value) {\r\n    this.mStyle.style = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * weight - Description\r\n   *\r\n   * @public\r\n   * @return {TextInfo.FontWeight} Description\r\n   */\r\n  get weight() {\r\n    return this.mStyle.weight;\r\n  }\r\n\r\n  /**\r\n   * weight - Description\r\n   *\r\n   * @param {TextInfo.FontWeight} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set weight(value) {\r\n    this.mStyle.weight = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * align - Description\r\n   *\r\n   * @public\r\n   * @return {TextInfo.FontAlign} Description\r\n   */\r\n  get align() {\r\n    return this.mStyle.align;\r\n  }\r\n\r\n  /**\r\n   * align - Description\r\n   *\r\n   * @param {TextInfo.FontAlign} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set align(value) {\r\n    this.mStyle.align = value;\r\n  }\r\n\r\n  /**\r\n   * strokeColor - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get strokeColor() {\r\n    return this.mStyle.strokeColor;\r\n  }\r\n\r\n  /**\r\n   * strokeColor - Description\r\n   *\r\n   * @param {number} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set strokeColor(value) {\r\n    this.mStyle.strokeColor = value;\r\n  }\r\n\r\n  /**\r\n   * strokeThickness - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get strokeThickness() {\r\n    return this.mStyle.strokeThickness;\r\n  }\r\n\r\n  //noinspection JSAnnotator\r\n  /**\r\n   * strokeThickness - Description\r\n   * @public\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set strokeThickness(value) {\r\n    if (value === this.mStyle.strokeThickness)\r\n      return;\r\n\r\n    this.mStyle.strokeThickness = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * fieldWidth - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get fieldWidth() {\r\n    return this.mFieldWidth;\r\n  }\r\n\r\n  /**\r\n   * fieldWidth - Description\r\n   *\r\n   * @param {number} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set fieldWidth(value) {\r\n    if (this.mAutoSize || value === this.mFieldWidth)\r\n      return;\r\n\r\n    this.mFieldWidth = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * fieldHeight - Description\r\n   *\r\n   * @public\r\n   * @return {number} Description\r\n   */\r\n  get fieldHeight() {\r\n    return this.mFieldHeight;\r\n  }\r\n\r\n\r\n  /**\r\n   * fieldHeight - Description\r\n   *\r\n   * @param {number} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set fieldHeight(value) {\r\n    if (this.mAutoSize || value === this.mFieldHeight)\r\n      return;\r\n\r\n    this.mFieldHeight = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * @public text - Description\r\n   *\r\n   * @return {string} Description\r\n   */\r\n  get text() {\r\n    return this.mText;\r\n  }\r\n\r\n  /**\r\n   * text - Description\r\n   *\r\n   * @param {string} value Description\r\n   * @public\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set text(value) {\r\n    if (this.mText === value)\r\n      return;\r\n\r\n    this.mText = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n\r\n  /**\r\n   * autoSize - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get autoSize() {\r\n    return this.mAutoSize;\r\n  }\r\n\r\n  /**\r\n   * autoSize - Description\r\n   *\r\n   * @param {boolean} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set autoSize(value) {\r\n    if (this.mAutoSize === value)\r\n      return;\r\n\r\n    this.mAutoSize = value;\r\n    this.mNeedInvalidate = true;\r\n  }\r\n}\r\n","\r\nclass Device {\r\n  constructor() {\r\n    /** @type {Device} */\r\n    this.constructor.mInstance = this;\r\n\r\n    /** @type {number} */\r\n    this.mPixelRatio = 0;\r\n\r\n    /** @type {number} */\r\n    Device.mInstance.mPixelRatio = Device.getDevicePixelRatio();\r\n  }\r\n\r\n  /**\r\n   * @return {string}\r\n   */\r\n  static get os() {\r\n    var userAgent = navigator.userAgent || navigator.vendor || window.opera;\r\n\r\n    if (/windows phone/i.test(userAgent))\r\n      return 'Windows Phone';\r\n\r\n    if (/android/i.test(userAgent))\r\n      return 'Android';\r\n\r\n    if (/iPad|iPhone|iPod/.test(userAgent)/* && !window.MSStream*/)\r\n      return 'iOS';\r\n\r\n    return 'unknown';\r\n  }\r\n\r\n  /**\r\n   * isTouch - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  static get isTouch() {\r\n    let hasEvent = 'ontouchstart' in window;\r\n    if (hasEvent)\r\n      return true;\r\n\r\n    if (navigator.maxTouchPoints > 0)\r\n      return true;\r\n\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * isMobile - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  static get isMobile() {\r\n    return /Mobi/.test(navigator.userAgent);\r\n  }\r\n\r\n  /**\r\n   * pixelRatio - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static get pixelRatio() {\r\n    return Device.mInstance.mPixelRatio;\r\n  }\r\n\r\n  /**\r\n   * getDevicePixelRatio - Description\r\n   *\r\n   * @suppress {missingProperties}\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static getDevicePixelRatio() {\r\n    if (window.screen.systemXDPI !== undefined && window.screen.logicalXDPI !== undefined && window.screen.systemXDPI > window.screen.logicalXDPI)\r\n      return window.screen.systemXDPI / window.screen.logicalXDPI;\r\n    else if (window.devicePixelRatio !== undefined)\r\n      return window.devicePixelRatio;\r\n\r\n    return 1;\r\n  }\r\n\r\n}\r\n\r\n/** @type {Device}\r\n * @nocollapse\r\n */\r\nDevice.mInstance = null;\r\n","\r\nclass Scatter {\r\n  constructor() {}\r\n\r\n  /**\r\n   * getValue\r\n   *\r\n   * @return {*}\r\n   */\r\n  getValue() {}\r\n\r\n\r\n  /**\r\n   * getValueAt\r\n   *\r\n   * @param {number} t\r\n   *\r\n   * @return {*}\r\n   */\r\n  getValueAt(t) {}\r\n}\r\n","\r\nclass FloatScatter extends Scatter {\r\n  constructor(min, max = undefined, ease = null) {\r\n    super();\r\n\r\n    // NOTE: dont make us @private @member\r\n    this.min = min;\r\n    this.max = max == null ? min : max;\r\n    \r\n    this.ease = ease;\r\n  }\r\n\r\n\r\n  /**\r\n   * getValue\r\n   *\r\n   * @return {number}\r\n   */\r\n  getValue() {\r\n    return Math.random() * (this.max - this.min) + this.min;\r\n  }\r\n\r\n\r\n  /**\r\n   * getValueAt\r\n   *\r\n   * @param {number} t\r\n   *\r\n   * @return {number}\r\n   */\r\n  getValueAt(t) {\r\n    if (this.ease !== null)\r\n      t = this.ease(t);\r\n\r\n    return this.min + t * (this.max - this.min);\r\n  }\r\n}\r\n","\r\nclass VectorScatter extends Scatter {\r\n  constructor(minX, minY, maxX, maxY) {\r\n    super();\r\n\r\n    // NOTE: dont make us @private @member\r\n    this.minX = minX;\r\n    this.minY = minY;\r\n    this.maxX = maxX;\r\n    this.maxY = maxY;\r\n  }\r\n\r\n\r\n  /**\r\n   * getValue\r\n   *\r\n   * @return {Vector}\r\n   */\r\n  getValue() {\r\n    let outVector = new Vector();\r\n    outVector.x = Math.random() * (this.maxX - this.minX) + this.minX;\r\n    outVector.y = Math.random() * (this.maxY - this.minY) + this.minY;\r\n    return outVector;\r\n  }\r\n\r\n\r\n  /**\r\n   * getValueAt\r\n   *\r\n   * @param {number} t\r\n   *\r\n   * @return {Vector}\r\n   */\r\n  getValueAt(t) {\r\n    let outVector = new Vector();\r\n    outVector.x = this.minX + t * (this.maxX - this.minX);\r\n    outVector.y = this.minY + t * (this.maxY - this.minY);\r\n    return outVector;\r\n  }\r\n}\r\n","\r\nclass FloatCurveScatter extends Scatter {\r\n  /**\r\n   * @param {...number} points Coordinates: startX, startY, cpStartX, cpStartY, cpEndX, cpEndY, endX/start2X, endY/start2Y, cp2StartX, cp2StartX... 8 or 14 or 20...\r\n   */\r\n  constructor(...points) {\r\n    super();\r\n\r\n    this.mCurve = new Curve();\r\n    this.mCurve.baked = true;\r\n    this.mCurve.set(...points);\r\n\r\n    this.mCache = new Vector();\r\n  }\r\n\r\n  getValue() {\r\n    let t = Math.random();\r\n    this.mCurve.interpolate(t, this.mCache);\r\n    return this.mCache.y;\r\n  }\r\n\r\n  getValueAt(t) {\r\n    this.mCurve.interpolate(t, this.mCache);\r\n    return this.mCache.y;\r\n  }\r\n}\r\n\r\n\r\nclass VectorCurveScatter extends Scatter {\r\n  /**\r\n   * @param {...number} points Coordinates: startX, startY, cpStartX, cpStartY, cpEndX, cpEndY, endX/start2X, endY/start2Y, cp2StartX, cp2StartX... 8 or 14 or 20...\r\n   */\r\n  constructor(...points) {\r\n    super();\r\n\r\n    this.mCurve = new Curve();\r\n    this.mCurve.baked = true;\r\n    this.mCurve.set(...points);\r\n\r\n    this.mCache = new Vector();\r\n  }\r\n\r\n\r\n  getValue() {\r\n    let t = Math.random();\r\n    this.mCurve.interpolate(t, this.mCache);\r\n    return this.mCache;\r\n  }\r\n\r\n\r\n  getValueAt(t) {\r\n    this.mCurve.interpolate(t, this.mCache);\r\n    return this.mCache;\r\n  }\r\n}\r\n","\r\nclass Action {\r\n\r\n  /**\r\n   * preUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   * @param {number} t  Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  preUpdate(dt, t) {}\r\n\r\n\r\n  /**\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {}\r\n\r\n\r\n  /**\r\n   * postUpdate\r\n   *\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  postUpdate(dt, t) {}\r\n}\r\n","/**\r\n * @extends Action\r\n */\r\n\r\nclass Acceleration extends Action {\r\n  constructor(vectorScatter) {\r\n    super();\r\n\r\n    this.scatter = vectorScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {\r\n    let v = this.scatter.getValue();\r\n\r\n    particle.ax += v.x;\r\n    particle.ay += v.y;\r\n  }\r\n}\r\n","/**\r\n * @extends Action\r\n */\r\n\r\nclass AlphaOverLife extends Action {\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {\r\n    particle.alpha = this.scatter.getValueAt(particle.energy);\r\n  }\r\n}\r\n","/**\r\n * @extends Action\r\n */\r\n\r\nclass ScaleOverLife extends Action {\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {\r\n    particle.scale = this.scatter.getValueAt(particle.energy);\r\n  }\r\n}\r\n","/**\r\n * @extends Action\r\n */\r\n\r\nclass RotationOverLife extends Action {\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {\r\n    particle.r = this.scatter.getValueAt(particle.energy);\r\n  }\r\n}\r\n","/**\r\n * @extends Action\r\n */\r\n\r\nclass TextureOverLife extends Action {\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Emitter} emmiter\r\n   * @param {Particle} particle\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(emmiter, particle, dt, t) {\r\n    particle.textureIndex = ~~this.scatter.getValueAt(particle.energy);\r\n  }\r\n}\r\n","\r\nclass Initializer {\r\n  /**\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */  \r\n  initialize(particle) {}\r\n}\r\n","\r\nclass Life extends Initializer {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {FloatScatter} floatScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    particle.life = this.scatter.getValue();\r\n  }\r\n}\r\n","\r\nclass Mass extends Initializer {\r\n\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {number} mass Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(mass) {\r\n    super();\r\n\r\n    /** @type {number} */\r\n    this.mass = mass;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    particle.mass = this.mass;\r\n  }\r\n}\r\n","\r\nclass Scale extends Initializer {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {FloatScatter} floatScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    particle.scale = this.scatter.getValue();\r\n  }\r\n}\r\n","\r\nclass Velocity extends Initializer {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {VectorScatter} vectorScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(vectorScatter) {\r\n    super();\r\n\r\n    /** @type {VectorScatter} */\r\n    this.scatter = vectorScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    // TODO: optimize!\r\n    let v = this.scatter.getValue();\r\n    particle.vx = v.x;\r\n    particle.vy = v.y;\r\n  }\r\n}\r\n","\r\nclass Position extends Initializer {\r\n\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {VectorScatter} vectorScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(vectorScatter) {\r\n    super();\r\n\r\n    /** @type {VectorScatter} */\r\n    this.scatter = vectorScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    // TODO: optimize!\r\n    let v = this.scatter.getValue();\r\n    particle.x = v.x;\r\n    particle.y = v.y;\r\n  }\r\n}\r\n","\r\nclass Rotation extends Initializer {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {FloatScatter} floatScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    particle.r = this.scatter.getValue();\r\n  }\r\n}\r\n","\r\nclass RandomTexture extends Initializer {\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {FloatScatter} floatScatter Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(floatScatter) {\r\n    super();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.scatter = floatScatter;\r\n  }\r\n\r\n  /**\r\n   * @override\r\n   * @param {Particle} particle\r\n   *\r\n   * @return {void}\r\n   */\r\n  initialize(particle) {\r\n    particle.textureIndex = ~~this.scatter.getValue();\r\n  }\r\n}\r\n","/**\r\n * @enum {number}\r\n */\r\nvar EmitterState = {\r\n  PENDING: 0,\r\n  EMITTING: 1,\r\n  FINISHED: 2\r\n};\r\n","\r\nclass Particle {\r\n  constructor() {\r\n    this.reset();\r\n  }\r\n\r\n  reset() {\r\n    /** @type {number} */\r\n    this.textureIndex = 0;\r\n\r\n    /** @type {number} */\r\n    this.scale = 1;\r\n\r\n    /** @type {number} */\r\n    this.alpha = 1;\r\n\r\n    /** @type {number} */\r\n    this.life = 1;\r\n\r\n    /** @type {number} */\r\n    this.age = 0;\r\n\r\n    /** @type {number} */\r\n    this.energy = this.age / this.life;\r\n\r\n    /** @type {number} */\r\n    this.mass = 0;\r\n\r\n    /** @type {number} */\r\n    this.x = 0;\r\n\r\n    /** @type {number} */\r\n    this.y = 0;\r\n\r\n    /** @type {number} */\r\n    this.r = 0\r\n\r\n    /** @type {number} */\r\n    this.vx = 0;\r\n\r\n    /** @type {number} */\r\n    this.vy = 0;\r\n\r\n    /** @type {number} */\r\n    this.ax = 0;\r\n\r\n    /** @type {number} */\r\n    this.ay = 0;\r\n  }\r\n\r\n  /**\r\n   * update\r\n   *\r\n   * @param {number} dt\r\n   *\r\n   * @return {void}\r\n   */\r\n  update(dt) {\r\n    if (this.life <= 0) {\r\n      this.life = 0;\r\n      return;\r\n    }\r\n\r\n    this.x += this.vx * dt;\r\n    this.y += this.vy * dt;\r\n\r\n    if (this.mass > 0) {\r\n      this.ax *= 1 / this.mass;\r\n      this.ay *= 1 / this.mass;\r\n    }\r\n\r\n    this.vx += this.ax * dt;\r\n    this.vy += this.ay * dt;\r\n\r\n    this.ax = 0;\r\n    this.ay = 0;\r\n\r\n    this.life -= dt;\r\n    this.age += dt;\r\n\r\n    this.energy = this.age / (this.age + this.life);\r\n  }\r\n}\r\n","\r\nclass Emitter extends DisplayObject {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {Array<Texture>} */\r\n    this.mTextures = null;\r\n\r\n    /** @type {Array<Particle>} */\r\n    this.mParticles = [];\r\n\r\n    /** @type {Array<Particle>} */\r\n    this.mRecycled = [];\r\n\r\n    /** @type {Array<Initializer>} */\r\n    this.mInitializers = [];\r\n\r\n    /** @type {Array<Action>} */\r\n    this.mActions = [];\r\n\r\n    /** @type {GameObject} */\r\n    this.mSpace = null;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsLocal = true;\r\n\r\n    /** @type {number} */\r\n    this.mMaxParticles = 10000;\r\n\r\n    /** @type {FloatScatter} */\r\n    this.mEmitCount = new FloatScatter(10);\r\n\r\n    /** @type {FloatScatter} */\r\n    this.mEmitNumRepeats = new FloatScatter(Infinity);\r\n\r\n    /** @type {number} */\r\n    this.mEmitNumRepeatsLeft = this.mEmitNumRepeats.getValue();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.mEmitDuration = new FloatScatter(1);\r\n\r\n    /** @type {number} */\r\n    this.mEmitDurationLeft = this.mEmitDuration.getValue();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.mEmitInterval = new FloatScatter(0.1);\r\n\r\n    /** @type {number} */\r\n    this.mEmitIntervalLeft = this.mEmitInterval.getValue();\r\n\r\n    /** @type {FloatScatter} */\r\n    this.mEmitDelay = new FloatScatter(1);\r\n\r\n    /** @type {number} */\r\n    this.mEmitDelayLeft = this.mEmitDelay.getValue();\r\n\r\n    /** @type {number} */\r\n    this.mNextUpdateAt = 0;\r\n\r\n    /** @type {EmitterState} */\r\n    this.mState = EmitterState.PENDING;\r\n\r\n    // /** @type {function(a:Particle, b:Particle):number} */\r\n    // this.mComparer = null;\r\n\r\n    /** @type {Matrix} */\r\n    this.__tmpLocal = new Matrix();\r\n\r\n    /** @type {Matrix} */\r\n    this.__tmpWorld = new Matrix();\r\n  }\r\n\r\n  // reset() {\r\n  //   this.mState = 0;\r\n  //\r\n  //   // todo: reset simulation\r\n  //   // todo: clear all particles\r\n  //   this.updateNextTick(0);\r\n  // }\r\n\r\n  resetState() {\r\n    this.mState = EmitterState.PENDING;\r\n  }\r\n\r\n  /**\r\n   * updateNextTick - Updates delay, duration, interval. Use this function each time you change one of those values.\r\n   *\r\n   * @param {number} [dt=0]\r\n   *\r\n   * @return {void}\r\n   */\r\n  updateNextTick(dt = 0) {\r\n    let t = Black.instance.uptime;\r\n    let firstEmit = false;\r\n\r\n    if (this.mState === EmitterState.PENDING) {\r\n      this.mNextUpdateAt = t + this.mEmitDelayLeft;\r\n      this.mEmitDelayLeft -= dt;\r\n\r\n      if (this.mEmitDelayLeft <= 0) {\r\n        this.mEmitDelayLeft = this.mEmitDelay.getValue();\r\n        this.mState = EmitterState.EMITTING;\r\n        firstEmit = true;\r\n      }\r\n    }\r\n\r\n    if (this.mState === EmitterState.EMITTING) {\r\n      if (this.mEmitDurationLeft <= 0) {\r\n        this.mEmitDurationLeft = this.mEmitDuration.getValue();\r\n\r\n        this.mEmitNumRepeatsLeft--;\r\n\r\n        if (this.mEmitNumRepeatsLeft <= 0) {\r\n          this.mState = EmitterState.FINISHED;\r\n\r\n          this.post('complete');\r\n          return;\r\n        } else {\r\n          this.mState = EmitterState.PENDING;\r\n          return;\r\n        }\r\n      } else {\r\n        // we are getting value here each update to make sure we are up to date!\r\n        if (firstEmit) {\r\n          // for a first emit we do not want to add an extra delay. emit now!\r\n          this.mNextUpdateAt = t\r\n          this.mEmitIntervalLeft = this.mEmitInterval.getValue();\r\n        }\r\n        else {\r\n          this.mEmitIntervalLeft -= dt;\r\n          this.mNextUpdateAt = t + this.mEmitIntervalLeft;\r\n          //console.log(this.mEmitIntervalLeft);\r\n\r\n          // reset interval\r\n          if (this.mEmitIntervalLeft <= 0)\r\n            this.mEmitIntervalLeft = this.mEmitInterval.getValue();\r\n        }\r\n      }\r\n\r\n      this.mEmitDurationLeft -= dt;\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * addInitializer - Adds Initializer to the end of the list.\r\n   *\r\n   * @param {Initializer} initializer\r\n   *\r\n   * @return {Initializer}\r\n   */\r\n  addInitializer(initializer) {\r\n    this.mInitializers.push(initializer);\r\n    return initializer;\r\n  }\r\n\r\n\r\n  /**\r\n   * addAction - Adds action to the end of the list.\r\n   *\r\n   * @param {Action} action\r\n   *\r\n   * @return {Action}\r\n   */\r\n  addAction(action) {\r\n    this.mActions.push(action);\r\n    return action;\r\n  }\r\n\r\n  __render(video, time, parentAlpha, parentBlendMode) {\r\n    video.save(this);\r\n\r\n    // set blend mode\r\n    let tmpBlendMode = BlendMode.AUTO;\r\n    video.globalBlendMode = tmpBlendMode = this.blendMode === BlendMode.AUTO ? parentBlendMode : this.blendMode;\r\n\r\n    // tmp matrices\r\n    let localTransform = this.__tmpLocal;\r\n    let worldTransform = this.__tmpWorld;\r\n    localTransform.identity();\r\n\r\n    let texture = null;\r\n\r\n    if (this.mTextures.length > 0) {\r\n      let plength = this.mParticles.length;\r\n      let particle;\r\n      for (let i = 0; i < plength; i++) {\r\n      //for (let i = plength - 1; i > 0; i--) {\r\n        particle = this.mParticles[i];\r\n        texture = this.mTextures[particle.textureIndex];\r\n\r\n        let tw = texture.width * 0.5;\r\n        let th = texture.height * 0.5;\r\n\r\n        if (particle.r === 0) {\r\n          let tx = particle.x - tw * particle.scale;\r\n          let ty = particle.y - th * particle.scale;\r\n          localTransform.set(particle.scale, 0, 0, particle.scale, tx, ty);\r\n        } else {\r\n          let cos = Math.cos(particle.r);\r\n          let sin = Math.sin(particle.r);\r\n          let a = particle.scale * cos;\r\n          let b = particle.scale * sin;\r\n          let c = particle.scale * -sin;\r\n          let d = particle.scale * cos;\r\n\r\n          let tx = particle.x - tw * a - th * c;\r\n          let ty = particle.y - tw * b - th * d;\r\n          localTransform.set(a, b, c, d, tx, ty);\r\n        }\r\n\r\n        if (this.mIsLocal === true) {\r\n          worldTransform.identity();\r\n          worldTransform.copyFrom(localTransform);\r\n          worldTransform.prepend(this.worldTransformation);\r\n        } else {\r\n          this.mSpace.worldTransformation.copyTo(worldTransform);\r\n          worldTransform.append(localTransform);\r\n        }\r\n\r\n        video.setTransform(worldTransform);\r\n        video.globalAlpha = parentAlpha * this.mAlpha * particle.alpha;\r\n        video.drawImage(texture);\r\n      }\r\n    }\r\n\r\n    video.restore();\r\n    super.__render(video, time, parentAlpha, parentBlendMode);\r\n  }\r\n\r\n  onUpdate(dt) {\r\n    // rate logic\r\n    this.updateNextTick(dt);\r\n\r\n    if (Black.instance.uptime >= this.mNextUpdateAt && this.mState === EmitterState.EMITTING)\r\n      this.__create(this.mEmitCount.getValue());\r\n\r\n    // main update login\r\n    let alength = this.mActions.length;\r\n    let plength = this.mParticles.length;\r\n\r\n    let t = Black.instance.uptime;\r\n\r\n    for (let i = 0; i < alength; i++)\r\n      this.mActions[i].preUpdate(dt, t);\r\n\r\n    let particle;\r\n\r\n    let i = this.mParticles.length;\r\n    while (i--) {\r\n      particle = this.mParticles[i];\r\n\r\n      for (let k = 0; k < alength; k++)\r\n        this.mActions[k].update(this, particle, dt, t);\r\n\r\n      particle.update(dt);\r\n\r\n      if (particle.life === 0) {\r\n        this.mRecycled.push(particle);\r\n        this.mParticles.splice(i, 1);\r\n      }\r\n    }\r\n\r\n    for (let j = 0; j < alength; j++)\r\n      this.mActions[j].postUpdate(dt, t);\r\n  }\r\n\r\n  __create(amount) {\r\n    let matrix = this.worldTransformation.clone();\r\n    let minv = null;\r\n\r\n    if (this.mIsLocal === false) {\r\n      minv = this.mSpace.worldTransformationInversed.clone();\r\n      matrix.prepend(minv);\r\n    }\r\n\r\n    for (let i = 0; i < amount; i++) {\r\n      let p = null;\r\n\r\n      if (this.mRecycled.length > 0) {\r\n        p = this.mRecycled.pop();\r\n      } else {\r\n        if (this.mParticles.length >= this.mMaxParticles)\r\n          return;\r\n\r\n        p = new Particle();\r\n      }\r\n\r\n      p.reset();\r\n\r\n      for (let k = 0; k < this.mInitializers.length; k++) {\r\n        let initer = this.mInitializers[k];\r\n        initer.initialize(p);\r\n      }\r\n\r\n      if (this.mIsLocal === false) {\r\n        matrix.transformDirectionXY(p.ax, p.ay, Vector.__cache);\r\n        p.ax = Vector.__cache.x;\r\n        p.ay = Vector.__cache.y;\r\n\r\n        matrix.transformDirectionXY(p.vx, p.vy, Vector.__cache);\r\n        p.vx = Vector.__cache.x;\r\n        p.vy = Vector.__cache.y;\r\n\r\n        matrix.transformXY(p.x, p.y, Vector.__cache);\r\n        p.x = Vector.__cache.x;\r\n        p.y = Vector.__cache.y;\r\n      }\r\n\r\n      this.mParticles.push(p);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * maxParticles\r\n   *\r\n   * @return {number}\r\n   */\r\n  get maxParticles() {\r\n    return this.mMaxParticles;\r\n  }\r\n\r\n\r\n  /**\r\n   * maxParticles\r\n   *\r\n   * @param {number} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set maxParticles(value) {\r\n    if (value < 0)\r\n      throw new Error('Bad argument error.');\r\n\r\n    this.mMaxParticles = value;\r\n  }\r\n\r\n\r\n  /**\r\n   * emitCount\r\n   *\r\n   * @return {FloatScatter}\r\n   */\r\n  get emitCount() {\r\n    return this.mEmitCount;\r\n  }\r\n\r\n\r\n  /**\r\n   * emitCount\r\n   *\r\n   * @param {FloatScatter} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set emitCount(value) {\r\n    this.mEmitCount = value;\r\n  }\r\n\r\n\r\n  /**\r\n   * emitNumRepeats\r\n   *\r\n   * @return {FloatScatter}\r\n   */\r\n  get emitNumRepeats() { return this.mEmitNumRepeats; }\r\n\r\n  /**\r\n   * emitNumRepeats\r\n   *\r\n   * @param {FloatScatter} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set emitNumRepeats(value) { this.mEmitNumRepeats = value; this.mEmitNumRepeatsLeft = this.mEmitNumRepeats.getValue(); }\r\n\r\n\r\n  /**\r\n   * emitDuration\r\n   *\r\n   * @return {FloatScatter}\r\n   */\r\n  get emitDuration() { return this.mEmitDuration; }\r\n\r\n  /**\r\n   * emitDuration\r\n   *\r\n   * @param {FloatScatter} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set emitDuration(value) { this.mEmitDuration = value; this.mEmitDurationLeft = this.mEmitDuration.getValue(); }\r\n\r\n\r\n  /**\r\n   * emitInterval\r\n   *\r\n   * @return {FloatScatter}\r\n   */\r\n  get emitInterval() { return this.mEmitInterval; }\r\n\r\n  /**\r\n   * emitInterval\r\n   *\r\n   * @param {FloatScatter} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set emitInterval(value) { this.mEmitInterval = value; this.mEmitIntervalLeft = this.mEmitInterval.getValue(); }\r\n\r\n\r\n  /**\r\n   * emitDelay\r\n   *\r\n   * @return {FloatScatter}\r\n   */\r\n  get emitDelay() { return this.mEmitDelay; }\r\n\r\n  /**\r\n   * emitDelay\r\n   *\r\n   * @param {FloatScatter} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set emitDelay(value) { this.mEmitDelay = value; this.mEmitDelayLeft = this.mEmitDelay.getValue(); }\r\n\r\n\r\n  /**\r\n   * space\r\n   *\r\n   * @return {GameObject}\r\n   */\r\n  get space() { return this.mSpace; }\r\n\r\n  /**\r\n   * space\r\n   *\r\n   * @param {GameObject} gameObject\r\n   *\r\n   * @return {void}\r\n   */\r\n  set space(gameObject) {\r\n    this.mSpace = gameObject;\r\n    this.mIsLocal = this.mSpace === null || this.mSpace === this;\r\n  }\r\n\r\n\r\n  /**\r\n   * textures\r\n   *\r\n   * @return {Array<Texture>}\r\n   */\r\n  get textures() {\r\n    return this.mTextures;\r\n  }\r\n\r\n\r\n  /**\r\n   * textures\r\n   *\r\n   * @param {Array<Texture>} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set textures(value) {\r\n    if (value.length === 0)\r\n      throw new Error('At least one texture must be provided.');\r\n\r\n    this.mTextures = value;\r\n  }\r\n}\r\n","/**\r\n * @enum {number}\r\n */\r\n\r\nvar Key = {\r\n  A: 65,\r\n  B: 66,\r\n  C: 67,\r\n  D: 68,\r\n  E: 69,\r\n  F: 70,\r\n  G: 71,\r\n  H: 72,\r\n  I: 73,\r\n  J: 74,\r\n  K: 75,\r\n  L: 76,\r\n  M: 77,\r\n  N: 78,\r\n  O: 79,\r\n  P: 80,\r\n  Q: 81,\r\n  R: 82,\r\n  S: 83,\r\n  T: 84,\r\n  U: 85,\r\n  V: 86,\r\n  W: 87,\r\n  X: 88,\r\n  Y: 89,\r\n  Z: 90,\r\n  DIGIT_0: 48,\r\n  DIGIT_1: 49,\r\n  DIGIT_2: 50,\r\n  DIGIT_3: 51,\r\n  DIGIT_4: 52,\r\n  DIGIT_5: 53,\r\n  DIGIT_6: 54,\r\n  DIGIT_7: 55,\r\n  DIGIT_8: 56,\r\n  DIGIT_9: 57,\r\n  NUMPAD_0: 96,\r\n  NUMPAD_1: 97,\r\n  NUMPAD_2: 98,\r\n  NUMPAD_3: 99,\r\n  NUMPAD_4: 100,\r\n  NUMPAD_5: 101,\r\n  NUMPAD_6: 102,\r\n  NUMPAD_7: 103,\r\n  NUMPAD_8: 104,\r\n  NUMPAD_9: 105,\r\n  NUMPAD_MULTIPLY: 106,\r\n  NUMPAD_ADD: 107,\r\n  NUMPAD_SUBTRACT: 109,\r\n  NUMPAD_DECIMAL: 110,\r\n  NUMPAD_DIVIDE: 111,\r\n  LEFT_ARROW: 37,\r\n  UP_ARROW: 38,\r\n  RIGHT_ARROW: 39,\r\n  DOWN_ARROW: 40,\r\n  BACKSPACE: 8,\r\n  TAB: 9,\r\n  ENTER: 13,\r\n  SHIFT: 16,\r\n  CTRL: 17,\r\n  ALT: 18,\r\n  F1: 112,\r\n  F2: 113,\r\n  F3: 114,\r\n  F4: 115,\r\n  F5: 116,\r\n  F6: 117,\r\n  F7: 118,\r\n  F8: 119,\r\n  F9: 120,\r\n  F10: 121,\r\n  F11: 122,\r\n  F12: 123,\r\n  PAUSE_BREAK: 19,\r\n  CAPS_LOCK: 20,\r\n  ESCAPE: 27,\r\n  PAGE_UP: 33,\r\n  PAGE_DOWN: 34,\r\n  END: 35,\r\n  HOME: 36,\r\n  INSERT: 45,\r\n  DELETE: 46,\r\n  LEFT_WINDOW: 91,\r\n  RIGHT_WINDOW: 92,\r\n  CONTEXT_MENU: 93,\r\n  NUM_LOCK: 144,\r\n  SCROLL_LOCK: 145,\r\n  SEMI_COLON: 186,\r\n  EQUAL_SIGN: 187,\r\n  COMMA: 188,\r\n  DASH: 189,\r\n  PERIOD: 190,\r\n  FORWARD_SLASH: 191,\r\n  BACKQUOTE: 192,\r\n  BRAKET_LEFT: 219,\r\n  BACK_SLASH: 220,\r\n  BRAKET_RIGHT: 221,\r\n  SINGLE_QUOTE: 222,\r\n};\r\n","\r\nclass KeyInfo {\r\n\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {Event} nativeEvent Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  constructor(nativeEvent) {\r\n    this.keyCode = nativeEvent.keyCode;\r\n    this.code = nativeEvent.code;\r\n    this.char = nativeEvent.key;\r\n    this.shiftKey = nativeEvent.shiftKey;\r\n    this.altKey = nativeEvent.altKey;\r\n    this.ctrlKey = nativeEvent.ctrlKey;\r\n  }\r\n}\r\n","/*\r\nHas to be static class.\r\n\r\n+ before update store all events locally\r\n- check root object! add collider automatically? or do it on demand?\r\n*/\r\n\r\n\r\nclass Input extends System {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {Input} */\r\n    this.constructor.instance = this;\r\n\r\n    /** @type {Vector} */\r\n    this.mPointerPosition = new Vector();\r\n\r\n    /** @type {Element} */\r\n    this.mDom = Black.instance.containerElement;\r\n\r\n    /** @type {Array<string>} */\r\n    this.mEventList = null;\r\n\r\n    /** @type {Array<string>} */\r\n    this.mKeyEventList = null;\r\n\r\n    this.__initListeners();\r\n\r\n    /** @type {Array<{e: Event, x: number, y:number}>} */\r\n    this.mPointerQueue = [];\r\n\r\n    /** @type {Array<Event>} */\r\n    this.mKeyQueue = [];\r\n\r\n    /** @type {Array<number>} */\r\n    this.mPressedKeys = [];\r\n\r\n    /** @type {boolean} */\r\n    this.mIsPointerDown = false;\r\n\r\n    this.mNeedUpEvent = false;\r\n\r\n    /** @type {Array<InputComponent>} */\r\n    this.mInputListeners = [];\r\n  }\r\n\r\n  __initListeners() {\r\n    this.mKeyEventList = Input.mKeyEventList;\r\n    //debugger;\r\n\r\n    if (window.PointerEvent)\r\n      this.mEventList = Input.mPointerEventList;\r\n    else if (Device.isTouch && Device.isMobile)\r\n      this.mEventList = Input.mTouchEventList;\r\n    else\r\n      this.mEventList = Input.mMouseEventList;\r\n\r\n    for (let i = 0; i < 6; i++)\r\n      this.mDom.addEventListener(this.mEventList[i], e => this.__onPointerEvent(e), false);\r\n\r\n    document.addEventListener(this.mEventList[Input.POINTER_UP], e => this.__onPointerEventDoc(e), false);\r\n\r\n    for (let i = 0; i < this.mKeyEventList.length; i++)\r\n      document.addEventListener(this.mKeyEventList[i], e => this.__onKeyEvent(e), false);\r\n  }\r\n\r\n  __sortListeners() {\r\n    // TODO: make it faster\r\n    // - try insert sort\r\n    this.mInputListeners.sort((x, y) => {\r\n      return y.gameObject.depth - x.gameObject.depth || y.gameObject.index - x.gameObject.index;\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * @param {Event} e\r\n   *\r\n   * @return {boolean}\r\n   */\r\n  __onKeyEvent(e) {\r\n    this.mKeyQueue.push(e);\r\n    return true;\r\n  }\r\n\r\n  __onPointerEventDoc(e) {\r\n    let over = e.target == this.mDom || e.target.parentElement == this.mDom;\r\n\r\n    if (over === false && this.mNeedUpEvent === true) {\r\n      this.mNeedUpEvent = false;\r\n      this.__pushEvent(e);\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * @param {Event} e Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  __onPointerEvent(e) {\r\n    e.preventDefault();\r\n\r\n    this.__pushEvent(e);\r\n\r\n    return true;\r\n  }\r\n\r\n  __pushEvent(e) {\r\n    let /** @type {Vector|null} */ p = null;\r\n    if (e.type.indexOf('touch') === 0)\r\n      p = this.__getTouchPos(this.mDom, /** @type {TouchEvent} */ (e));\r\n    else\r\n      p = this.__getPointerPos(this.mDom, e);\r\n\r\n    this.mPointerPosition.x = p.x;\r\n    this.mPointerPosition.y = p.y;\r\n\r\n    this.mPointerQueue.push({\r\n      e: e,\r\n      x: p.x,\r\n      y: p.y\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n   * __getPointerPos - Description\r\n   *\r\n   * @param {Element} canvas Description\r\n   * @param {Event} evt    Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  __getPointerPos(canvas, evt) {\r\n    let rect = canvas.getBoundingClientRect();\r\n    let scaleX = canvas.clientWidth / rect.width;\r\n    let scaleY = canvas.clientHeight / rect.height;\r\n    return new Vector((evt.clientX - rect.left) * scaleX, (evt.clientY - rect.top) * scaleY);\r\n  }\r\n\r\n  /**\r\n   * __getTouchPos - Description\r\n   *\r\n   * @param {Element} canvas Description\r\n   * @param {TouchEvent} evt    Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  __getTouchPos(canvas, evt) {\r\n    let rect = canvas.getBoundingClientRect();\r\n\r\n    /** @type {Touch} */\r\n    let touch = evt.changedTouches[0]; // ios? what about android?\r\n    let x = touch.clientX;\r\n    let y = touch.clientY;\r\n\r\n    let scaleX = canvas.clientWidth / rect.width;\r\n    let scaleY = canvas.clientHeight / rect.height;\r\n    return new Vector((x - rect.left) * scaleX, (y - rect.top) * scaleY);\r\n  }\r\n\r\n\r\n  /**\r\n   * __addListener - Description\r\n   *\r\n   * @param {Array<InputComponent>} array Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __addListener(array) {\r\n    // check for duplicates\r\n    for (let i = 0; i < array.length; i++) {\r\n      let item = /** @type {InputComponent} */ (array[i]);\r\n\r\n      if (this.mInputListeners.indexOf(item) === -1)\r\n        this.mInputListeners.push(item);\r\n    }\r\n\r\n    this.__sortListeners();\r\n  }\r\n\r\n\r\n  /**\r\n   * onChildrenAdded - Description\r\n   *\r\n   * @param {GameObject} child Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onChildrenAdded(child) {\r\n    let cs = GameObject.findComponents(child, InputComponent);\r\n    if (!cs || cs.length === 0)\r\n      return;\r\n\r\n    this.__addListener(cs);\r\n  }\r\n\r\n\r\n  /**\r\n   * onChildrenRemoved - Description\r\n   *\r\n   * @param {GameObject} child Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onChildrenRemoved(child) {\r\n    let cs = GameObject.findComponents(child, InputComponent);\r\n    if (!cs || cs.length === 0)\r\n      return;\r\n\r\n    for (var i = cs.length - 1; i >= 0; i--) {\r\n      let component = cs[i];\r\n      let index = this.mInputListeners.indexOf( /** @type {InputComponent} */ (component));\r\n\r\n      if (index !== -1)\r\n        this.mInputListeners.splice(index, 1);\r\n    }\r\n\r\n    this.__sortListeners();\r\n  }\r\n\r\n\r\n  /**\r\n   * onComponentAdded - Description\r\n   *\r\n   * @param {GameObject} child     Description\r\n   * @param {Component} component Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onComponentAdded(child, component) {\r\n    if (component.constructor !== InputComponent)\r\n      return;\r\n\r\n    this.__addListener([component]);\r\n  }\r\n\r\n\r\n  /**\r\n   * onComponentRemoved - Description\r\n   *\r\n   * @param {GameObject} child     Description\r\n   * @param {Component} component Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onComponentRemoved(child, component) {\r\n    if (component.constructor !== InputComponent)\r\n      return;\r\n\r\n    let index = this.mInputListeners.indexOf( /** @type {InputComponent} */ (component));\r\n    if (index !== -1) {\r\n      this.mInputListeners.splice(index, 1);\r\n      this.__sortListeners();\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * onUpdate - Description\r\n   *\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onUpdate(dt) {\r\n    let pointerPos = new Vector();\r\n\r\n    for (let i = 0; i < this.mPointerQueue.length; i++) {\r\n      let nativeEvent = this.mPointerQueue[i];\r\n\r\n      let ix = this.mEventList.indexOf(nativeEvent.e.type);\r\n      let fnName = Input.mInputEventsLookup[ix];\r\n\r\n      if (fnName === 'pointerDown')\r\n        this.mNeedUpEvent = true;\r\n\r\n      pointerPos.set(nativeEvent.x, nativeEvent.y);\r\n\r\n      /** @type {InputComponent|null} */\r\n      let currentComponent = null;\r\n      for (let k = 0; k < this.mInputListeners.length; k++) {\r\n        currentComponent = this.mInputListeners[k];\r\n\r\n        // if (currentComponent.gameObject === null)\r\n        //   console.log(currentComponent);\r\n\r\n        if (GameObject.intersects(currentComponent.gameObject, pointerPos) === false) {\r\n          // check for out events\r\n          if (currentComponent.mPointerInside === true) {\r\n            currentComponent.mPointerInside = false;\r\n            currentComponent.gameObject.post('~pointerOut');\r\n          }\r\n\r\n          continue;\r\n        }\r\n\r\n        // TODO: fix weird extra pointerMove bug on chrome, happens right after down and before up\r\n        if (ix === Input.POINTER_DOWN)\r\n          this.mIsPointerDown = true;\r\n        else if (ix === Input.POINTER_UP)\r\n          this.mIsPointerDown = false;\r\n\r\n        if (currentComponent.mPointerInside === false) {\r\n          currentComponent.mPointerInside = true;\r\n          currentComponent.gameObject.post('~pointerIn');\r\n        }\r\n\r\n        currentComponent.gameObject.post('~' + fnName);\r\n      }\r\n\r\n      this.post(fnName);\r\n    }\r\n\r\n    for (let i = 0; i < this.mKeyQueue.length; i++) {\r\n      let nativeEvent = this.mKeyQueue[i];\r\n\r\n      let ix = this.mKeyEventList.indexOf(nativeEvent.type);\r\n      let pIx = this.mPressedKeys.indexOf(nativeEvent.keyCode);\r\n      let fnName = Input.mKeyEventsLookup[ix];\r\n\r\n      if (fnName === 'keyUp' && pIx !== -1)\r\n        this.mPressedKeys.splice(pIx, 1);\r\n\r\n      else if (fnName === 'keyDown' && pIx === -1) {\r\n        this.mPressedKeys.push(nativeEvent.keyCode);\r\n        fnName = 'keyPress';\r\n      }\r\n\r\n      this.post(fnName, new KeyInfo(nativeEvent), nativeEvent);\r\n    }\r\n\r\n    this.mPointerQueue.splice(0, this.mPointerQueue.length);\r\n    this.mKeyQueue.splice(0, this.mKeyQueue.length);\r\n  }\r\n\r\n  /**\r\n   * on - Description\r\n   *\r\n   * @param {string} name           Description\r\n   * @param {Function} callback       Description\r\n   * @param {Object=} [context=null] Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  static on(name, callback, context = null) {\r\n    Input.instance.on(name, callback, context);\r\n  }\r\n\r\n\r\n  /**\r\n   * isPointerDown - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  static get isPointerDown() {\r\n    return Input.instance.mIsPointerDown;\r\n  }\r\n\r\n\r\n  /**\r\n   * pointerX - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static get pointerX() {\r\n    return Input.instance.mPointerPosition.x;\r\n  }\r\n\r\n\r\n  /**\r\n   * pointerY - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static get pointerY() {\r\n    return Input.instance.mPointerPosition.y;\r\n  }\r\n\r\n\r\n  /**\r\n   * pointerPosition - Description\r\n   *\r\n   * @return {Vector} Description\r\n   */\r\n  static get pointerPosition() {\r\n    return Input.instance.mPointerPosition;\r\n  }\r\n\r\n  static get pressedKeys() {\r\n    return Input.instance.mPressedKeys;\r\n  }\r\n}\r\n\r\n/** @type {Input}\r\n * @nocollapse\r\n */\r\nInput.instance = null;\r\n\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_MOVE = 0;\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_DOWN = 1;\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_UP = 2;\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_CANCEL = 3;\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_IN = 4;\r\n\r\n/** @type {number}\r\n *  @const\r\n */\r\nInput.POINTER_OUT = 5;\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mKeyEventList = ['keydown', 'keyup'];\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mKeyEventsLookup = ['keyDown', 'keyUp', 'keyPress'];\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mInputEventsLookup = ['pointerMove', 'pointerDown', 'pointerUp', 'pointerIn', 'pointerOut'];\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mPointerEventList = ['pointermove', 'pointerdown', 'pointerup', 'pointerenter', 'pointerleave'];\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mMouseEventList = ['mousemove', 'mousedown', 'mouseup', 'mouseenter', 'mouseleave'];\r\n\r\n/** @type {Array<string>}\r\n *  @const\r\n */\r\nInput.mTouchEventList = ['touchmove', 'touchstart', 'touchend', 'touchenter', 'touchleave'];\r\n","\r\nclass InputComponent extends Component {\r\n  /**\r\n   * @return {void}\r\n   */\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {boolean} */\r\n    this.touchable = true;\r\n\r\n    /* INTERNAL */\r\n\r\n    /** @type {boolean} */\r\n    this.mPointerInside = false;\r\n  }\r\n}\r\n","\r\nclass FPSComponent extends Component  {\r\n  constructor() {\r\n    super();\r\n\r\n    /** @type {TextField} */\r\n    this.txtFPS = null;\r\n  }\r\n\r\n  onAdded(){\r\n    this.txtFPS = new TextField('FPS: 0');\r\n    this.txtFPS.x = 0;\r\n    this.txtFPS.y = 0;\r\n    this.gameObject.addChild(this.txtFPS);\r\n  }\r\n\r\n  onRemoved(){\r\n  }\r\n\r\n  onUpdate(){\r\n    this.txtFPS.text = 'FPS: ' + Black.instance.FPS;\r\n  }\r\n}\r\n","\r\nclass MRComponent extends Component {\r\n\r\n  /**\r\n   * constructor - Description\r\n   *\r\n   * @param {number} [width=960]  Description\r\n   * @param {number} [height=640] Description\r\n   */\r\n  constructor(width = 960, height = 640) {\r\n    super();\r\n\r\n    /** @type {number} */\r\n    this.mWidth = width;\r\n\r\n    /** @type {number} */\r\n    this.mHeight = height;\r\n\r\n    /** @type {number} */\r\n    this.mScale = 0;\r\n\r\n    /** @type {number} */\r\n    this.mInvScale = 0;\r\n\r\n    /** @type {number} */\r\n    this.mAspect = 0;\r\n\r\n    Black.instance.viewport.on('resize', this.__onResize, this);\r\n  }\r\n\r\n  __onResize(msg, rect) {\r\n    this.setSize(this.mWidth, this.mHeight);\r\n  }\r\n\r\n  /**\r\n   * setSize - description\r\n   *\r\n   * @param  {number} width = 960  description\r\n   * @param  {number} height = 640 description\r\n   * @return {void}              description\r\n   */\r\n  setSize(width = 960, height = 640){\r\n    this.mWidth = width;\r\n    this.mHeight = height;\r\n\r\n    this.updateLayout();\r\n  }\r\n\r\n  /**\r\n   * updateLayout - description\r\n   *\r\n   * @return {void}  description\r\n   */\r\n  updateLayout() {\r\n    if (!this.gameObject)\r\n      return;\r\n\r\n    /** @type {Rectangle} */\r\n    let size = Black.instance.viewport.size;\r\n\r\n    /** @type {number} */\r\n    let scaleX = size.width / this.mWidth;\r\n\r\n    /** @type {number} */\r\n    let scaleY = size.height / this.mHeight;\r\n\r\n    this.mScale = Math.min(scaleX, scaleY);\r\n    this.mInvScale = 1 / this.mScale;\r\n\r\n    this.gameObject.scaleX = this.gameObject.scaleY = this.mScale;\r\n    this.gameObject.x = (size.width / 2) - (this.mWidth / 2) * this.mScale;\r\n    this.gameObject.y = (size.height / 2) - (this.mHeight / 2) * this.mScale;\r\n  }\r\n\r\n  onAdded(){\r\n    this.updateLayout();\r\n  }\r\n\r\n  onRemoved(){\r\n  }\r\n\r\n  onUpdate(){\r\n  }\r\n}\r\n","\r\nclass Ease {\r\n  constructor() {}\r\n\r\n  /**\r\n   * linear - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static linear(k) {\r\n    return k;\r\n  }\r\n\r\n  /**\r\n   * quadraticIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quadraticIn(k) {\r\n    return k * k;\r\n  }\r\n\r\n  /**\r\n   * quadraticOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quadraticOut(k) {\r\n    return k * (2 - k);\r\n  }\r\n\r\n  /**\r\n   * quadraticInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quadraticInOut(k) {\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * k * k;\r\n\r\n    return -0.5 * (--k * (k - 2) - 1);\r\n  }\r\n\r\n  /**\r\n   * cubicIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static cubicIn(k) {\r\n    return k * k * k;\r\n  }\r\n\r\n  /**\r\n   * cubicOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static cubicOut(k) {\r\n    return --k * k * k + 1;\r\n  }\r\n\r\n  /**\r\n   * cubicInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static cubicInOut(k) {\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * k * k * k;\r\n\r\n    return 0.5 * ((k -= 2) * k * k + 2);\r\n  }\r\n\r\n  /**\r\n   * quarticIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quarticIn(k) {\r\n    return k * k * k * k;\r\n  }\r\n\r\n  /**\r\n   * quarticOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quarticOut(k) {\r\n    return 1 - (--k * k * k * k);\r\n  }\r\n\r\n  /**\r\n   * quarticInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quarticInOut(k) {\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * k * k * k * k;\r\n\r\n    return -0.5 * ((k -= 2) * k * k * k - 2);\r\n  }\r\n\r\n  /**\r\n   * quinticIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quinticIn(k) {\r\n    return k * k * k * k * k;\r\n  }\r\n\r\n  /**\r\n   * quinticOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quinticOut(k) {\r\n    return --k * k * k * k * k + 1;\r\n  }\r\n\r\n  /**\r\n   * quinticInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static quinticInOut(k) {\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * k * k * k * k * k;\r\n\r\n    return 0.5 * ((k -= 2) * k * k * k * k + 2);\r\n  }\r\n\r\n  /**\r\n   * sinusoidalIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static sinusoidalIn(k) {\r\n    return 1 - Math.cos(k * Math.PI / 2);\r\n  }\r\n\r\n  /**\r\n   * sinusoidalOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static sinusoidalOut(k) {\r\n    return Math.sin(k * Math.PI / 2);\r\n  }\r\n\r\n  /**\r\n   * sinusoidalInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static sinusoidalInOut(k) {\r\n    return 0.5 * (1 - Math.cos(Math.PI * k));\r\n  }\r\n\r\n  /**\r\n   * exponentialIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static exponentialIn(k) {\r\n    return k === 0 ? 0 : Math.pow(1024, k - 1);\r\n  }\r\n\r\n  /**\r\n   * exponentialOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static exponentialOut(k) {\r\n    return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);\r\n  }\r\n\r\n  /**\r\n   * exponentialInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static exponentialInOut(k) {\r\n    if (k === 0)\r\n      return 0;\r\n\r\n    if (k === 1)\r\n      return 1;\r\n\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * Math.pow(1024, k - 1);\r\n\r\n    return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);\r\n  }\r\n\r\n  /**\r\n   * circularIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static circularIn(k) {\r\n    return 1 - Math.sqrt(1 - k * k);\r\n  }\r\n\r\n  /**\r\n   * circularOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static circularOut(k) {\r\n    return Math.sqrt(1 - (--k * k));\r\n  }\r\n\r\n  /**\r\n   * circularInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static circularInOut(k) {\r\n    if ((k *= 2) < 1)\r\n      return -0.5 * (Math.sqrt(1 - k * k) - 1);\r\n\r\n    return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);\r\n  }\r\n\r\n  /**\r\n   * elasticIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static elasticIn(k) {\r\n    if (k === 0)\r\n      return 0;\r\n\r\n    if (k === 1)\r\n      return 1;\r\n\r\n    return -Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n  }\r\n\r\n  /**\r\n   * elasticOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static elasticOut(k) {\r\n    if (k === 0)\r\n      return 0;\r\n\r\n    if (k === 1)\r\n      return 1;\r\n\r\n    return Math.pow(2, -10 * k) * Math.sin((k - 0.1) * 5 * Math.PI) + 1;\r\n  }\r\n\r\n  /**\r\n   * elasticInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static elasticInOut(k) {\r\n    if (k === 0)\r\n      return 0;\r\n\r\n    if (k === 1)\r\n      return 1;\r\n\r\n    k *= 2;\r\n\r\n    if (k < 1)\r\n      return -0.5 * Math.pow(2, 10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI);\r\n\r\n    return 0.5 * Math.pow(2, -10 * (k - 1)) * Math.sin((k - 1.1) * 5 * Math.PI) + 1;\r\n\r\n  }\r\n\r\n  /**\r\n   * backIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static backIn(k) {\r\n    const s = 1.70158;\r\n    return k * k * ((s + 1) * k - s);\r\n  }\r\n\r\n  /**\r\n   * backOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static backOut(k) {\r\n    const s = 1.70158;\r\n    return --k * k * ((s + 1) * k + s) + 1;\r\n  }\r\n\r\n  /**\r\n   * backInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static backInOut(k) {\r\n    const s = 1.70158 * 1.525;\r\n\r\n    if ((k *= 2) < 1)\r\n      return 0.5 * (k * k * ((s + 1) * k - s));\r\n\r\n    return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);\r\n  }\r\n\r\n  /**\r\n   * bounceIn - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static bounceIn(k) {\r\n    return 1 - Ease.bounceOut(1 - k);\r\n  }\r\n\r\n  /**\r\n   * bounceOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static bounceOut(k) {\r\n    if (k < (1 / 2.75))\r\n      return 7.5625 * k * k;\r\n    else if (k < (2 / 2.75))\r\n      return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;\r\n    else if (k < (2.5 / 2.75))\r\n      return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;\r\n\r\n    return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;\r\n  }\r\n\r\n  /**\r\n   * bounceInOut - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static bounceInOut(k) {\r\n    if (k < 0.5)\r\n      return Ease.bounceIn(k * 2) * 0.5;\r\n\r\n    return Ease.bounceOut(k * 2 - 1) * 0.5 + 0.5;\r\n  }\r\n\r\n  /**\r\n   * smoothstep - Description\r\n   *\r\n   * @param {number} k Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  static smootherStep(k) {\r\n    return k * k * k * (k * (6.0 * k - 15.0) + 10.0);\r\n  }\r\n}\r\n","\r\nclass Interpolation {\r\n  constructor() {}\r\n\r\n  /**\r\n   * linear - Description\r\n   *\r\n   * @param {Array} v - The input array of values to interpolate between.\r\n   *\r\n   * @param {number} k - The percentage of interpolation, between 0 and 1.\r\n   *\r\n   * @return {number} The interpolated value\r\n   */\r\n  static linear(v, k) {\r\n    let m = v.length - 1;\r\n    let f = m * k;\r\n    let i = Math.floor(f);\r\n\r\n    let fn = (p0, p1, t) => {\r\n      return (p1 - p0) * t + p0;\r\n    };\r\n\r\n    if (k < 0) {\r\n      return fn(v[0], v[1], f);\r\n    }\r\n\r\n    if (k > 1) {\r\n      return fn(v[m], v[m - 1], m - f);\r\n    }\r\n\r\n    return fn(v[i], v[i + 1 > m ? m : i + 1], f - i);\r\n  }\r\n\r\n  /**\r\n   * bezier - Description\r\n   *\r\n   * @param {Array} v - The input array of values to interpolate between.\r\n   *\r\n   * @param {number} k - The percentage of interpolation, between 0 and 1.\r\n   *\r\n   * @return {number} The interpolated value\r\n   */\r\n  static bezier(v, k) {\r\n    let b = 0;\r\n    let n = v.length;\r\n    let pow = Math.pow;\r\n    // Bernstein basis polynomials\r\n    let bn = (n, i) => {\r\n      let fc = Interpolation.__factorial;\r\n      return fc(n) / fc(i) / fc(n - i);\r\n    };\r\n\r\n    for (let i = 0; i < n; i++) {\r\n      b += pow(1 - k, n - i) * pow(k, i) * v[i] * bn(n, i);\r\n    }\r\n\r\n    return b;\r\n  }\r\n\r\n  /**\r\n   * catmullRom - Description\r\n   *\r\n   * @param {Array} v - The input array of values to interpolate between.\r\n   *\r\n   * @param {number} k - The percentage of interpolation, between 0 and 1.\r\n   *\r\n   * @return {number} The interpolated value\r\n   */\r\n  static catmullRom(v, k) {\r\n    let m = v.length - 1;\r\n    let f = m * k;\r\n    let i = Math.floor(f);\r\n    let fn = (p0, p1, p2, p3, t) => {\r\n      let v0 = (p2 - p0) * 0.5;\r\n      let v1 = (p3 - p1) * 0.5;\r\n      let t2 = t * t;\r\n      let t3 = t * t2;\r\n\r\n      return ((p1 - p2) * 2 + v0 + v1) * t3 + ((p2 - p1) * 3 - 2 * v0 - v1) * t2 + v0 * t + p1;\r\n    };\r\n\r\n    if (v[0] === v[m]) {\r\n      if (k < 0) {\r\n        i = Math.floor(f = m * (1 + k));\r\n      }\r\n\r\n      return fn(v[(i - 1 + m) % m], v[i], v[(i + 1) % m], v[(i + 2) % m], f - i);\r\n    } else {\r\n      if (k < 0) {\r\n        return v[0] - (fn(v[0], v[0], v[1], v[1], -f) - v[0]);\r\n      }\r\n\r\n      if (k > 1) {\r\n        return v[m] - (fn(v[m], v[m], v[m - 1], v[m - 1], f - m) - v[m]);\r\n      }\r\n\r\n      return fn(v[i ? i - 1 : 0], v[i], v[m < i + 1 ? m : i + 1], v[m < i + 2 ? m : i + 2], f - i);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * __factorial\r\n *\r\n * @param {number} n\r\n *\r\n * @return {number}\r\n */\r\nInterpolation.__factorial = (function() {\r\n  let a = [1];\r\n\r\n  return function(n) {\r\n    if (a[n]) {\r\n      return a[n];\r\n    }\r\n\r\n    let s = n;\r\n\r\n    while (--n) {\r\n      s *= n;\r\n    }\r\n\r\n    a[n] = s;\r\n    return s;\r\n  };\r\n})();\r\n","/**\r\n * Tween\r\n * @unrestricted\r\n * @extends Component\r\n */\r\n\r\nclass Tween extends Component {\r\n  /**\r\n   * constructor - Description\r\n   * @param {Object}   values            Description\r\n   * @param {number} [duration=0.25]   Description\r\n   * @param {Object|null}   [properties=null] Description\r\n   */\r\n  constructor(values, duration = 0.250, properties = null) {\r\n    super();\r\n\r\n    /** @dict */\r\n    this.mValues = values;\r\n\r\n    /** @type {number} */\r\n    this.mDuration = duration;\r\n\r\n    /** @dict */\r\n    this.mProperties = properties;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsPlaying = false;\r\n\r\n    /** @type {boolean} */\r\n    this.mIsPaused = false;\r\n\r\n    /** @type {number} */\r\n    this.mStartTime = 0;\r\n\r\n    /** @type {number} */\r\n    this.mPausedTime = 0;\r\n\r\n    /** @dict */\r\n    this.mValuesStart = {};\r\n\r\n    /** @type {number} */\r\n    this.mElapsed = 0;\r\n\r\n    /** @type {function (v:?Array, e:number):number} */\r\n    this.mInterpolation = Interpolation.linear;\r\n\r\n    /** @type {number} */\r\n    this.mDelay = 0;\r\n\r\n    /** @type {number} */\r\n    this.mRepeatTimes = 0;\r\n\r\n    /** @type {boolean} */\r\n    this.mInitiated = false;\r\n\r\n    /** @type {boolean} */\r\n    this.mStarted = false;\r\n\r\n    /** @type {boolean} */\r\n    this.mReverse = false;\r\n\r\n    /** @type {boolean} */\r\n    this.mRemoveOnComplete = true;\r\n\r\n    /** @type {boolean} */\r\n    this.mPlayOnAdded = true;\r\n\r\n   /** @type {function(e:number):number} */\r\n    this.mEase = Ease.smootherStep;\r\n\r\n    if (this.mProperties !== null) {\r\n      for (let f in this.mProperties) {\r\n        this[f] = /** @dict */ (this.mProperties[f]);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ease - Description\r\n   *\r\n   * @return {function(e:number):number} Description\r\n   */\r\n  get ease() {\r\n    return this.mEase;\r\n  }\r\n\r\n  /**\r\n   * ease - Description\r\n   *\r\n   * @param {function(e:number):number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set ease(value) {\r\n    this.mEase = value;\r\n  }\r\n\r\n  /**\r\n   * interpolation - Description\r\n   *\r\n   * @return {function(p:Array, v:number):number} Description\r\n   */\r\n  get interpolation() {\r\n    return this.mInterpolation;\r\n  }\r\n\r\n  /**\r\n   * interpolation - Description\r\n   *\r\n   * @param {function(p:Array, v:number):number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set interpolation(value) {\r\n    this.mInterpolation = value;\r\n  }\r\n\r\n  /**\r\n   * elapsed - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get elapsed() {\r\n    return this.mElapsed;\r\n  }\r\n\r\n  /**\r\n   * delay - Description\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get delay() {\r\n    return this.mDelay;\r\n  }\r\n\r\n  /**\r\n   * delay - Description\r\n   *\r\n   * @param {number} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set delay(value) {\r\n    this.mDelay = value;\r\n  }\r\n\r\n  /**\r\n   * removeOnComplete - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get removeOnComplete() {\r\n    return this.mRemoveOnComplete;\r\n  }\r\n\r\n  /**\r\n   * removeOnComplete - Description\r\n   *\r\n   * @param {boolean} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set removeOnComplete(value) {\r\n    this.mRemoveOnComplete = value;\r\n  }\r\n\r\n  /**\r\n   * playOnAdded - Description\r\n   *\r\n   * @return {boolean} Description\r\n   */\r\n  get playOnAdded() {\r\n    return this.mPlayOnAdded;\r\n  }\r\n\r\n  /**\r\n   * playOnAdded - Description\r\n   *\r\n   * @param {boolean} value Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set playOnAdded(value) {\r\n    this.mPlayOnAdded = value;\r\n  }\r\n\r\n\r\n  /**\r\n   * __start - Description\r\n   *\r\n   * @param {number} t Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __start(t) {\r\n    this.mIsPlaying = true;\r\n    this.mStartTime = t + this.mDelay;\r\n  }\r\n\r\n  /**\r\n   * play - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  play() {\r\n    if (!this.mIsPaused) {\r\n      this.__start(Black.instance.uptime);\r\n    } else {\r\n      this.__resume();\r\n    }\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * stop - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  stop() {\r\n    if (!this.mIsPlaying)\r\n      return this;\r\n\r\n    this.mIsPlaying = false;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * to - Description\r\n   *\r\n   * @param {Object} values - Description\r\n   * @param {number} duration - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  to(values = {}, duration = 0.250) {\r\n    this.mValues = values;\r\n\r\n    this.mDuration = duration;\r\n\r\n    this.mInitiated = false;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * pause - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  pause() {\r\n    if (!this.mIsPlaying)\r\n      return this;\r\n\r\n    this.mIsPaused = true;\r\n    this.mPausedTime = Black.instance.uptime;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * __resume - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __resume() {\r\n    if (!this.mIsPaused)\r\n      return;\r\n\r\n    this.mIsPaused = false;\r\n    this.mStartTime += Black.instance.uptime - this.mPausedTime;\r\n  }\r\n\r\n\r\n  /**\r\n   * @return {void}\r\n   */\r\n  remove() {\r\n    if (this.mIsPlaying)\r\n      this.stop();\r\n\r\n    this.gameObject.removeComponent(this);\r\n  }\r\n\r\n  /**\r\n   * dispose - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  dispose() {\r\n    this.remove();\r\n  }\r\n\r\n  /**\r\n   * repeat - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  repeat(times) {\r\n    this.mRepeatTimes = times;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * loop - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  loop(value = true) {\r\n    this.mRepeatTimes = value ? Infinity : 0;\r\n\r\n    return this;\r\n  }\r\n\r\n   /**\r\n   * reverse - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  reverse(value = true) {\r\n    this.mReverse = value;\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * chain - Description\r\n   *\r\n   * @return {Tween} Description\r\n   */\r\n  chain(tween) {\r\n    if (!tween) {\r\n      return this;\r\n    }\r\n\r\n    this.mRemoveOnComplete = false;\r\n\r\n    this.on('complete', () => {\r\n      tween.play();\r\n    });\r\n\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * onAdded - description\r\n   *\r\n   * @override\r\n   * @param  {GameObject} gameObject description\r\n   * @return {void}            description\r\n   */\r\n  onAdded(gameObject) {\r\n    if (this.mPlayOnAdded) {\r\n      this.__start(Black.instance.uptime);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * __update - Description\r\n   *\r\n   * @param {number} t Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __update(t) {\r\n    if (t < this.mStartTime || !this.mIsPlaying || this.mIsPaused)\r\n      return;\r\n\r\n    // copy values only when starting tween...\r\n    // since values may change\r\n    if (this.mStarted === false) {\r\n      this.mStarted = true;\r\n      this.post('start', this.gameObject);\r\n\r\n      for (let f in this.mValues) {\r\n        if (!this.mInitiated && Array.isArray(this.mValues[f])) {\r\n          this.mValues[f] = [this.gameObject[f]].concat(this.mValues[f]);\r\n        }\r\n        this.mValuesStart[f] = parseFloat(this.gameObject[f]);\r\n      }\r\n\r\n      this.mInitiated = true;\r\n    }\r\n\r\n    this.mElapsed = (t - this.mStartTime) / this.mDuration;\r\n\r\n    if (this.mElapsed > 1)\r\n      this.mElapsed = 1;\r\n\r\n    let value = this.mEase(this.mElapsed);\r\n\r\n    for (let f in this.mValues) {\r\n      let start = /** @type {number} */ (this.mValuesStart[f]);\r\n      let end = /** @type {number|Array} */ (this.mValues[f]);\r\n\r\n      if (Array.isArray(end)) {\r\n        this.gameObject[f] = this.mInterpolation(end, value);\r\n      } else {\r\n        this.gameObject[f] = /** @type {number} */ (start + (end - start) * value);\r\n      }\r\n    }\r\n\r\n    this.post('update', this.gameObject);\r\n\r\n    if (this.mElapsed === 1) {\r\n      if (this.mRepeatTimes > 0) {\r\n        this.mRepeatTimes -= 1;\r\n\r\n        if (this.mReverse) {\r\n          for (let f in this.mValues) {\r\n            [this.mValues[f], this.mValuesStart[f]] = [this.mValuesStart[f], this.mValues[f]];\r\n          }\r\n        }\r\n\r\n        this.mStartTime = t + this.mDelay;\r\n\r\n        this.post('loop', this.gameObject);\r\n      } else {\r\n        this.mIsPlaying = false;\r\n        this.post('complete', this.gameObject);\r\n\r\n        if (this.mRemoveOnComplete) {\r\n          this.dispose();\r\n        } else {\r\n          for (let f in this.mValues) {\r\n            this.mValuesStart[f] = this.mValues[f];\r\n          }\r\n\r\n          this.mStarted = false;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n   * set - Description\r\n   *\r\n   * @param {Object} values Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  set(values) {\r\n    this.mValues = values;\r\n\r\n    for (let f in this.mValues)\r\n      this.mValuesStart[f] = parseFloat(this.gameObject[f]);\r\n  }\r\n\r\n  onPostUpdate(dt){\r\n    let t = Black.instance.uptime;\r\n    this.__update(t);\r\n  }\r\n}\r\n","\r\nclass Animation {\r\n  /**\r\n   * Creates an instance of Animation class\r\n   *\r\n   * @param {AnimationController}    controller  Animation controller\r\n   * @param {string}                 name        The name of animation\r\n   * @param {Array<Texture>}         frames      Array of Textures for this animation\r\n   * @param {number}                 [fps=14]    Frame rate\r\n   * @param {boolean}                [loop=true] Is animations should be looped\r\n   */\r\n  constructor(controller, name, frames, fps = 14, loop = true) {\r\n    Debug.assert(fps > 0, 'FPS must be greater than 0.');\r\n\r\n    /**\r\n     * @private\r\n     * @type {AnimationController}\r\n     */\r\n    this.mController = controller;\r\n\r\n    /**\r\n     * @private\r\n     * @type {string}\r\n     */\r\n    this.mName = name;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array<Texture>}\r\n     */\r\n    this.mFrames = frames;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mCurrentFrame = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mNextFrameAt = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mFPS = fps;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mFrameDuration = 1 / this.mFPS;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mLoop = loop;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mPaused = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mElapsed = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mStopped = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mCompleted = false;\r\n  }\r\n\r\n  /**\r\n   * Plays animation. If Animation is completed, current frame is reset to 0.\r\n   * @return {Texture}\r\n   */\r\n  play() {\r\n    if (this.mCompleted === true) {\r\n      this.mCurrentFrame = 0;\r\n      this.mElapsed = 0;\r\n    }\r\n\r\n    this.mPaused = false;\r\n    this.mStopped = false;\r\n    this.mCompleted = false;\r\n\r\n    this.mNextFrameAt = Black.instance.uptime + this.mFrameDuration - this.mElapsed;\r\n    this.mElapsed = 0;\r\n\r\n    return this.mFrames[this.mCurrentFrame];\r\n  }\r\n\r\n  /**\r\n   * Stops animation and resets the value of current frame.\r\n   * @return {void}\r\n   */\r\n  stop() {\r\n    this.mStopped = true;\r\n    this.mCurrentFrame = 0;\r\n  }\r\n\r\n  /**\r\n   * Pauses animation.\r\n   * @return {void}\r\n   */\r\n  pause() {\r\n    this.mPaused = true;\r\n    this.mElapsed = this.mNextFrameAt - Black.instance.uptime;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {number} dt\r\n   * @param {number} t\r\n   *\r\n   * @return {Texture|null}\r\n   */\r\n  __update(dt, t) {\r\n    if (t < this.mNextFrameAt || this.mPaused === true || this.mStopped === true || this.mCompleted === true)\r\n      return null;\r\n\r\n    this.mCurrentFrame++;\r\n\r\n    if (this.mCurrentFrame >= this.mFrames.length) {\r\n      if (this.mLoop === true) {\r\n        this.mCurrentFrame = 0;\r\n      } else {\r\n        this.mCurrentFrame = this.mFrames.length - 1;\r\n        this.mController.post('complete', this);\r\n        this.mCompleted = true;\r\n        return null;\r\n      }\r\n    }\r\n\r\n    this.mNextFrameAt = Black.instance.uptime + this.mFrameDuration;\r\n    let texture = this.mFrames[this.mCurrentFrame];\r\n    return texture;\r\n  }\r\n\r\n  /**\r\n   * Gets/Sets annimation speed in Frames per Second\r\n   *\r\n   * @return {number} Description\r\n   */\r\n  get fps() {\r\n    return this.mFPS;\r\n  }\r\n\r\n  /**\r\n   * Gets/Sets annimation speed in Frames per Second\r\n   * @param {number} value\r\n   * @return {void}\r\n   */\r\n  set fps(value) {\r\n    Debug.assert(value > 0, 'FPS must be greater than 0.');\r\n\r\n    this.mFPS = value;\r\n    this.mFrameDuration = 1 / this.mFPS;\r\n\r\n    // update next frame start time\r\n    let diff = this.mNextFrameAt - Black.instance.uptime;\r\n    this.mNextFrameAt += diff;\r\n  }\r\n\r\n  /**\r\n   * Gets/Sets loop flag. If true, animation will be looping (starting over after finishing)\r\n   * @return {boolean}\r\n   */\r\n  get loop() {\r\n    return this.mLoop;\r\n  }\r\n\r\n  /**\r\n   * Gets/Sets loop flag. If true, animation will be looping (starting over after finishing)\r\n   * @param {boolean} value\r\n   * @return {void}\r\n   */\r\n  set loop(value) {\r\n    this.mLoop = value;\r\n  }\r\n\r\n  /**\r\n   * Gets array of Texture.\r\n   * @return {Array<Texture>}\r\n   */\r\n  get frames() {\r\n    return this.mFrames;\r\n  }\r\n\r\n  /**\r\n   * Returns true if Animation is playing (neither stopped nor paused).\r\n   * @return {boolean}\r\n   */\r\n  get isPlaying() {\r\n    return this.mPaused === false && this.mStopped === false;\r\n  }\r\n\r\n  /**\r\n   * Returns true if animation is completed.\r\n   * @return {boolean}\r\n   */\r\n  get isComplete() {\r\n    return this.mCompleted;\r\n  }\r\n\r\n\r\n  /**\r\n   * Returns name of this animation.\r\n   * @return {string}\r\n   */\r\n  get name() {\r\n    return this.mName;\r\n  }\r\n}\r\n","\r\nclass AnimationController extends Component {\r\n  /**\r\n   * Creates an instance of AnimationController\r\n   */\r\n  constructor() {\r\n    super();\r\n\r\n    /**\r\n     * @private\r\n     * @type {Object<string, Animation>}\r\n     */\r\n    this.mAnimations = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {Animation|null}\r\n     */\r\n    this.mCurrentAnim = null;\r\n  }\r\n\r\n\r\n  /**\r\n   * Returns the Animation object that exists with the specified name.\r\n   *\r\n   * @param {string} name The name of the child to return.\r\n   *\r\n   * @returns {Animation} Returns the Animation object that exists with the specified name.\r\n   */\r\n  getAnimation(name){\r\n    Debug.assert(name !== null, 'Animation must be set first.');\r\n    Debug.assert(this.mAnimations.hasOwnProperty(name), 'Animation must be set first.');\r\n\r\n    return this.mAnimations[name];\r\n  }\r\n\r\n\r\n  /**\r\n   * Updates the Animation object with new values.\r\n   *\r\n   * @param {string}          name        The name of animation to update\r\n   * @param {Array<Texture>}  textures    Description\r\n   * @param {number}          [fps=14]    Description\r\n   * @param {boolean}         [loop=true] Description\r\n   *\r\n   * @return {Animation} Description\r\n   */\r\n  updateAnimation(name, textures, fps = 14, loop = true) {\r\n    Debug.assert(textures.length > 0, 'Animation cannot be empty.');\r\n    Debug.assert(fps > 0, 'FPS must be greater than 0.');\r\n\r\n    let anim = new Animation(this, name, textures, fps, loop);\r\n    this.mAnimations[name] = anim;\r\n\r\n    return anim;\r\n  }\r\n\r\n\r\n  /**\r\n   * play - Description\r\n   *\r\n   * @param {string} name Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  play(name) {\r\n    Debug.assert(this.mAnimations.hasOwnProperty(name), 'Animation must be set first.');\r\n\r\n    this.mCurrentAnim = this.mAnimations[name];\r\n\r\n    let texture = this.mCurrentAnim.play();\r\n\r\n    let sprite = /** @type {Sprite} */ (this.gameObject);\r\n    if (sprite === null)\r\n      return;\r\n\r\n    if (texture !== null)\r\n      sprite.texture = texture;\r\n  }\r\n\r\n\r\n  /**\r\n   * stop - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  stop() {\r\n    if (this.mCurrentAnim === null)\r\n      return;\r\n\r\n    this.mCurrentAnim.stop();\r\n  }\r\n\r\n\r\n  /**\r\n   * pause - Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  pause() {\r\n    if (this.mCurrentAnim === null)\r\n      return;\r\n\r\n    this.mCurrentAnim.pause();\r\n  }\r\n\r\n\r\n  /**\r\n   * onPostUpdate - Description\r\n   *\r\n   * @override\r\n   * @param {number} dt Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  onPostUpdate(dt) {\r\n    if (this.mCurrentAnim === null)\r\n      return;\r\n\r\n    // TODO: replace with time.time\r\n    let newTexture = this.mCurrentAnim.__update(dt, Black.instance.uptime);\r\n    if (newTexture === null)\r\n      return;\r\n\r\n    let sprite = /** @type {Sprite} */ (this.gameObject);\r\n    sprite.texture = newTexture;\r\n  }\r\n\r\n\r\n  /**\r\n   * currentAnimation\r\n   *\r\n   * @return {Animation|null}\r\n   */\r\n  get currentAnimation() {\r\n    return this.mCurrentAnim;\r\n  }\r\n}\r\n","//.########::'##::::::::::'###:::::'######::'##:::'##:\r\n// ##.... ##: ##:::::::::'## ##:::'##... ##: ##::'##::\r\n// ##:::: ##: ##::::::::'##:. ##:: ##:::..:: ##:'##:::\r\n// ########:: ##:::::::'##:::. ##: ##::::::: #####::::\r\n// ##.... ##: ##::::::: #########: ##::::::: ##. ##:::\r\n// ##:::: ##: ##::::::: ##.... ##: ##::: ##: ##:. ##::\r\n// ########:: ########: ##:::: ##:. ######:: ##::. ##:\r\n//........:::........::..:::::..:::......:::..::::..::\r\n\r\n\r\nclass Black extends MessageDispatcher {\r\n\r\n  /**\r\n   * constructor\r\n   * @param {string}   containerElementId\r\n   * @param {function(new: GameObject)}   rootClass\r\n   * @param {function(new: VideoNullDriver)} [videoDriverClass]\r\n   */\r\n  constructor(containerElementId, rootClass, videoDriverClass) {\r\n    super();\r\n\r\n    // Dirty GCC workaround\r\n    window['Black'] = {};\r\n    window['Black']['instance'] = this;\r\n\r\n    console.log('%c ~Black ', 'background: #000; color: #fff;');\r\n\r\n    /**\r\n     * @private\r\n     * @type {string}\r\n     */\r\n    this.mContainerElementId = containerElementId;\r\n\r\n    /**\r\n     * @private\r\n     * @type {HTMLElement}\r\n     */\r\n    this.mContainerElement = /** @type {!HTMLElement} */ (document.getElementById(this.mContainerElementId));\r\n\r\n    if (!this.mContainerElement)\r\n      throw new Error('Container element was not found');\r\n\r\n    /**\r\n     * @private\r\n     * @type {function(new: VideoNullDriver)}\r\n     */\r\n    this.mVideoDriverClass = videoDriverClass;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mStageWidth = this.mContainerElement.clientWidth;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mStageHeight = this.mContainerElement.clientHeight;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mSimulationTimestep = 1000 / 60;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mUptime = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mFrameAccum = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mLastFrameTimeMs = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mCurrentTime = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mFPS = 60;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mLastFpsUpdate = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mFramesThisSecond = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mNumUpdateSteps = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mMinFrameDelay = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Array<System>}\r\n     */\r\n    this.mSystems = [];\r\n\r\n    /**\r\n     * @private\r\n     * @type {Rectangle}\r\n     */\r\n    this.mBounds = new Rectangle();\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mIsRunning = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mIsStarted = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mIsPanic = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mLastFrameUpdateTime = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mLastFrameRenderTime = 0;\r\n\r\n    /**\r\n     * @private\r\n     * @type {number}\r\n     */\r\n    this.mRAFHandle = -1; // not sure\r\n\r\n    /**\r\n     * @private\r\n     * @type {Viewport}\r\n     */\r\n    this.mViewport = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {VideoNullDriver}\r\n     */\r\n    this.mVideo = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mPaused = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mUnpausing = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mPauseOnHide = true;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mPauseOnBlur = true;\r\n\r\n    /**\r\n     * @private\r\n     * @type {Object<string, Array>}\r\n     */\r\n    this.mTagCache = {};\r\n\r\n    /**\r\n     * @private\r\n     * @type {function(new: GameObject)|null}\r\n     */\r\n    this.mRootClass = rootClass;\r\n\r\n    /**\r\n     * @private\r\n     * @type {GameObject|null}\r\n     */\r\n    this.mRoot = null;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mEnableFixedTimeStep = false;\r\n\r\n    /**\r\n     * @private\r\n     * @type {boolean}\r\n     */\r\n    this.mWasStopped = false;\r\n  }\r\n\r\n  /**\r\n   * pause - Pauses all engine update logic. Note: RAF is not going to be paused and will work in background.\r\n   *\r\n   * @return {void}\r\n   */\r\n  pause() {\r\n    this.mPaused = true;\r\n  }\r\n\r\n  /**\r\n   * resume - Resumes update execution.\r\n   *\r\n   * @return {void}\r\n   */\r\n  resume() {\r\n    this.mUnpausing = true;\r\n  }\r\n\r\n  __bootViewport() {\r\n    this.mViewport = new Viewport(this.mContainerElement);\r\n  }\r\n\r\n  __bootSystems() {\r\n    this.addSystem(new Input());\r\n  }\r\n\r\n  __bootStage() {\r\n    window.onblur = event => this.__onVisbilityChange(event);\r\n    window.onfocus = event => this.__onVisbilityChange(event);\r\n    window.onpagehide = event => this.__onVisbilityChange(event);\r\n    window.onpageshow = event => this.__onVisbilityChange(event);\r\n\r\n    if (document.hidden && this.mPauseOnHide === true)\r\n      this.mPaused = true;\r\n  }\r\n\r\n  __onVisbilityChange(event) {\r\n    let type = event.type;\r\n\r\n    if (type === 'blur' && this.mPauseOnBlur === true)\r\n      this.mPaused = true;\r\n    else if (type === 'pagehide' && this.mPauseOnHide === true)\r\n      this.mPaused = true;\r\n    else if (type === 'focus' || type === 'pageshow') {\r\n      if (document.hidden === false)\r\n        this.mUnpausing = true;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * addSystem - Adds a given system to the system list.\r\n   *\r\n   * @param  {System} system\r\n   * @return {System}\r\n   */\r\n  addSystem(system) {\r\n    this.mSystems.push(system);\r\n    return system;\r\n  }\r\n\r\n  /**\r\n   * removeSystem - Removes the given system to the system list.\r\n   *\r\n   * @param {System} system\r\n   *\r\n   * @return {System|null}\r\n   */\r\n  removeSystem(system) {\r\n    // TODO: remove system on next frame\r\n    var ix = this.mSystems.indexOf(system);\r\n    if (ix === -1)\r\n      return null;\r\n\r\n    this.mSystems.splice(ix, 1);\r\n    return system;\r\n  }\r\n\r\n  __bootVideo() {\r\n    this.mVideo = new this.mVideoDriverClass(this.mContainerElement, this.mStageWidth, this.mStageHeight);\r\n  }\r\n\r\n\r\n  /**\r\n   * start - Main method to make magic happen.\r\n   *\r\n   * @return {void}\r\n   */\r\n  start() {\r\n    if (this.mWasStopped === true) {\r\n      Debug.error('Black engine cannot be re-started.');\r\n      return;\r\n    }\r\n\r\n    this.constructor.instance = this;\r\n\r\n    if (this.mIsStarted === true)\r\n      return;\r\n\r\n    this.__bootViewport();\r\n    this.__bootSystems();\r\n    this.__bootVideo();\r\n    this.__bootStage();\r\n\r\n    this.mRoot = new this.mRootClass();\r\n    this.mRoot.name = 'root';\r\n    this.mRoot.mAdded = true; // why are not added actually?\r\n    this.mRoot.onAdded();\r\n\r\n    const self = this;\r\n\r\n    this.mIsStarted = true;\r\n    this.mVideo.start();\r\n\r\n    this.mRAFHandle = requestAnimationFrame(function(timestamp) {\r\n      // TODO: do first update here\r\n      self.mIsRunning = true;\r\n\r\n      self.mLastFrameTimeMs = timestamp;\r\n      self.mLastFpsUpdate = timestamp;\r\n      self.mFramesThisSecond = 0;\r\n\r\n      // Start the main loop.\r\n      self.mRAFHandle = requestAnimationFrame((x) => {\r\n        self.__update(x);\r\n      });\r\n    });\r\n\r\n    // TODO: show only when needed, eg required by any system\r\n    if (this.mEnableFixedTimeStep === false)\r\n      Debug.warn('Fixed time-step is disabled, some systems may not work.');\r\n  }\r\n\r\n\r\n  /**\r\n   * stop - Stops execution, destroys resources and scene. Cannot be started again.\r\n   *\r\n   * @return {type} Description\r\n   */\r\n  stop() {\r\n    this.mIsStarted = false;\r\n    this.mIsRunning = false;\r\n    cancelAnimationFrame(this.mRAFHandle);\r\n  }\r\n\r\n  /**\r\n   * @param {number} timestamp Description\r\n   *\r\n   * @return {void} Description\r\n   */\r\n  __update(timestamp) {\r\n    // TODO: this method seems to be totaly broken. maxAllowedFPS is not working correctly\r\n    this.constructor.instance = this;\r\n\r\n    const self = this;\r\n\r\n    if (this.mPaused === true && this.mUnpausing === true) {\r\n      this.mUnpausing = this.mPaused = false;\r\n\r\n      this.mLastFrameTimeMs = 0;\r\n      this.mLastFpsUpdate = timestamp;\r\n      this.mLastFrameTimeMs = timestamp;\r\n      this.mCurrentTime = 0; // same as first update\r\n      this.mFrameAccum = 0;\r\n    }\r\n\r\n    if (timestamp < this.mLastFrameTimeMs + this.mMinFrameDelay) {\r\n      this.mRAFHandle = window.requestAnimationFrame(this.__update.bind(this));\r\n      return;\r\n    }\r\n\r\n    if (this.mPaused === false) {\r\n      this.mFrameAccum += (timestamp - this.mLastFrameTimeMs);\r\n      this.mLastFrameTimeMs = timestamp;\r\n\r\n      // BEGIN\r\n      if (timestamp > this.mLastFpsUpdate + 1000) {\r\n        this.mFPS = this.mFramesThisSecond;\r\n\r\n        this.mLastFpsUpdate = timestamp;\r\n        this.mFramesThisSecond = 0;\r\n      }\r\n      this.mFramesThisSecond++;\r\n\r\n      this.mNumUpdateSteps = 0;\r\n\r\n      // fix first update\r\n      if (this.mCurrentTime === 0)\r\n        this.mCurrentTime = timestamp - this.mMinFrameDelay;\r\n\r\n      const dt = Time.scale * ((timestamp - this.mCurrentTime) * 0.001);\r\n      this.mCurrentTime = timestamp;\r\n      Time.mDeltaTime = dt;\r\n\r\n      if (this.mEnableFixedTimeStep === true) {\r\n        while (this.mFrameAccum >= this.mSimulationTimestep) {\r\n          this.__internalFixedUpdate(this.mSimulationTimestep * 0.001);\r\n\r\n          this.mFrameAccum -= this.mSimulationTimestep;\r\n\r\n          if (++this.mNumUpdateSteps >= (60 * 3)) { // 3 seconds window\r\n            console.log('[BLACK]: Not enough time to calculate update logic.');\r\n            this.mIsPanic = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      this.__internalUpdate(dt);\r\n      this.__internalPostUpdate(dt);\r\n\r\n      this.mVideo.beginFrame();\r\n      this.mRoot.__render(this.mVideo, this.mUptime, 1, BlendMode.AUTO);\r\n      this.mVideo.endFrame();\r\n\r\n      // TODO: remove uptime\r\n      this.mUptime += dt;\r\n      Time.mTime = this.mUptime;\r\n\r\n      this.mIsPanic = false;\r\n    }\r\n\r\n    this.mRAFHandle = window.requestAnimationFrame(this.__update.bind(this));\r\n  }\r\n\r\n  /**\r\n   * @param {number} dt\r\n   * @return {void}\r\n   */\r\n  __internalFixedUpdate(dt) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onFixedUpdate(dt);\r\n\r\n    this.mRoot.__fixedUpdate(dt);\r\n  }\r\n\r\n  /**\r\n   * @param {number} dt\r\n   * @return {void}\r\n   */\r\n  __internalUpdate(dt) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onUpdate(dt, this.mUptime);\r\n\r\n    this.mRoot.__update(dt);\r\n  }\r\n\r\n  /**\r\n   * @param {number} dt\r\n   * @return {void}\r\n   */\r\n  __internalPostUpdate(dt) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onPostUpdate(dt, this.mUptime);\r\n\r\n    this.mRoot.__postUpdate(dt);\r\n  }\r\n\r\n  /**\r\n   * @return {Rectangle}\r\n   */\r\n  get bounds() {\r\n    return this.mBounds;\r\n  }\r\n\r\n  /**\r\n   * root - Returns the root GameObject.\r\n   * @return {GameObject}\r\n   */\r\n  get root() {\r\n    return this.mRoot;\r\n  }\r\n\r\n  /**\r\n   * video - Returns current video driver.\r\n   * @return {VideoNullDriver} Description\r\n   */\r\n  get video() {\r\n    return this.mVideo;\r\n  }\r\n\r\n  /**\r\n   * simulationTimestep - If `enableFixedTimeStep` is set to `true` returns number of milliseconds fixed-time-step will run over.\r\n   * @return {number}\r\n   */\r\n  get simulationTimestep() {\r\n    return this.mSimulationTimestep;\r\n  }\r\n\r\n\r\n  /**\r\n   * simulationTimestep - Sets the number of milliseconds for fixed-time-step to run over.\r\n   *\r\n   * @param {type} timestep\r\n   * @return {void}\r\n   */\r\n  set simulationTimestep(timestep) {\r\n    this.mSimulationTimestep = timestep;\r\n  }\r\n\r\n  /**\r\n   * FPS - Returns current frame rate\r\n   * @return {number}\r\n   */\r\n  get FPS() {\r\n    return this.mFPS;\r\n  }\r\n\r\n  /**\r\n   * maxAllowedFPS - Gets max amount updates engine can do in a second.\r\n   * @return {number}\r\n   */\r\n  get maxAllowedFPS() {\r\n    return 1000 / this.mMinFrameDelay;\r\n  }\r\n\r\n  /**\r\n   * maxAllowedFPS - Sets the number of update engine will do per second.\r\n   * @param {number} fps\r\n   * @return {void}\r\n   */\r\n  set maxAllowedFPS(fps) {\r\n    if (fps <= 0)\r\n      this.stop();\r\n    else\r\n      this.mMinFrameDelay = 1000 / fps;\r\n  }\r\n\r\n  /**\r\n   * viewport - Returns the current viewport instance. Used to get size of a game screen, or listen for resize messages.\r\n   * @return {Viewport}\r\n   */\r\n  get viewport() {\r\n    return this.mViewport;\r\n  }\r\n\r\n  /**\r\n   * containerElement - Retruns the HTML container element the engine runs in.\r\n   * @return {Element}\r\n   */\r\n  get containerElement() {\r\n    return this.mContainerElement;\r\n  }\r\n\r\n  /**\r\n   * uptime - Amounts of seconds since engine start.\r\n   * @return {number}\r\n   */\r\n  get uptime() {\r\n    return this.mUptime;\r\n  }\r\n\r\n  /**\r\n   * onTagUpdated\r\n   * @protected\r\n   * @param {GameObject} child\r\n   * @param {string|null} oldTag\r\n   * @param {string|null} newTag\r\n   *\r\n   * @return {void}\r\n   */\r\n  onTagUpdated(child, oldTag, newTag) {\r\n    if (oldTag !== null) {\r\n      let arr = this.mTagCache[oldTag];\r\n      arr.splice(arr.indexOf(child), 1);\r\n\r\n      if (arr.length === 0)\r\n        delete this.mTagCache[oldTag];\r\n    }\r\n\r\n    if (newTag !== null) {\r\n      if (this.mTagCache.hasOwnProperty(newTag) === false)\r\n        this.mTagCache[newTag] = [];\r\n\r\n      this.mTagCache[newTag].push(child);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param  {GameObject} child\r\n   * @return {void}\r\n   */\r\n  onChildrenAdded(child) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onChildrenAdded(child);\r\n\r\n    GameObject.forEach(child, (x) => {\r\n      if (x.mAdded === true)\r\n        return;\r\n\r\n      this.onTagUpdated(x, null, x.mTag);\r\n\r\n      x.mAdded = true;\r\n      x.onAdded();\r\n\r\n      for (let i = 0; i < x.mComponents.length; i++) {\r\n        let c = x.mComponents[i];\r\n\r\n        if (c.mAdded === true)\r\n          continue;\r\n\r\n        c.mAdded = true;\r\n        c.onAdded(x);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param  {GameObject} child\r\n   * @return {void}\r\n   */\r\n  onChildrenRemoved(child) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onChildrenRemoved(child);\r\n\r\n    GameObject.forEach(child, (x) => {\r\n      if (x.mAdded === true) {\r\n        this.onTagUpdated(x, x.mTag, null);\r\n\r\n        x.mAdded = false;\r\n        x.onRemoved();\r\n\r\n        for (let i = 0; i < x.mComponents.length; i++) {\r\n          let c = x.mComponents[i];\r\n\r\n          if (c.mAdded === false)\r\n            continue;\r\n\r\n          c.mAdded = false;\r\n          c.onRemoved(x);\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @protected\r\n   * @param  {GameObject} child\r\n   * @param  {Component} component\r\n   * @return {void}\r\n   */\r\n  onComponentAdded(child, component) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onComponentAdded(child, component);\r\n\r\n    if (component.mAdded === true)\r\n      return;\r\n\r\n    component.mAdded = true;\r\n    component.onAdded(child);\r\n  }\r\n\r\n  /**\r\n   * @param  {GameObject} child\r\n   * @param  {Component} component\r\n   * @return {void}\r\n   */\r\n  onComponentRemoved(child, component) {\r\n    for (let i = 0; i < this.mSystems.length; i++)\r\n      this.mSystems[i].onComponentRemoved(child, component);\r\n\r\n    if (component.mAdded === false)\r\n      return;\r\n\r\n    component.mAdded = false;\r\n    component.onRemoved(child);\r\n  }\r\n\r\n  /**\r\n   * pauseOnHide - Gets/Sets if engine should be automatically paused when window is hidden.\r\n   * @return {boolean}\r\n   */\r\n  get pauseOnHide() {\r\n    return this.mPauseOnHide;\r\n  }\r\n\r\n  /**\r\n   * pauseOnHide - Gets/Sets if engine should be automatically paused when window is hidden.\r\n   * @param {boolean} value\r\n   * @return {void}\r\n   */\r\n  set pauseOnHide(value) {\r\n    this.mPauseOnHide = value;\r\n  }\r\n\r\n  /**\r\n   * pauseOnBlur - Gets/Sets if engine should be automatically paused when container element is blured.\r\n   * @return {boolean}\r\n   */\r\n  get pauseOnBlur() {\r\n    return this.mPauseOnBlur;\r\n  }\r\n\r\n  /**\r\n   * pauseOnBlur - Gets/Sets if engine should be automatically paused when container element is blured.\r\n   * @param {boolean} value\r\n   * @return {void}\r\n   */\r\n  set pauseOnBlur(value) {\r\n    this.mPauseOnBlur = value;\r\n  }\r\n\r\n\r\n  /**\r\n   * enableFixedTimeStep - Gets/sets if fixed-time-step update should happen. When disabled the physics system and other systems may not work.\r\n   * @return {boolean}\r\n   */\r\n  get enableFixedTimeStep() {\r\n    return this.mEnableFixedTimeStep;\r\n  }\r\n\r\n  /**\r\n   * enableFixedTimeStep - Gets/sets if fixed-time-step update should happen. When disabled the physics system and other systems may not work.\r\n   *\r\n   * @param {boolean} value\r\n   *\r\n   * @return {void}\r\n   */\r\n  set enableFixedTimeStep(value) {\r\n    this.mEnableFixedTimeStep = value;\r\n  }\r\n\r\n  get magic() {\r\n    return Math.random();\r\n  }\r\n}\r\n"]}